<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FaceDetection: D:/Long/WorkingSet/Project/FaceDetect_V1.3(6)/cvaux.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>D:/Long/WorkingSet/Project/FaceDetect_V1.3(6)/cvaux.hpp</h1>  </div>
</div>
<div class="contents">
<a href="cvaux_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*M///////////////////////////////////////////////////////////////////////////////////////</span>
<a name="l00002"></a>00002 <span class="comment">//</span>
<a name="l00003"></a>00003 <span class="comment">//  IMPORTANT: READ BEFORE DOWNLOADING, COPYING, INSTALLING OR USING.</span>
<a name="l00004"></a>00004 <span class="comment">//</span>
<a name="l00005"></a>00005 <span class="comment">//  By downloading, copying, installing or using the software you agree to this license.</span>
<a name="l00006"></a>00006 <span class="comment">//  If you do not agree to this license, do not download, install,</span>
<a name="l00007"></a>00007 <span class="comment">//  copy or use the software.</span>
<a name="l00008"></a>00008 <span class="comment">//</span>
<a name="l00009"></a>00009 <span class="comment">//</span>
<a name="l00010"></a>00010 <span class="comment">//                        Intel License Agreement</span>
<a name="l00011"></a>00011 <span class="comment">//                For Open Source Computer Vision Library</span>
<a name="l00012"></a>00012 <span class="comment">//</span>
<a name="l00013"></a>00013 <span class="comment">// Copyright (C) 2000, Intel Corporation, all rights reserved.</span>
<a name="l00014"></a>00014 <span class="comment">// Third party copyrights are property of their respective owners.</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// Redistribution and use in source and binary forms, with or without modification,</span>
<a name="l00017"></a>00017 <span class="comment">// are permitted provided that the following conditions are met:</span>
<a name="l00018"></a>00018 <span class="comment">//</span>
<a name="l00019"></a>00019 <span class="comment">//   * Redistribution&#39;s of source code must retain the above copyright notice,</span>
<a name="l00020"></a>00020 <span class="comment">//     this list of conditions and the following disclaimer.</span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 <span class="comment">//   * Redistribution&#39;s in binary form must reproduce the above copyright notice,</span>
<a name="l00023"></a>00023 <span class="comment">//     this list of conditions and the following disclaimer in the documentation</span>
<a name="l00024"></a>00024 <span class="comment">//     and/or other materials provided with the distribution.</span>
<a name="l00025"></a>00025 <span class="comment">//</span>
<a name="l00026"></a>00026 <span class="comment">//   * The name of Intel Corporation may not be used to endorse or promote products</span>
<a name="l00027"></a>00027 <span class="comment">//     derived from this software without specific prior written permission.</span>
<a name="l00028"></a>00028 <span class="comment">//</span>
<a name="l00029"></a>00029 <span class="comment">// This software is provided by the copyright holders and contributors &quot;as is&quot; and</span>
<a name="l00030"></a>00030 <span class="comment">// any express or implied warranties, including, but not limited to, the implied</span>
<a name="l00031"></a>00031 <span class="comment">// warranties of merchantability and fitness for a particular purpose are disclaimed.</span>
<a name="l00032"></a>00032 <span class="comment">// In no event shall the Intel Corporation or contributors be liable for any direct,</span>
<a name="l00033"></a>00033 <span class="comment">// indirect, incidental, special, exemplary, or consequential damages</span>
<a name="l00034"></a>00034 <span class="comment">// (including, but not limited to, procurement of substitute goods or services;</span>
<a name="l00035"></a>00035 <span class="comment">// loss of use, data, or profits; or business interruption) however caused</span>
<a name="l00036"></a>00036 <span class="comment">// and on any theory of liability, whether in contract, strict liability,</span>
<a name="l00037"></a>00037 <span class="comment">// or tort (including negligence or otherwise) arising in any way out of</span>
<a name="l00038"></a>00038 <span class="comment">// the use of this software, even if advised of the possibility of such damage.</span>
<a name="l00039"></a>00039 <span class="comment">//</span>
<a name="l00040"></a>00040 <span class="comment">//M*/</span>
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <span class="preprocessor">#ifndef __OPENCV_AUX_HPP__</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span><span class="preprocessor">#define __OPENCV_AUX_HPP__</span>
<a name="l00044"></a>00044 <span class="preprocessor"></span>
<a name="l00045"></a>00045 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00046"></a>00046 <span class="preprocessor"></span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &lt;iosfwd&gt;</span>
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> CvImage
<a name="l00050"></a>00050 {
<a name="l00051"></a>00051 <span class="keyword">public</span>:
<a name="l00052"></a>00052     CvImage() : <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>(0), refcount(0) {}
<a name="l00053"></a>00053     CvImage( <a class="code" href="struct_cv_size.html">CvSize</a> <a class="code" href="cv_8h.html#a854352f53b148adc24983a58a1866d66">size</a>, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#acb5ba97551079e0b072c62c21d784ac5">depth</a>, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a2876852c6a9947679c3003692de5aa83">channels</a> )
<a name="l00054"></a>00054     {
<a name="l00055"></a>00055         <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> = cvCreateImage( size, depth, channels );
<a name="l00056"></a>00056         refcount = <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ? <span class="keyword">new</span> int(1) : 0;
<a name="l00057"></a>00057     }
<a name="l00058"></a>00058 
<a name="l00059"></a>00059     CvImage( <a class="code" href="struct___ipl_image.html">IplImage</a>* img ) : <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>(img)
<a name="l00060"></a>00060     {
<a name="l00061"></a>00061         refcount = <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ? <span class="keyword">new</span> int(1) : 0;
<a name="l00062"></a>00062     }
<a name="l00063"></a>00063 
<a name="l00064"></a>00064     CvImage( <span class="keyword">const</span> CvImage&amp; img ) : <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>(img.<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>), refcount(img.refcount)
<a name="l00065"></a>00065     {
<a name="l00066"></a>00066         <span class="keywordflow">if</span>( refcount ) ++(*refcount);
<a name="l00067"></a>00067     }
<a name="l00068"></a>00068 
<a name="l00069"></a>00069     CvImage( <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="cxcore_8h.html#acc427f35f3bd9f865d39012657cc42f8">filename</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* imgname=0, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a4ea898fa4dd23d613d19923509d8e249">color</a>=-1 ) : <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>(0), refcount(0)
<a name="l00070"></a>00070     { load( filename, imgname, <a class="code" href="cxcore_8h.html#a4ea898fa4dd23d613d19923509d8e249">color</a> ); }
<a name="l00071"></a>00071 
<a name="l00072"></a>00072     CvImage( <a class="code" href="cxtypes_8h.html#a84556d1bb6f1b8b02c04c60246747a7e">CvFileStorage</a>* fs, <span class="keyword">const</span> <span class="keywordtype">char</span>* mapname, <span class="keyword">const</span> <span class="keywordtype">char</span>* imgname ) : <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>(0), refcount(0)
<a name="l00073"></a>00073     { read( fs, mapname, imgname ); }
<a name="l00074"></a>00074 
<a name="l00075"></a>00075     CvImage( <a class="code" href="cxtypes_8h.html#a84556d1bb6f1b8b02c04c60246747a7e">CvFileStorage</a>* fs, <span class="keyword">const</span> <span class="keywordtype">char</span>* seqname, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a5c7c842f447336aa2f10826df65a28b3">idx</a> ) : <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>(0), refcount(0)
<a name="l00076"></a>00076     { read( fs, seqname, idx ); }
<a name="l00077"></a>00077 
<a name="l00078"></a>00078     ~CvImage()
<a name="l00079"></a>00079     {
<a name="l00080"></a>00080         <span class="keywordflow">if</span>( refcount &amp;&amp; !(--*refcount) )
<a name="l00081"></a>00081         {
<a name="l00082"></a>00082             cvReleaseImage( &amp;<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> );
<a name="l00083"></a>00083             <span class="keyword">delete</span> refcount;
<a name="l00084"></a>00084         }
<a name="l00085"></a>00085     }
<a name="l00086"></a>00086 
<a name="l00087"></a>00087     CvImage clone() { <span class="keywordflow">return</span> CvImage(<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ? cvCloneImage(<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>) : 0); }
<a name="l00088"></a>00088 
<a name="l00089"></a>00089     <span class="keywordtype">void</span> create( <a class="code" href="struct_cv_size.html">CvSize</a> size, <span class="keywordtype">int</span> depth, <span class="keywordtype">int</span> channels )
<a name="l00090"></a>00090     {
<a name="l00091"></a>00091         <span class="keywordflow">if</span>( !<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> || !refcount ||
<a name="l00092"></a>00092             <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;width != size.<a class="code" href="struct_cv_size.html#a2b1a1518e624c74c5a0e24c6cc1c3170">width</a> || <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;height != size.<a class="code" href="struct_cv_size.html#ac743399a59a7a2f302091b9180d23673">height</a> ||
<a name="l00093"></a>00093             <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;depth != depth || <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;nChannels != channels )
<a name="l00094"></a>00094             attach( cvCreateImage( size, depth, channels ));
<a name="l00095"></a>00095     }
<a name="l00096"></a>00096 
<a name="l00097"></a>00097     <span class="keywordtype">void</span> release() { detach(); }
<a name="l00098"></a>00098     <span class="keywordtype">void</span> clear() { detach(); }
<a name="l00099"></a>00099 
<a name="l00100"></a>00100     <span class="keywordtype">void</span> attach( <a class="code" href="struct___ipl_image.html">IplImage</a>* img, <span class="keywordtype">bool</span> use_refcount=<span class="keyword">true</span> )
<a name="l00101"></a>00101     {
<a name="l00102"></a>00102         <span class="keywordflow">if</span>( refcount &amp;&amp; --*refcount == 0 )
<a name="l00103"></a>00103         {
<a name="l00104"></a>00104             cvReleaseImage( &amp;<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> );
<a name="l00105"></a>00105             <span class="keyword">delete</span> refcount;
<a name="l00106"></a>00106         }
<a name="l00107"></a>00107         <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> = img;
<a name="l00108"></a>00108         refcount = use_refcount &amp;&amp; <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ? <span class="keyword">new</span> int(1) : 0;
<a name="l00109"></a>00109     }
<a name="l00110"></a>00110 
<a name="l00111"></a>00111     <span class="keywordtype">void</span> detach()
<a name="l00112"></a>00112     {
<a name="l00113"></a>00113         <span class="keywordflow">if</span>( refcount &amp;&amp; --*refcount == 0 )
<a name="l00114"></a>00114         {
<a name="l00115"></a>00115             cvReleaseImage( &amp;<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> );
<a name="l00116"></a>00116             <span class="keyword">delete</span> refcount;
<a name="l00117"></a>00117         }
<a name="l00118"></a>00118         <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> = 0;
<a name="l00119"></a>00119         refcount = 0;
<a name="l00120"></a>00120     }
<a name="l00121"></a>00121 
<a name="l00122"></a>00122     <span class="keywordtype">bool</span> load( <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="cxcore_8h.html#acc427f35f3bd9f865d39012657cc42f8">filename</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* imgname=0, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a4ea898fa4dd23d613d19923509d8e249">color</a>=-1 );
<a name="l00123"></a>00123     <span class="keywordtype">bool</span> read( <a class="code" href="cxtypes_8h.html#a84556d1bb6f1b8b02c04c60246747a7e">CvFileStorage</a>* fs, <span class="keyword">const</span> <span class="keywordtype">char</span>* mapname, <span class="keyword">const</span> <span class="keywordtype">char</span>* imgname );
<a name="l00124"></a>00124     <span class="keywordtype">bool</span> read( <a class="code" href="cxtypes_8h.html#a84556d1bb6f1b8b02c04c60246747a7e">CvFileStorage</a>* fs, <span class="keyword">const</span> <span class="keywordtype">char</span>* seqname, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a5c7c842f447336aa2f10826df65a28b3">idx</a> );
<a name="l00125"></a>00125     <span class="keywordtype">void</span> save( <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="cxcore_8h.html#acc427f35f3bd9f865d39012657cc42f8">filename</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* imgname, <span class="keyword">const</span> <span class="keywordtype">int</span>* <a class="code" href="cv_8h.html#a0480a03ecc41b20cde376602531d9270">params</a>=0 );
<a name="l00126"></a>00126     <span class="keywordtype">void</span> write( <a class="code" href="cxtypes_8h.html#a84556d1bb6f1b8b02c04c60246747a7e">CvFileStorage</a>* fs, <span class="keyword">const</span> <span class="keywordtype">char</span>* imgname );
<a name="l00127"></a>00127 
<a name="l00128"></a>00128     <span class="keywordtype">void</span> show( <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="highgui_8h.html#aaefe59fe6a71312aaff4c05232e819b0">window_name</a> );
<a name="l00129"></a>00129     <span class="keywordtype">bool</span> is_valid() { <span class="keywordflow">return</span> <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> != 0; }
<a name="l00130"></a>00130 
<a name="l00131"></a>00131     <span class="keywordtype">int</span> <a class="code" href="highgui_8h.html#a2474a5474cbff19523a51eb1de01cda4">width</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ? <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;width : 0; }
<a name="l00132"></a>00132     <span class="keywordtype">int</span> <a class="code" href="highgui_8h.html#adc7b4b8a6ef510e136071efbc9cd9a58">height</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ? <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;height : 0; }
<a name="l00133"></a>00133 
<a name="l00134"></a>00134     <a class="code" href="struct_cv_size.html">CvSize</a> <a class="code" href="cv_8h.html#a854352f53b148adc24983a58a1866d66">size</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ? <a class="code" href="cxtypes_8h.html#ad25ce7ac18665d5c9b062283ff0204ed">cvSize</a>(<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;width, <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;height) : cvSize(0,0); }
<a name="l00135"></a>00135 
<a name="l00136"></a>00136     <a class="code" href="struct_cv_size.html">CvSize</a> roi_size()<span class="keyword"> const</span>
<a name="l00137"></a>00137 <span class="keyword">    </span>{
<a name="l00138"></a>00138         <span class="keywordflow">return</span> !<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ? <a class="code" href="cxtypes_8h.html#ad25ce7ac18665d5c9b062283ff0204ed">cvSize</a>(0,0) :
<a name="l00139"></a>00139             !<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;roi ? cvSize(<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;<a class="code" href="highgui_8h.html#a2474a5474cbff19523a51eb1de01cda4">width</a>,<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;<a class="code" href="highgui_8h.html#adc7b4b8a6ef510e136071efbc9cd9a58">height</a>) :
<a name="l00140"></a>00140             cvSize(<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;roi-&gt;<a class="code" href="highgui_8h.html#a2474a5474cbff19523a51eb1de01cda4">width</a>, <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;roi-&gt;<a class="code" href="highgui_8h.html#adc7b4b8a6ef510e136071efbc9cd9a58">height</a>);
<a name="l00141"></a>00141     }
<a name="l00142"></a>00142 
<a name="l00143"></a>00143     <a class="code" href="struct_cv_rect.html">CvRect</a> roi()<span class="keyword"> const</span>
<a name="l00144"></a>00144 <span class="keyword">    </span>{
<a name="l00145"></a>00145         <span class="keywordflow">return</span> !<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ? <a class="code" href="cxtypes_8h.html#afaffdb9052823163862a88209f379921">cvRect</a>(0,0,0,0) :
<a name="l00146"></a>00146             !<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;roi ? cvRect(0,0,<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;<a class="code" href="highgui_8h.html#a2474a5474cbff19523a51eb1de01cda4">width</a>,<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;<a class="code" href="highgui_8h.html#adc7b4b8a6ef510e136071efbc9cd9a58">height</a>) :
<a name="l00147"></a>00147             cvRect(<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;roi-&gt;xOffset,<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;roi-&gt;yOffset,
<a name="l00148"></a>00148                    <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;roi-&gt;<a class="code" href="highgui_8h.html#a2474a5474cbff19523a51eb1de01cda4">width</a>,<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;roi-&gt;<a class="code" href="highgui_8h.html#adc7b4b8a6ef510e136071efbc9cd9a58">height</a>);
<a name="l00149"></a>00149     }
<a name="l00150"></a>00150 
<a name="l00151"></a>00151     <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a77674fb914cf2e14c0ddff790b225dbe">coi</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> || !<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;roi ? 0 : <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;roi-&gt;coi; }
<a name="l00152"></a>00152 
<a name="l00153"></a>00153     <span class="keywordtype">void</span> set_roi(<a class="code" href="struct_cv_rect.html">CvRect</a> roi) { cvSetImageROI(<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>,roi); }
<a name="l00154"></a>00154     <span class="keywordtype">void</span> reset_roi() { cvResetImageROI(<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>); }
<a name="l00155"></a>00155     <span class="keywordtype">void</span> set_coi(<span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a77674fb914cf2e14c0ddff790b225dbe">coi</a>) { cvSetImageCOI(<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>,coi); }
<a name="l00156"></a>00156     <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#acb5ba97551079e0b072c62c21d784ac5">depth</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ? <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;depth : 0; }
<a name="l00157"></a>00157     <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a2876852c6a9947679c3003692de5aa83">channels</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ? <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;nChannels : 0; }
<a name="l00158"></a>00158     <span class="keywordtype">int</span> pix_size()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ? ((<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;depth &amp; 255)&gt;&gt;3)*<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;nChannels : 0; }
<a name="l00159"></a>00159 
<a name="l00160"></a>00160     <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>* <a class="code" href="cv_8h.html#acd1647952fba31484ea63d6f1140e509">data</a>() { <span class="keywordflow">return</span> <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ? (<a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>*)<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;imageData : 0; }
<a name="l00161"></a>00161     <span class="keyword">const</span> <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>* <a class="code" href="cv_8h.html#acd1647952fba31484ea63d6f1140e509">data</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ? (<span class="keyword">const</span> <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>*)<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;imageData : 0; }
<a name="l00162"></a>00162     <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#aa7cdf40a6d11ff4cbc59e7cebd6857df">step</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ? <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;widthStep : 0; }
<a name="l00163"></a>00163     <span class="keywordtype">int</span> origin()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ? <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;origin : 0; }
<a name="l00164"></a>00164 
<a name="l00165"></a>00165     <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>* roi_row(<span class="keywordtype">int</span> <a class="code" href="highgui_8h.html#af1202c02b14870c18fb3a1da73e9e7c7">y</a>)
<a name="l00166"></a>00166     {
<a name="l00167"></a>00167         assert(0&lt;=y);
<a name="l00168"></a>00168         assert(!<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ?
<a name="l00169"></a>00169                 1 : <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;roi ?
<a name="l00170"></a>00170                 <a class="code" href="highgui_8h.html#af1202c02b14870c18fb3a1da73e9e7c7">y&lt;image-&gt;</a>roi-&gt;height : <a class="code" href="highgui_8h.html#af1202c02b14870c18fb3a1da73e9e7c7">y&lt;image-&gt;</a><a class="code" href="highgui_8h.html#adc7b4b8a6ef510e136071efbc9cd9a58">height</a>);
<a name="l00171"></a>00171         
<a name="l00172"></a>00172         <span class="keywordflow">return</span> !<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ? 0 :
<a name="l00173"></a>00173             !<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;roi ?
<a name="l00174"></a>00174                 (<a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>*)(<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;imageData + y*<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;widthStep) :
<a name="l00175"></a>00175                 (<a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>*)(<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;imageData + (y+<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;roi-&gt;yOffset)*<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;widthStep +
<a name="l00176"></a>00176                 <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;roi-&gt;xOffset*((<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;depth &amp; 255)&gt;&gt;3)*<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;nChannels);
<a name="l00177"></a>00177     }
<a name="l00178"></a>00178 
<a name="l00179"></a>00179     <span class="keyword">const</span> <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>* roi_row(<span class="keywordtype">int</span> y)<span class="keyword"> const</span>
<a name="l00180"></a>00180 <span class="keyword">    </span>{
<a name="l00181"></a>00181         assert(0&lt;=y);
<a name="l00182"></a>00182         assert(!<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ?
<a name="l00183"></a>00183                 1 : <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;roi ?
<a name="l00184"></a>00184                 <a class="code" href="highgui_8h.html#af1202c02b14870c18fb3a1da73e9e7c7">y&lt;image-&gt;</a>roi-&gt;height : <a class="code" href="highgui_8h.html#af1202c02b14870c18fb3a1da73e9e7c7">y&lt;image-&gt;</a><a class="code" href="highgui_8h.html#adc7b4b8a6ef510e136071efbc9cd9a58">height</a>); 
<a name="l00185"></a>00185 
<a name="l00186"></a>00186         <span class="keywordflow">return</span> !<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> ? 0 :
<a name="l00187"></a>00187             !<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;roi ?
<a name="l00188"></a>00188                 (<span class="keyword">const</span> <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>*)(<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;imageData + y*<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;widthStep) :
<a name="l00189"></a>00189                 (<span class="keyword">const</span> <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>*)(<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;imageData + (y+<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;roi-&gt;yOffset)*<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;widthStep +
<a name="l00190"></a>00190                 <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;roi-&gt;xOffset*((<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;depth &amp; 255)&gt;&gt;3)*<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>-&gt;nChannels);
<a name="l00191"></a>00191     }
<a name="l00192"></a>00192 
<a name="l00193"></a>00193     operator const IplImage* ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>; }
<a name="l00194"></a>00194     operator IplImage* () { <span class="keywordflow">return</span> <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>; }
<a name="l00195"></a>00195 
<a name="l00196"></a>00196     CvImage&amp; operator = (<span class="keyword">const</span> CvImage&amp; img)
<a name="l00197"></a>00197     {
<a name="l00198"></a>00198         <span class="keywordflow">if</span>( img.refcount )
<a name="l00199"></a>00199             ++*img.refcount;
<a name="l00200"></a>00200         <span class="keywordflow">if</span>( refcount &amp;&amp; !(--*refcount) )
<a name="l00201"></a>00201             cvReleaseImage( &amp;<a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a> );
<a name="l00202"></a>00202         <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>=img.image;
<a name="l00203"></a>00203         refcount=img.refcount;
<a name="l00204"></a>00204         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00205"></a>00205     }
<a name="l00206"></a>00206 
<a name="l00207"></a>00207 <span class="keyword">protected</span>:
<a name="l00208"></a>00208     <a class="code" href="struct___ipl_image.html">IplImage</a>* <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>;
<a name="l00209"></a>00209     <span class="keywordtype">int</span>* refcount;
<a name="l00210"></a>00210 };
<a name="l00211"></a>00211 
<a name="l00212"></a>00212 
<a name="l00213"></a>00213 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> CvMatrix
<a name="l00214"></a>00214 {
<a name="l00215"></a>00215 <span class="keyword">public</span>:
<a name="l00216"></a>00216     CvMatrix() : matrix(0) {}
<a name="l00217"></a>00217     CvMatrix( <span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a061459acc9e078fa4699e0e349887215">rows</a>, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a4407a60bc4387adae24cee658711f2d9">cols</a>, <span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a8bc957583d2a5247e490ea9ce960cf21">type</a> )
<a name="l00218"></a>00218     { matrix = cvCreateMat( rows, cols, type ); }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220     CvMatrix( <span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a061459acc9e078fa4699e0e349887215">rows</a>, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a4407a60bc4387adae24cee658711f2d9">cols</a>, <span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a8bc957583d2a5247e490ea9ce960cf21">type</a>, <a class="code" href="struct_cv_mat.html">CvMat</a>* hdr,
<a name="l00221"></a>00221               <span class="keywordtype">void</span>* <a class="code" href="cv_8h.html#acd1647952fba31484ea63d6f1140e509">data</a>=0, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#aa7cdf40a6d11ff4cbc59e7cebd6857df">step</a>=<a class="code" href="cxcore_8h.html#a2037b9e258f1d2091a58003922968a85">CV_AUTOSTEP</a> )
<a name="l00222"></a>00222     { matrix = cvInitMatHeader( hdr, rows, cols, type, <a class="code" href="cv_8h.html#acd1647952fba31484ea63d6f1140e509">data</a>, <a class="code" href="cxcore_8h.html#aa7cdf40a6d11ff4cbc59e7cebd6857df">step</a> ); }
<a name="l00223"></a>00223 
<a name="l00224"></a>00224     CvMatrix( <span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a061459acc9e078fa4699e0e349887215">rows</a>, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a4407a60bc4387adae24cee658711f2d9">cols</a>, <span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a8bc957583d2a5247e490ea9ce960cf21">type</a>, <a class="code" href="struct_cv_mem_storage.html">CvMemStorage</a>* <a class="code" href="cv_8h.html#a1a14fa6e7705a625b121ab49e62e0708">storage</a>, <span class="keywordtype">bool</span> alloc_data=<span class="keyword">true</span> );
<a name="l00225"></a>00225 
<a name="l00226"></a>00226     CvMatrix( <span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a061459acc9e078fa4699e0e349887215">rows</a>, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a4407a60bc4387adae24cee658711f2d9">cols</a>, <span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a8bc957583d2a5247e490ea9ce960cf21">type</a>, <span class="keywordtype">void</span>* <a class="code" href="cv_8h.html#acd1647952fba31484ea63d6f1140e509">data</a>, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#aa7cdf40a6d11ff4cbc59e7cebd6857df">step</a>=<a class="code" href="cxcore_8h.html#a2037b9e258f1d2091a58003922968a85">CV_AUTOSTEP</a> )
<a name="l00227"></a>00227     { matrix = cvCreateMatHeader( rows, cols, type );
<a name="l00228"></a>00228       cvSetData( matrix, data, <a class="code" href="cxcore_8h.html#aa7cdf40a6d11ff4cbc59e7cebd6857df">step</a> ); }
<a name="l00229"></a>00229 
<a name="l00230"></a>00230     CvMatrix( <a class="code" href="struct_cv_mat.html">CvMat</a>* m )
<a name="l00231"></a>00231     { matrix = m; }
<a name="l00232"></a>00232 
<a name="l00233"></a>00233     CvMatrix( <span class="keyword">const</span> CvMatrix&amp; m )
<a name="l00234"></a>00234     {
<a name="l00235"></a>00235         matrix = m.matrix;
<a name="l00236"></a>00236         addref();
<a name="l00237"></a>00237     }
<a name="l00238"></a>00238 
<a name="l00239"></a>00239     CvMatrix( <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="cxcore_8h.html#acc427f35f3bd9f865d39012657cc42f8">filename</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* matname=0, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a4ea898fa4dd23d613d19923509d8e249">color</a>=-1 ) : matrix(0)
<a name="l00240"></a>00240     {  load( filename, matname, <a class="code" href="cxcore_8h.html#a4ea898fa4dd23d613d19923509d8e249">color</a> ); }
<a name="l00241"></a>00241 
<a name="l00242"></a>00242     CvMatrix( <a class="code" href="cxtypes_8h.html#a84556d1bb6f1b8b02c04c60246747a7e">CvFileStorage</a>* fs, <span class="keyword">const</span> <span class="keywordtype">char</span>* mapname, <span class="keyword">const</span> <span class="keywordtype">char</span>* matname ) : matrix(0)
<a name="l00243"></a>00243     {  read( fs, mapname, matname ); }
<a name="l00244"></a>00244 
<a name="l00245"></a>00245     CvMatrix( <a class="code" href="cxtypes_8h.html#a84556d1bb6f1b8b02c04c60246747a7e">CvFileStorage</a>* fs, <span class="keyword">const</span> <span class="keywordtype">char</span>* seqname, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a5c7c842f447336aa2f10826df65a28b3">idx</a> ) : matrix(0)
<a name="l00246"></a>00246     {  read( fs, seqname, idx ); }
<a name="l00247"></a>00247 
<a name="l00248"></a>00248     ~CvMatrix()
<a name="l00249"></a>00249     {
<a name="l00250"></a>00250         release();
<a name="l00251"></a>00251     }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253     CvMatrix clone() { <span class="keywordflow">return</span> CvMatrix(matrix ? cvCloneMat(matrix) : 0); }
<a name="l00254"></a>00254 
<a name="l00255"></a>00255     <span class="keywordtype">void</span> <span class="keyword">set</span>( <a class="code" href="struct_cv_mat.html">CvMat</a>* m, <span class="keywordtype">bool</span> add_ref )
<a name="l00256"></a>00256     {
<a name="l00257"></a>00257         release();
<a name="l00258"></a>00258         matrix = m;
<a name="l00259"></a>00259         <span class="keywordflow">if</span>( add_ref )
<a name="l00260"></a>00260             addref();
<a name="l00261"></a>00261     }
<a name="l00262"></a>00262 
<a name="l00263"></a>00263     <span class="keywordtype">void</span> create( <span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a061459acc9e078fa4699e0e349887215">rows</a>, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a4407a60bc4387adae24cee658711f2d9">cols</a>, <span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a8bc957583d2a5247e490ea9ce960cf21">type</a> )
<a name="l00264"></a>00264     {
<a name="l00265"></a>00265         <span class="keywordflow">if</span>( !matrix || !matrix-&gt;refcount ||
<a name="l00266"></a>00266             matrix-&gt;rows != rows || matrix-&gt;cols != cols ||
<a name="l00267"></a>00267             <a class="code" href="cxtypes_8h.html#a96a7faeae8e745d65fb59a1e98b32098">CV_MAT_TYPE</a>(matrix-&gt;type) != type )
<a name="l00268"></a>00268             <span class="keyword">set</span>( cvCreateMat( rows, cols, type ), false );
<a name="l00269"></a>00269     }
<a name="l00270"></a>00270 
<a name="l00271"></a>00271     <span class="keywordtype">void</span> addref()<span class="keyword"> const</span>
<a name="l00272"></a>00272 <span class="keyword">    </span>{
<a name="l00273"></a>00273         <span class="keywordflow">if</span>( matrix )
<a name="l00274"></a>00274         {
<a name="l00275"></a>00275             <span class="keywordflow">if</span>( matrix-&gt;hdr_refcount )
<a name="l00276"></a>00276                 ++matrix-&gt;hdr_refcount;
<a name="l00277"></a>00277             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( matrix-&gt;refcount )
<a name="l00278"></a>00278                 ++*matrix-&gt;refcount;
<a name="l00279"></a>00279         }
<a name="l00280"></a>00280     }
<a name="l00281"></a>00281 
<a name="l00282"></a>00282     <span class="keywordtype">void</span> release()
<a name="l00283"></a>00283     {
<a name="l00284"></a>00284         <span class="keywordflow">if</span>( matrix )
<a name="l00285"></a>00285         {
<a name="l00286"></a>00286             <span class="keywordflow">if</span>( matrix-&gt;hdr_refcount )
<a name="l00287"></a>00287             {
<a name="l00288"></a>00288                 <span class="keywordflow">if</span>( --matrix-&gt;hdr_refcount == 0 )
<a name="l00289"></a>00289                     cvReleaseMat( &amp;matrix );
<a name="l00290"></a>00290             }
<a name="l00291"></a>00291             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( matrix-&gt;refcount )
<a name="l00292"></a>00292             {
<a name="l00293"></a>00293                 <span class="keywordflow">if</span>( --*matrix-&gt;refcount == 0 )
<a name="l00294"></a>00294                     <a class="code" href="cxcore_8h.html#a0c5b55bdfff212be3e40c0cb38507e7f">cvFree</a>( &amp;matrix-&gt;refcount );
<a name="l00295"></a>00295             }
<a name="l00296"></a>00296             matrix = 0;
<a name="l00297"></a>00297         }
<a name="l00298"></a>00298     }
<a name="l00299"></a>00299 
<a name="l00300"></a>00300     <span class="keywordtype">void</span> clear()
<a name="l00301"></a>00301     {
<a name="l00302"></a>00302         release();
<a name="l00303"></a>00303     }
<a name="l00304"></a>00304 
<a name="l00305"></a>00305     <span class="keywordtype">bool</span> load( <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="cxcore_8h.html#acc427f35f3bd9f865d39012657cc42f8">filename</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* matname=0, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a4ea898fa4dd23d613d19923509d8e249">color</a>=-1 );
<a name="l00306"></a>00306     <span class="keywordtype">bool</span> read( <a class="code" href="cxtypes_8h.html#a84556d1bb6f1b8b02c04c60246747a7e">CvFileStorage</a>* fs, <span class="keyword">const</span> <span class="keywordtype">char</span>* mapname, <span class="keyword">const</span> <span class="keywordtype">char</span>* matname );
<a name="l00307"></a>00307     <span class="keywordtype">bool</span> read( <a class="code" href="cxtypes_8h.html#a84556d1bb6f1b8b02c04c60246747a7e">CvFileStorage</a>* fs, <span class="keyword">const</span> <span class="keywordtype">char</span>* seqname, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a5c7c842f447336aa2f10826df65a28b3">idx</a> );
<a name="l00308"></a>00308     <span class="keywordtype">void</span> save( <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="cxcore_8h.html#acc427f35f3bd9f865d39012657cc42f8">filename</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* matname, <span class="keyword">const</span> <span class="keywordtype">int</span>* <a class="code" href="cv_8h.html#a0480a03ecc41b20cde376602531d9270">params</a>=0 );
<a name="l00309"></a>00309     <span class="keywordtype">void</span> write( <a class="code" href="cxtypes_8h.html#a84556d1bb6f1b8b02c04c60246747a7e">CvFileStorage</a>* fs, <span class="keyword">const</span> <span class="keywordtype">char</span>* matname );
<a name="l00310"></a>00310 
<a name="l00311"></a>00311     <span class="keywordtype">void</span> show( <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="highgui_8h.html#aaefe59fe6a71312aaff4c05232e819b0">window_name</a> );
<a name="l00312"></a>00312 
<a name="l00313"></a>00313     <span class="keywordtype">bool</span> is_valid() { <span class="keywordflow">return</span> matrix != 0; }
<a name="l00314"></a>00314 
<a name="l00315"></a>00315     <span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a061459acc9e078fa4699e0e349887215">rows</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> matrix ? matrix-&gt;rows : 0; }
<a name="l00316"></a>00316     <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a4407a60bc4387adae24cee658711f2d9">cols</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> matrix ? matrix-&gt;cols : 0; }
<a name="l00317"></a>00317 
<a name="l00318"></a>00318     <a class="code" href="struct_cv_size.html">CvSize</a> <a class="code" href="cv_8h.html#a854352f53b148adc24983a58a1866d66">size</a>()<span class="keyword"> const</span>
<a name="l00319"></a>00319 <span class="keyword">    </span>{
<a name="l00320"></a>00320         <span class="keywordflow">return</span> !matrix ? <a class="code" href="cxtypes_8h.html#ad25ce7ac18665d5c9b062283ff0204ed">cvSize</a>(0,0) : cvSize(matrix-&gt;rows,matrix-&gt;cols);
<a name="l00321"></a>00321     }
<a name="l00322"></a>00322 
<a name="l00323"></a>00323     <span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a8bc957583d2a5247e490ea9ce960cf21">type</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> matrix ? <a class="code" href="cxtypes_8h.html#a96a7faeae8e745d65fb59a1e98b32098">CV_MAT_TYPE</a>(matrix-&gt;type) : 0; }
<a name="l00324"></a>00324     <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#acb5ba97551079e0b072c62c21d784ac5">depth</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> matrix ? <a class="code" href="cxtypes_8h.html#a39f3412d63cac68d4f1d138ab52a6fc8">CV_MAT_DEPTH</a>(matrix-&gt;type) : 0; }
<a name="l00325"></a>00325     <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a2876852c6a9947679c3003692de5aa83">channels</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> matrix ? <a class="code" href="cxtypes_8h.html#a645f5d1efbab7bb8fdd460df6e633ebc">CV_MAT_CN</a>(matrix-&gt;type) : 0; }
<a name="l00326"></a>00326     <span class="keywordtype">int</span> pix_size()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> matrix ? <a class="code" href="cxtypes_8h.html#afede26477297ba5774c779f6b74f451b">CV_ELEM_SIZE</a>(matrix-&gt;type) : 0; }
<a name="l00327"></a>00327 
<a name="l00328"></a>00328     <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>* <a class="code" href="cv_8h.html#acd1647952fba31484ea63d6f1140e509">data</a>() { <span class="keywordflow">return</span> matrix ? matrix-&gt;data.ptr : 0; }
<a name="l00329"></a>00329     <span class="keyword">const</span> <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>* <a class="code" href="cv_8h.html#acd1647952fba31484ea63d6f1140e509">data</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> matrix ? matrix-&gt;data.ptr : 0; }
<a name="l00330"></a>00330     <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#aa7cdf40a6d11ff4cbc59e7cebd6857df">step</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> matrix ? matrix-&gt;step : 0; }
<a name="l00331"></a>00331 
<a name="l00332"></a>00332     <span class="keywordtype">void</span> set_data( <span class="keywordtype">void</span>* <a class="code" href="cv_8h.html#acd1647952fba31484ea63d6f1140e509">data</a>, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#aa7cdf40a6d11ff4cbc59e7cebd6857df">step</a>=<a class="code" href="cxcore_8h.html#a2037b9e258f1d2091a58003922968a85">CV_AUTOSTEP</a> )
<a name="l00333"></a>00333     { cvSetData( matrix, data, <a class="code" href="cxcore_8h.html#aa7cdf40a6d11ff4cbc59e7cebd6857df">step</a> ); }
<a name="l00334"></a>00334 
<a name="l00335"></a>00335     <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>* row(<span class="keywordtype">int</span> i) { <span class="keywordflow">return</span> !matrix ? 0 : matrix-&gt;data.ptr + i*matrix-&gt;step; }
<a name="l00336"></a>00336     <span class="keyword">const</span> <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>* row(<span class="keywordtype">int</span> i)<span class="keyword"> const</span>
<a name="l00337"></a>00337 <span class="keyword">    </span>{ <span class="keywordflow">return</span> !matrix ? 0 : matrix-&gt;data.ptr + i*matrix-&gt;step; }
<a name="l00338"></a>00338 
<a name="l00339"></a>00339     operator const CvMat* ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> matrix; }
<a name="l00340"></a>00340     operator CvMat* () { <span class="keywordflow">return</span> matrix; }
<a name="l00341"></a>00341 
<a name="l00342"></a>00342     CvMatrix&amp; operator = (<span class="keyword">const</span> CvMatrix&amp; _m)
<a name="l00343"></a>00343     {
<a name="l00344"></a>00344         _m.addref();
<a name="l00345"></a>00345         release();
<a name="l00346"></a>00346         matrix = _m.matrix;
<a name="l00347"></a>00347         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00348"></a>00348     }
<a name="l00349"></a>00349 
<a name="l00350"></a>00350 <span class="keyword">protected</span>:
<a name="l00351"></a>00351     <a class="code" href="struct_cv_mat.html">CvMat</a>* matrix;
<a name="l00352"></a>00352 };
<a name="l00353"></a>00353 
<a name="l00354"></a>00354 <span class="comment">/****************************************************************************************\</span>
<a name="l00355"></a>00355 <span class="comment">*                                       CamShiftTracker                                  *</span>
<a name="l00356"></a>00356 <span class="comment">\****************************************************************************************/</span>
<a name="l00357"></a>00357 
<a name="l00358"></a>00358 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> CvCamShiftTracker
<a name="l00359"></a>00359 {
<a name="l00360"></a>00360 <span class="keyword">public</span>:
<a name="l00361"></a>00361 
<a name="l00362"></a>00362     CvCamShiftTracker();
<a name="l00363"></a>00363     <span class="keyword">virtual</span> ~CvCamShiftTracker();
<a name="l00364"></a>00364 
<a name="l00365"></a>00365     <span class="comment">/**** Characteristics of the object that are calculated by track_object method *****/</span>
<a name="l00366"></a>00366     <span class="keywordtype">float</span>   get_orientation() const <span class="comment">// orientation of the object in degrees</span>
<a name="l00367"></a>00367     { <span class="keywordflow">return</span> m_box.angle; }
<a name="l00368"></a>00368     <span class="keywordtype">float</span>   get_length() const <span class="comment">// the larger linear size of the object</span>
<a name="l00369"></a>00369     { <span class="keywordflow">return</span> m_box.size.height; }
<a name="l00370"></a>00370     <span class="keywordtype">float</span>   get_width() const <span class="comment">// the smaller linear size of the object</span>
<a name="l00371"></a>00371     { <span class="keywordflow">return</span> m_box.size.width; }
<a name="l00372"></a>00372     <a class="code" href="struct_cv_point2_d32f.html">CvPoint2D32f</a> get_center() const <span class="comment">// center of the object</span>
<a name="l00373"></a>00373     { <span class="keywordflow">return</span> m_box.center; }
<a name="l00374"></a>00374     <a class="code" href="struct_cv_rect.html">CvRect</a> get_window() const <span class="comment">// bounding rectangle for the object</span>
<a name="l00375"></a>00375     { <span class="keywordflow">return</span> m_comp.rect; }
<a name="l00376"></a>00376 
<a name="l00377"></a>00377     <span class="comment">/*********************** Tracking parameters ************************/</span>
<a name="l00378"></a>00378     <span class="keywordtype">int</span>     get_threshold() const <span class="comment">// thresholding value that applied to back project</span>
<a name="l00379"></a>00379     { <span class="keywordflow">return</span> m_threshold; }
<a name="l00380"></a>00380 
<a name="l00381"></a>00381     <span class="keywordtype">int</span>     get_hist_dims( <span class="keywordtype">int</span>* <a class="code" href="cxcore_8h.html#aedadeec3ef499c79fc32c00079f7982d">dims</a> = 0 ) const <span class="comment">// returns number of histogram dimensions and sets</span>
<a name="l00382"></a>00382     { <span class="keywordflow">return</span> m_hist ? cvGetDims( m_hist-&gt;bins, <a class="code" href="cxcore_8h.html#aedadeec3ef499c79fc32c00079f7982d">dims</a> ) : 0; }
<a name="l00383"></a>00383 
<a name="l00384"></a>00384     <span class="keywordtype">int</span>     get_min_ch_val( <span class="keywordtype">int</span> channel ) <span class="keyword">const</span> <span class="comment">// get the minimum allowed value of the specified channel</span>
<a name="l00385"></a>00385     { <span class="keywordflow">return</span> m_min_ch_val[channel]; }
<a name="l00386"></a>00386 
<a name="l00387"></a>00387     <span class="keywordtype">int</span>     get_max_ch_val( <span class="keywordtype">int</span> channel ) <span class="keyword">const</span> <span class="comment">// get the maximum allowed value of the specified channel</span>
<a name="l00388"></a>00388     { <span class="keywordflow">return</span> m_max_ch_val[channel]; }
<a name="l00389"></a>00389 
<a name="l00390"></a>00390     <span class="comment">// set initial object rectangle (must be called before initial calculation of the histogram)</span>
<a name="l00391"></a>00391     <span class="keywordtype">bool</span>    set_window( <a class="code" href="struct_cv_rect.html">CvRect</a> <a class="code" href="cv_8h.html#a1b64c58c64aaa8f792a6a64460bca138">window</a>)
<a name="l00392"></a>00392     { m_comp.rect = <a class="code" href="cv_8h.html#a1b64c58c64aaa8f792a6a64460bca138">window</a>; <span class="keywordflow">return</span> <span class="keyword">true</span>; }
<a name="l00393"></a>00393 
<a name="l00394"></a>00394     <span class="keywordtype">bool</span>    set_threshold( <span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a32b004637d3b8895570fd73c28492698">threshold</a> ) <span class="comment">// threshold applied to the histogram bins</span>
<a name="l00395"></a>00395     { m_threshold = <a class="code" href="cv_8h.html#a32b004637d3b8895570fd73c28492698">threshold</a>; <span class="keywordflow">return</span> <span class="keyword">true</span>; }
<a name="l00396"></a>00396 
<a name="l00397"></a>00397     <span class="keywordtype">bool</span>    set_hist_bin_range( <span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a2c60d4e453921f07a407a647c96e8316">min_val</a>, <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a928495205a5ca34548c11042d48d733b">max_val</a> );
<a name="l00398"></a>00398 
<a name="l00399"></a>00399     <span class="keywordtype">bool</span>    set_hist_dims( <span class="keywordtype">int</span> c_dims, <span class="keywordtype">int</span>* <a class="code" href="cxcore_8h.html#aedadeec3ef499c79fc32c00079f7982d">dims</a> );<span class="comment">// set the histogram parameters</span>
<a name="l00400"></a>00400 
<a name="l00401"></a>00401     <span class="keywordtype">bool</span>    set_min_ch_val( <span class="keywordtype">int</span> channel, <span class="keywordtype">int</span> val ) <span class="comment">// set the minimum allowed value of the specified channel</span>
<a name="l00402"></a>00402     { m_min_ch_val[channel] = val; <span class="keywordflow">return</span> <span class="keyword">true</span>; }
<a name="l00403"></a>00403     <span class="keywordtype">bool</span>    set_max_ch_val( <span class="keywordtype">int</span> channel, <span class="keywordtype">int</span> val ) <span class="comment">// set the maximum allowed value of the specified channel</span>
<a name="l00404"></a>00404     { m_max_ch_val[channel] = val; <span class="keywordflow">return</span> <span class="keyword">true</span>; }
<a name="l00405"></a>00405 
<a name="l00406"></a>00406     <span class="comment">/************************ The processing methods *********************************/</span>
<a name="l00407"></a>00407     <span class="comment">// update object position</span>
<a name="l00408"></a>00408     <span class="keyword">virtual</span> <span class="keywordtype">bool</span>  track_object( <span class="keyword">const</span> <a class="code" href="struct___ipl_image.html">IplImage</a>* cur_frame );
<a name="l00409"></a>00409 
<a name="l00410"></a>00410     <span class="comment">// update object histogram</span>
<a name="l00411"></a>00411     <span class="keyword">virtual</span> <span class="keywordtype">bool</span>  update_histogram( <span class="keyword">const</span> <a class="code" href="struct___ipl_image.html">IplImage</a>* cur_frame );
<a name="l00412"></a>00412 
<a name="l00413"></a>00413     <span class="comment">// reset histogram</span>
<a name="l00414"></a>00414     <span class="keyword">virtual</span> <span class="keywordtype">void</span>  reset_histogram();
<a name="l00415"></a>00415 
<a name="l00416"></a>00416     <span class="comment">/************************ Retrieving internal data *******************************/</span>
<a name="l00417"></a>00417     <span class="comment">// get back project image</span>
<a name="l00418"></a>00418     <span class="keyword">virtual</span> <a class="code" href="struct___ipl_image.html">IplImage</a>* get_back_project()
<a name="l00419"></a>00419     { <span class="keywordflow">return</span> m_back_project; }
<a name="l00420"></a>00420 
<a name="l00421"></a>00421     <span class="keywordtype">float</span> query( <span class="keywordtype">int</span>* bin )<span class="keyword"> const</span>
<a name="l00422"></a>00422 <span class="keyword">    </span>{ <span class="keywordflow">return</span> m_hist ? (float)cvGetRealND(m_hist-&gt;bins, bin) : 0.f; }
<a name="l00423"></a>00423 
<a name="l00424"></a>00424 <span class="keyword">protected</span>:
<a name="l00425"></a>00425 
<a name="l00426"></a>00426     <span class="comment">// internal method for color conversion: fills m_color_planes group</span>
<a name="l00427"></a>00427     <span class="keyword">virtual</span> <span class="keywordtype">void</span> color_transform( <span class="keyword">const</span> <a class="code" href="struct___ipl_image.html">IplImage</a>* img );
<a name="l00428"></a>00428 
<a name="l00429"></a>00429     <a class="code" href="struct_cv_histogram.html">CvHistogram</a>* m_hist;
<a name="l00430"></a>00430 
<a name="l00431"></a>00431     <a class="code" href="struct_cv_box2_d.html">CvBox2D</a>    m_box;
<a name="l00432"></a>00432     <a class="code" href="struct_cv_connected_comp.html">CvConnectedComp</a> m_comp;
<a name="l00433"></a>00433 
<a name="l00434"></a>00434     <span class="keywordtype">float</span>      m_hist_ranges_data[<a class="code" href="cxtypes_8h.html#a931cb1f0da753cc1f8a3f838390616c2">CV_MAX_DIM</a>][2];
<a name="l00435"></a>00435     <span class="keywordtype">float</span>*     m_hist_ranges[<a class="code" href="cxtypes_8h.html#a931cb1f0da753cc1f8a3f838390616c2">CV_MAX_DIM</a>];
<a name="l00436"></a>00436 
<a name="l00437"></a>00437     <span class="keywordtype">int</span>        m_min_ch_val[<a class="code" href="cxtypes_8h.html#a931cb1f0da753cc1f8a3f838390616c2">CV_MAX_DIM</a>];
<a name="l00438"></a>00438     <span class="keywordtype">int</span>        m_max_ch_val[<a class="code" href="cxtypes_8h.html#a931cb1f0da753cc1f8a3f838390616c2">CV_MAX_DIM</a>];
<a name="l00439"></a>00439     <span class="keywordtype">int</span>        m_threshold;
<a name="l00440"></a>00440 
<a name="l00441"></a>00441     <a class="code" href="struct___ipl_image.html">IplImage</a>*  m_color_planes[<a class="code" href="cxtypes_8h.html#a931cb1f0da753cc1f8a3f838390616c2">CV_MAX_DIM</a>];
<a name="l00442"></a>00442     <a class="code" href="struct___ipl_image.html">IplImage</a>*  m_back_project;
<a name="l00443"></a>00443     <a class="code" href="struct___ipl_image.html">IplImage</a>*  m_temp;
<a name="l00444"></a>00444     <a class="code" href="struct___ipl_image.html">IplImage</a>*  m_mask;
<a name="l00445"></a>00445 };
<a name="l00446"></a>00446 
<a name="l00447"></a>00447 <span class="comment">/****************************************************************************************\</span>
<a name="l00448"></a>00448 <span class="comment">*                                   Adaptive Skin Detector                               *</span>
<a name="l00449"></a>00449 <span class="comment">\****************************************************************************************/</span>
<a name="l00450"></a>00450 
<a name="l00451"></a>00451 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> CvAdaptiveSkinDetector
<a name="l00452"></a>00452 {
<a name="l00453"></a>00453 <span class="keyword">private</span>:
<a name="l00454"></a>00454         <span class="keyword">enum</span> {
<a name="l00455"></a>00455                 GSD_HUE_LT = 3,
<a name="l00456"></a>00456                 GSD_HUE_UT = 33,
<a name="l00457"></a>00457                 GSD_INTENSITY_LT = 15,
<a name="l00458"></a>00458                 GSD_INTENSITY_UT = 250
<a name="l00459"></a>00459         };
<a name="l00460"></a>00460 
<a name="l00461"></a>00461         <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> Histogram
<a name="l00462"></a>00462         {
<a name="l00463"></a>00463         <span class="keyword">private</span>:
<a name="l00464"></a>00464                 <span class="keyword">enum</span> {
<a name="l00465"></a>00465                         HistogramSize = (GSD_HUE_UT - GSD_HUE_LT + 1)
<a name="l00466"></a>00466                 };
<a name="l00467"></a>00467 
<a name="l00468"></a>00468         <span class="keyword">protected</span>:
<a name="l00469"></a>00469                 <span class="keywordtype">int</span> findCoverageIndex(<span class="keywordtype">double</span> surfaceToCover, <span class="keywordtype">int</span> defaultValue = 0);
<a name="l00470"></a>00470 
<a name="l00471"></a>00471         <span class="keyword">public</span>:
<a name="l00472"></a>00472                 <a class="code" href="struct_cv_histogram.html">CvHistogram</a> *fHistogram;
<a name="l00473"></a>00473                 Histogram();
<a name="l00474"></a>00474                 <span class="keyword">virtual</span> ~Histogram();
<a name="l00475"></a>00475 
<a name="l00476"></a>00476                 <span class="keywordtype">void</span> findCurveThresholds(<span class="keywordtype">int</span> &amp;x1, <span class="keywordtype">int</span> &amp;x2, <span class="keywordtype">double</span> percent = 0.05);
<a name="l00477"></a>00477                 <span class="keywordtype">void</span> mergeWith(Histogram *source, <span class="keywordtype">double</span> weight);
<a name="l00478"></a>00478         };
<a name="l00479"></a>00479 
<a name="l00480"></a>00480         <span class="keywordtype">int</span> nStartCounter, nFrameCount, nSkinHueLowerBound, nSkinHueUpperBound, nMorphingMethod, nSamplingDivider;
<a name="l00481"></a>00481         <span class="keywordtype">double</span> fHistogramMergeFactor, fHuePercentCovered;
<a name="l00482"></a>00482         Histogram histogramHueMotion, skinHueHistogram;
<a name="l00483"></a>00483         <a class="code" href="struct___ipl_image.html">IplImage</a> *imgHueFrame, *imgSaturationFrame, *imgLastGrayFrame, *imgMotionFrame, *imgFilteredFrame;
<a name="l00484"></a>00484         <a class="code" href="struct___ipl_image.html">IplImage</a> *imgShrinked, *imgTemp, *imgGrayFrame, *imgHSVFrame;
<a name="l00485"></a>00485 
<a name="l00486"></a>00486 <span class="keyword">protected</span>:
<a name="l00487"></a>00487         <span class="keywordtype">void</span> initData(<a class="code" href="struct___ipl_image.html">IplImage</a> *<a class="code" href="cxcore_8h.html#ab4cdd1c16a22344c9f968fca805b5d70">src</a>, <span class="keywordtype">int</span> widthDivider, <span class="keywordtype">int</span> heightDivider);
<a name="l00488"></a>00488         <span class="keywordtype">void</span> adaptiveFilter();
<a name="l00489"></a>00489 
<a name="l00490"></a>00490 <span class="keyword">public</span>:
<a name="l00491"></a>00491 
<a name="l00492"></a>00492         <span class="keyword">enum</span> {
<a name="l00493"></a>00493                 MORPHING_METHOD_NONE = 0,
<a name="l00494"></a>00494                 MORPHING_METHOD_ERODE = 1,
<a name="l00495"></a>00495                 MORPHING_METHOD_ERODE_ERODE     = 2,
<a name="l00496"></a>00496                 MORPHING_METHOD_ERODE_DILATE = 3
<a name="l00497"></a>00497         };
<a name="l00498"></a>00498 
<a name="l00499"></a>00499         CvAdaptiveSkinDetector(<span class="keywordtype">int</span> samplingDivider = 1, <span class="keywordtype">int</span> morphingMethod = MORPHING_METHOD_NONE);
<a name="l00500"></a>00500         <span class="keyword">virtual</span> ~CvAdaptiveSkinDetector();
<a name="l00501"></a>00501 
<a name="l00502"></a>00502         <span class="keyword">virtual</span> <span class="keywordtype">void</span> process(<a class="code" href="struct___ipl_image.html">IplImage</a> *inputBGRImage, <a class="code" href="struct___ipl_image.html">IplImage</a> *outputHueMask);
<a name="l00503"></a>00503 };
<a name="l00504"></a>00504 
<a name="l00505"></a>00505 
<a name="l00506"></a>00506 <span class="comment">/****************************************************************************************\</span>
<a name="l00507"></a>00507 <span class="comment">*                                  Fuzzy MeanShift Tracker                               *</span>
<a name="l00508"></a>00508 <span class="comment">\****************************************************************************************/</span>
<a name="l00509"></a>00509 
<a name="l00510"></a>00510 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> CvFuzzyPoint {
<a name="l00511"></a>00511 <span class="keyword">public</span>:
<a name="l00512"></a>00512         <span class="keywordtype">double</span> <a class="code" href="highgui_8h.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>, <a class="code" href="highgui_8h.html#af1202c02b14870c18fb3a1da73e9e7c7">y</a>, <a class="code" href="cxcore_8h.html#ad4670c92695d4327c21292905a803901">value</a>;
<a name="l00513"></a>00513 
<a name="l00514"></a>00514         CvFuzzyPoint(<span class="keywordtype">double</span> _x, <span class="keywordtype">double</span> _y);
<a name="l00515"></a>00515 };
<a name="l00516"></a>00516 
<a name="l00517"></a>00517 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> CvFuzzyCurve {
<a name="l00518"></a>00518 <span class="keyword">private</span>:
<a name="l00519"></a>00519     std::vector&lt;CvFuzzyPoint&gt; <a class="code" href="cv_8h.html#a8c4b676395bf614cc92b782d12f18847">points</a>;
<a name="l00520"></a>00520         <span class="keywordtype">double</span> <a class="code" href="cxcore_8h.html#ad4670c92695d4327c21292905a803901">value</a>, centre;
<a name="l00521"></a>00521 
<a name="l00522"></a>00522         <span class="keywordtype">bool</span> between(<span class="keywordtype">double</span> <a class="code" href="highgui_8h.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>, <span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> x2);
<a name="l00523"></a>00523 
<a name="l00524"></a>00524 <span class="keyword">public</span>:
<a name="l00525"></a>00525         CvFuzzyCurve();
<a name="l00526"></a>00526         ~CvFuzzyCurve();
<a name="l00527"></a>00527 
<a name="l00528"></a>00528         <span class="keywordtype">void</span> setCentre(<span class="keywordtype">double</span> _centre);
<a name="l00529"></a>00529         <span class="keywordtype">double</span> getCentre();
<a name="l00530"></a>00530         <span class="keywordtype">void</span> clear();
<a name="l00531"></a>00531         <span class="keywordtype">void</span> addPoint(<span class="keywordtype">double</span> <a class="code" href="highgui_8h.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>, <span class="keywordtype">double</span> y);
<a name="l00532"></a>00532         <span class="keywordtype">double</span> calcValue(<span class="keywordtype">double</span> <a class="code" href="highgui_8h.html#a2fad04a6d56e23dd58d9ebbcffae688f">param</a>);
<a name="l00533"></a>00533         <span class="keywordtype">double</span> getValue();
<a name="l00534"></a>00534         <span class="keywordtype">void</span> setValue(<span class="keywordtype">double</span> _value);
<a name="l00535"></a>00535 };
<a name="l00536"></a>00536 
<a name="l00537"></a>00537 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> CvFuzzyFunction {
<a name="l00538"></a>00538 <span class="keyword">public</span>:
<a name="l00539"></a>00539     std::vector&lt;CvFuzzyCurve&gt; curves;
<a name="l00540"></a>00540 
<a name="l00541"></a>00541         CvFuzzyFunction();
<a name="l00542"></a>00542         ~CvFuzzyFunction();
<a name="l00543"></a>00543         <span class="keywordtype">void</span> addCurve(CvFuzzyCurve *curve, <span class="keywordtype">double</span> <a class="code" href="cxcore_8h.html#ad4670c92695d4327c21292905a803901">value</a> = 0);
<a name="l00544"></a>00544         <span class="keywordtype">void</span> resetValues();
<a name="l00545"></a>00545         <span class="keywordtype">double</span> calcValue();
<a name="l00546"></a>00546         CvFuzzyCurve *newCurve();
<a name="l00547"></a>00547 };
<a name="l00548"></a>00548 
<a name="l00549"></a>00549 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> CvFuzzyRule {
<a name="l00550"></a>00550 <span class="keyword">private</span>:
<a name="l00551"></a>00551         CvFuzzyCurve *fuzzyInput1, *fuzzyInput2;
<a name="l00552"></a>00552         CvFuzzyCurve *fuzzyOutput;
<a name="l00553"></a>00553 <span class="keyword">public</span>:
<a name="l00554"></a>00554         CvFuzzyRule();
<a name="l00555"></a>00555         ~CvFuzzyRule();
<a name="l00556"></a>00556         <span class="keywordtype">void</span> setRule(CvFuzzyCurve *c1, CvFuzzyCurve *c2, CvFuzzyCurve *o1);
<a name="l00557"></a>00557         <span class="keywordtype">double</span> calcValue(<span class="keywordtype">double</span> <a class="code" href="cxcore_8h.html#a4a138cebb3d1124bb552aa80cc860eea">param1</a>, <span class="keywordtype">double</span> <a class="code" href="cxcore_8h.html#a31355e809c125347b49af078e58da79e">param2</a>);
<a name="l00558"></a>00558         CvFuzzyCurve *getOutputCurve();
<a name="l00559"></a>00559 };
<a name="l00560"></a>00560 
<a name="l00561"></a>00561 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> CvFuzzyController {
<a name="l00562"></a>00562 <span class="keyword">private</span>:
<a name="l00563"></a>00563     std::vector&lt;CvFuzzyRule*&gt; rules;
<a name="l00564"></a>00564 <span class="keyword">public</span>:
<a name="l00565"></a>00565         CvFuzzyController();
<a name="l00566"></a>00566         ~CvFuzzyController();
<a name="l00567"></a>00567         <span class="keywordtype">void</span> addRule(CvFuzzyCurve *c1, CvFuzzyCurve *c2, CvFuzzyCurve *o1);
<a name="l00568"></a>00568         <span class="keywordtype">double</span> calcOutput(<span class="keywordtype">double</span> <a class="code" href="cxcore_8h.html#a4a138cebb3d1124bb552aa80cc860eea">param1</a>, <span class="keywordtype">double</span> <a class="code" href="cxcore_8h.html#a31355e809c125347b49af078e58da79e">param2</a>);
<a name="l00569"></a>00569 };
<a name="l00570"></a>00570 
<a name="l00571"></a>00571 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> CvFuzzyMeanShiftTracker
<a name="l00572"></a>00572 {
<a name="l00573"></a>00573 <span class="keyword">private</span>:
<a name="l00574"></a>00574         <span class="keyword">class </span>FuzzyResizer
<a name="l00575"></a>00575         {
<a name="l00576"></a>00576         <span class="keyword">private</span>:
<a name="l00577"></a>00577                 CvFuzzyFunction iInput, iOutput;
<a name="l00578"></a>00578                 CvFuzzyController fuzzyController;
<a name="l00579"></a>00579         <span class="keyword">public</span>:
<a name="l00580"></a>00580                 FuzzyResizer();
<a name="l00581"></a>00581                 <span class="keywordtype">int</span> calcOutput(<span class="keywordtype">double</span> edgeDensity, <span class="keywordtype">double</span> density);
<a name="l00582"></a>00582         };
<a name="l00583"></a>00583 
<a name="l00584"></a>00584         <span class="keyword">class </span>SearchWindow
<a name="l00585"></a>00585         {
<a name="l00586"></a>00586         <span class="keyword">public</span>:
<a name="l00587"></a>00587                 FuzzyResizer *fuzzyResizer;
<a name="l00588"></a>00588                 <span class="keywordtype">int</span> <a class="code" href="highgui_8h.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>, <a class="code" href="highgui_8h.html#af1202c02b14870c18fb3a1da73e9e7c7">y</a>;
<a name="l00589"></a>00589                 <span class="keywordtype">int</span> <a class="code" href="highgui_8h.html#a2474a5474cbff19523a51eb1de01cda4">width</a>, <a class="code" href="highgui_8h.html#adc7b4b8a6ef510e136071efbc9cd9a58">height</a>, maxWidth, maxHeight, ellipseHeight, ellipseWidth;
<a name="l00590"></a>00590                 <span class="keywordtype">int</span> ldx, ldy, ldw, ldh, numShifts, numIters;
<a name="l00591"></a>00591                 <span class="keywordtype">int</span> xGc, yGc;
<a name="l00592"></a>00592                 <span class="keywordtype">long</span> m00, m01, m10, m11, m02, m20;
<a name="l00593"></a>00593                 <span class="keywordtype">double</span> ellipseAngle;
<a name="l00594"></a>00594                 <span class="keywordtype">double</span> density;
<a name="l00595"></a>00595                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> depthLow, depthHigh;
<a name="l00596"></a>00596                 <span class="keywordtype">int</span> verticalEdgeLeft, verticalEdgeRight, horizontalEdgeTop, horizontalEdgeBottom;
<a name="l00597"></a>00597 
<a name="l00598"></a>00598                 SearchWindow();
<a name="l00599"></a>00599                 ~SearchWindow();
<a name="l00600"></a>00600                 <span class="keywordtype">void</span> setSize(<span class="keywordtype">int</span> _x, <span class="keywordtype">int</span> _y, <span class="keywordtype">int</span> _width, <span class="keywordtype">int</span> _height);
<a name="l00601"></a>00601                 <span class="keywordtype">void</span> initDepthValues(<a class="code" href="struct___ipl_image.html">IplImage</a> *maskImage, <a class="code" href="struct___ipl_image.html">IplImage</a> *depthMap);
<a name="l00602"></a>00602                 <span class="keywordtype">bool</span> shift();
<a name="l00603"></a>00603                 <span class="keywordtype">void</span> extractInfo(<a class="code" href="struct___ipl_image.html">IplImage</a> *maskImage, <a class="code" href="struct___ipl_image.html">IplImage</a> *depthMap, <span class="keywordtype">bool</span> initDepth);
<a name="l00604"></a>00604                 <span class="keywordtype">void</span> getResizeAttribsEdgeDensityLinear(<span class="keywordtype">int</span> &amp;resizeDx, <span class="keywordtype">int</span> &amp;resizeDy, <span class="keywordtype">int</span> &amp;resizeDw, <span class="keywordtype">int</span> &amp;resizeDh);
<a name="l00605"></a>00605                 <span class="keywordtype">void</span> getResizeAttribsInnerDensity(<span class="keywordtype">int</span> &amp;resizeDx, <span class="keywordtype">int</span> &amp;resizeDy, <span class="keywordtype">int</span> &amp;resizeDw, <span class="keywordtype">int</span> &amp;resizeDh);
<a name="l00606"></a>00606                 <span class="keywordtype">void</span> getResizeAttribsEdgeDensityFuzzy(<span class="keywordtype">int</span> &amp;resizeDx, <span class="keywordtype">int</span> &amp;resizeDy, <span class="keywordtype">int</span> &amp;resizeDw, <span class="keywordtype">int</span> &amp;resizeDh);
<a name="l00607"></a>00607                 <span class="keywordtype">bool</span> meanShift(<a class="code" href="struct___ipl_image.html">IplImage</a> *maskImage, <a class="code" href="struct___ipl_image.html">IplImage</a> *depthMap, <span class="keywordtype">int</span> maxIteration, <span class="keywordtype">bool</span> initDepth);
<a name="l00608"></a>00608         };
<a name="l00609"></a>00609 
<a name="l00610"></a>00610 <span class="keyword">public</span>:
<a name="l00611"></a>00611         <span class="keyword">enum</span> TrackingState
<a name="l00612"></a>00612         {
<a name="l00613"></a>00613                 tsNone                  = 0,
<a name="l00614"></a>00614                 tsSearching     = 1,
<a name="l00615"></a>00615                 tsTracking              = 2,
<a name="l00616"></a>00616                 tsSetWindow     = 3,
<a name="l00617"></a>00617                 tsDisabled              = 10
<a name="l00618"></a>00618         };
<a name="l00619"></a>00619 
<a name="l00620"></a>00620         <span class="keyword">enum</span> ResizeMethod {
<a name="l00621"></a>00621                 rmEdgeDensityLinear             = 0,
<a name="l00622"></a>00622                 rmEdgeDensityFuzzy              = 1,
<a name="l00623"></a>00623                 rmInnerDensity                  = 2
<a name="l00624"></a>00624         };
<a name="l00625"></a>00625 
<a name="l00626"></a>00626         <span class="keyword">enum</span> {
<a name="l00627"></a>00627                 MinKernelMass                   = 1000
<a name="l00628"></a>00628         };
<a name="l00629"></a>00629 
<a name="l00630"></a>00630         SearchWindow <a class="code" href="cv_8h.html#a863a75780ba6c5de552f5361cb0d2c89">kernel</a>;
<a name="l00631"></a>00631         <span class="keywordtype">int</span> searchMode;
<a name="l00632"></a>00632 
<a name="l00633"></a>00633 <span class="keyword">private</span>:
<a name="l00634"></a>00634         <span class="keyword">enum</span>
<a name="l00635"></a>00635         {
<a name="l00636"></a>00636                 MaxMeanShiftIteration   = 5,
<a name="l00637"></a>00637                 MaxSetSizeIteration     = 5
<a name="l00638"></a>00638         };
<a name="l00639"></a>00639 
<a name="l00640"></a>00640         <span class="keywordtype">void</span> findOptimumSearchWindow(SearchWindow &amp;searchWindow, <a class="code" href="struct___ipl_image.html">IplImage</a> *maskImage, <a class="code" href="struct___ipl_image.html">IplImage</a> *depthMap, <span class="keywordtype">int</span> maxIteration, <span class="keywordtype">int</span> resizeMethod, <span class="keywordtype">bool</span> initDepth);
<a name="l00641"></a>00641 
<a name="l00642"></a>00642 <span class="keyword">public</span>:
<a name="l00643"></a>00643         CvFuzzyMeanShiftTracker();
<a name="l00644"></a>00644         ~CvFuzzyMeanShiftTracker();
<a name="l00645"></a>00645 
<a name="l00646"></a>00646         <span class="keywordtype">void</span> track(<a class="code" href="struct___ipl_image.html">IplImage</a> *maskImage, <a class="code" href="struct___ipl_image.html">IplImage</a> *depthMap, <span class="keywordtype">int</span> resizeMethod, <span class="keywordtype">bool</span> resetSearch, <span class="keywordtype">int</span> minKernelMass = MinKernelMass);
<a name="l00647"></a>00647 };
<a name="l00648"></a>00648 
<a name="l00649"></a>00649 
<a name="l00650"></a>00650 <span class="keyword">namespace </span>cv
<a name="l00651"></a>00651 {
<a name="l00652"></a>00652 
<a name="l00653"></a>00653 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> Octree
<a name="l00654"></a>00654 {
<a name="l00655"></a>00655 <span class="keyword">public</span>:    
<a name="l00656"></a>00656     <span class="keyword">struct </span>Node
<a name="l00657"></a>00657     {
<a name="l00658"></a>00658         Node() {}
<a name="l00659"></a>00659         <span class="keywordtype">int</span> begin, <a class="code" href="cxcore_8h.html#a338bddb6320c8e898e204d6273af2d67">end</a>;
<a name="l00660"></a>00660         <span class="keywordtype">float</span> x_min, x_max, y_min, y_max, z_min, z_max;         
<a name="l00661"></a>00661         <span class="keywordtype">int</span> maxLevels;
<a name="l00662"></a>00662         <span class="keywordtype">bool</span> isLeaf;
<a name="l00663"></a>00663         <span class="keywordtype">int</span> children[8];
<a name="l00664"></a>00664     };
<a name="l00665"></a>00665 
<a name="l00666"></a>00666     Octree();
<a name="l00667"></a>00667     Octree( <span class="keyword">const</span> vector&lt;Point3f&gt;&amp; <a class="code" href="cv_8h.html#a8c4b676395bf614cc92b782d12f18847">points</a>, <span class="keywordtype">int</span> maxLevels = 10, <span class="keywordtype">int</span> minPoints = 20 );
<a name="l00668"></a>00668     <span class="keyword">virtual</span> ~Octree();
<a name="l00669"></a>00669 
<a name="l00670"></a>00670     <span class="keyword">virtual</span> <span class="keywordtype">void</span> buildTree( <span class="keyword">const</span> vector&lt;Point3f&gt;&amp; <a class="code" href="cv_8h.html#a8c4b676395bf614cc92b782d12f18847">points</a>, <span class="keywordtype">int</span> maxLevels = 10, <span class="keywordtype">int</span> minPoints = 20 );
<a name="l00671"></a>00671     <span class="keyword">virtual</span> <span class="keywordtype">void</span> getPointsWithinSphere( <span class="keyword">const</span> Point3f&amp; <a class="code" href="cv_8h.html#ac74d5c2b1b8e008e97876b334e343b30">center</a>, <span class="keywordtype">float</span> <a class="code" href="cv_8h.html#a32526d67e420fc7060ade2efeaeda976">radius</a>,
<a name="l00672"></a>00672                                         vector&lt;Point3f&gt;&amp; <a class="code" href="cv_8h.html#a8c4b676395bf614cc92b782d12f18847">points</a> ) <span class="keyword">const</span>;
<a name="l00673"></a>00673     <span class="keyword">const</span> vector&lt;Node&gt;&amp; getNodes()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> nodes; }
<a name="l00674"></a>00674 <span class="keyword">private</span>:
<a name="l00675"></a>00675     <span class="keywordtype">int</span> minPoints;
<a name="l00676"></a>00676     vector&lt;Point3f&gt; <a class="code" href="cv_8h.html#a8c4b676395bf614cc92b782d12f18847">points</a>;
<a name="l00677"></a>00677     vector&lt;Node&gt; nodes;
<a name="l00678"></a>00678         
<a name="l00679"></a>00679         <span class="keyword">virtual</span> <span class="keywordtype">void</span> buildNext(<span class="keywordtype">size_t</span> node_ind);
<a name="l00680"></a>00680 };
<a name="l00681"></a>00681 
<a name="l00682"></a>00682 
<a name="l00683"></a>00683 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> Mesh3D
<a name="l00684"></a>00684 {
<a name="l00685"></a>00685 <span class="keyword">public</span>:
<a name="l00686"></a>00686     <span class="keyword">struct </span>EmptyMeshException {};
<a name="l00687"></a>00687 
<a name="l00688"></a>00688     Mesh3D();
<a name="l00689"></a>00689     Mesh3D(<span class="keyword">const</span> vector&lt;Point3f&gt;&amp; <a class="code" href="cxcore_8h.html#a17b79d218d8b9be4ba97a5fd7ddbf424">vtx</a>);
<a name="l00690"></a>00690     ~Mesh3D();
<a name="l00691"></a>00691 
<a name="l00692"></a>00692     <span class="keywordtype">void</span> buildOctree();
<a name="l00693"></a>00693     <span class="keywordtype">void</span> clearOctree();
<a name="l00694"></a>00694     <span class="keywordtype">float</span> estimateResolution(<span class="keywordtype">float</span> tryRatio = 0.1f);        
<a name="l00695"></a>00695     <span class="keywordtype">void</span> computeNormals(<span class="keywordtype">float</span> normalRadius, <span class="keywordtype">int</span> minNeighbors = 20);
<a name="l00696"></a>00696     <span class="keywordtype">void</span> computeNormals(<span class="keyword">const</span> vector&lt;int&gt;&amp; subset, <span class="keywordtype">float</span> normalRadius, <span class="keywordtype">int</span> minNeighbors = 20);
<a name="l00697"></a>00697     
<a name="l00698"></a>00698     <span class="keywordtype">void</span> writeAsVrml(<span class="keyword">const</span> String&amp; file, <span class="keyword">const</span> vector&lt;Scalar&gt;&amp; colors = vector&lt;Scalar&gt;()) <span class="keyword">const</span>;
<a name="l00699"></a>00699     
<a name="l00700"></a>00700     vector&lt;Point3f&gt; <a class="code" href="cxcore_8h.html#a17b79d218d8b9be4ba97a5fd7ddbf424">vtx</a>;
<a name="l00701"></a>00701     vector&lt;Point3f&gt; normals;
<a name="l00702"></a>00702     <span class="keywordtype">float</span> resolution;    
<a name="l00703"></a>00703     Octree octree;
<a name="l00704"></a>00704 
<a name="l00705"></a>00705     <span class="keyword">const</span> <span class="keyword">static</span> Point3f allzero;
<a name="l00706"></a>00706 };
<a name="l00707"></a>00707 
<a name="l00708"></a>00708 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> SpinImageModel
<a name="l00709"></a>00709 {
<a name="l00710"></a>00710 <span class="keyword">public</span>:
<a name="l00711"></a>00711     
<a name="l00712"></a>00712     <span class="comment">/* model parameters, leave unset for default or auto estimate */</span>
<a name="l00713"></a>00713     <span class="keywordtype">float</span> normalRadius;
<a name="l00714"></a>00714     <span class="keywordtype">int</span> minNeighbors;
<a name="l00715"></a>00715 
<a name="l00716"></a>00716     <span class="keywordtype">float</span> binSize;
<a name="l00717"></a>00717     <span class="keywordtype">int</span> imageWidth;
<a name="l00718"></a>00718 
<a name="l00719"></a>00719     <span class="keywordtype">float</span> <a class="code" href="cv_8h.html#a2b2a31d8b9a3be743757541bf16e5801">lambda</a>;                        
<a name="l00720"></a>00720     <span class="keywordtype">float</span> <a class="code" href="cv_8h.html#a977df9847c7e455667f9fdaa49fbaa11">gamma</a>;
<a name="l00721"></a>00721 
<a name="l00722"></a>00722     <span class="keywordtype">float</span> T_GeometriccConsistency;
<a name="l00723"></a>00723     <span class="keywordtype">float</span> T_GroupingCorespondances;
<a name="l00724"></a>00724 
<a name="l00725"></a>00725     <span class="comment">/* public interface */</span>
<a name="l00726"></a>00726     SpinImageModel();
<a name="l00727"></a>00727     <span class="keyword">explicit</span> SpinImageModel(<span class="keyword">const</span> Mesh3D&amp; mesh);
<a name="l00728"></a>00728     ~SpinImageModel();
<a name="l00729"></a>00729 
<a name="l00730"></a>00730     <span class="keywordtype">void</span> setLogger(std::ostream* log);
<a name="l00731"></a>00731     <span class="keywordtype">void</span> selectRandomSubset(<span class="keywordtype">float</span> ratio);         
<a name="l00732"></a>00732     <span class="keywordtype">void</span> setSubset(<span class="keyword">const</span> vector&lt;int&gt;&amp; subset);         
<a name="l00733"></a>00733     <span class="keywordtype">void</span> compute();
<a name="l00734"></a>00734 
<a name="l00735"></a>00735     <span class="keywordtype">void</span> match(<span class="keyword">const</span> SpinImageModel&amp; scene, vector&lt; vector&lt;Vec2i&gt; &gt;&amp; <a class="code" href="cv_8h.html#adf46fee3107905e425f34254cbce0d9a">result</a>);    
<a name="l00736"></a>00736 
<a name="l00737"></a>00737     Mat packRandomScaledSpins(<span class="keywordtype">bool</span> separateScale = <span class="keyword">false</span>, <span class="keywordtype">size_t</span> xCount = 10, <span class="keywordtype">size_t</span> yCount = 10) <span class="keyword">const</span>;
<a name="l00738"></a>00738     
<a name="l00739"></a>00739     <span class="keywordtype">size_t</span> getSpinCount()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> spinImages.rows; }
<a name="l00740"></a>00740     Mat getSpinImage(<span class="keywordtype">size_t</span> <a class="code" href="cxcore_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> spinImages.row(index); }
<a name="l00741"></a>00741     <span class="keyword">const</span> Point3f&amp; getSpinVertex(<span class="keywordtype">size_t</span> index)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mesh.vtx[subset[<a class="code" href="cxcore_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>]]; }
<a name="l00742"></a>00742     <span class="keyword">const</span> Point3f&amp; getSpinNormal(<span class="keywordtype">size_t</span> index)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mesh.normals[subset[<a class="code" href="cxcore_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>]]; }
<a name="l00743"></a>00743 
<a name="l00744"></a>00744     <span class="keyword">const</span> Mesh3D&amp; getMesh()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mesh; }
<a name="l00745"></a>00745     Mesh3D&amp; getMesh() { <span class="keywordflow">return</span> mesh; }
<a name="l00746"></a>00746 
<a name="l00747"></a>00747     <span class="comment">/* static utility functions */</span>
<a name="l00748"></a>00748     <span class="keyword">static</span> <span class="keywordtype">bool</span> spinCorrelation(<span class="keyword">const</span> Mat&amp; spin1, <span class="keyword">const</span> Mat&amp; spin2, <span class="keywordtype">float</span> <a class="code" href="cv_8h.html#a2b2a31d8b9a3be743757541bf16e5801">lambda</a>, <span class="keywordtype">float</span>&amp; <a class="code" href="cv_8h.html#adf46fee3107905e425f34254cbce0d9a">result</a>);
<a name="l00749"></a>00749 
<a name="l00750"></a>00750     <span class="keyword">static</span> Point2f calcSpinMapCoo(<span class="keyword">const</span> Point3f&amp; point, <span class="keyword">const</span> Point3f&amp; vertex, <span class="keyword">const</span> Point3f&amp; normal);
<a name="l00751"></a>00751 
<a name="l00752"></a>00752     <span class="keyword">static</span> <span class="keywordtype">float</span> geometricConsistency(<span class="keyword">const</span> Point3f&amp; pointScene1, <span class="keyword">const</span> Point3f&amp; normalScene1,
<a name="l00753"></a>00753                                       <span class="keyword">const</span> Point3f&amp; pointModel1, <span class="keyword">const</span> Point3f&amp; normalModel1,   
<a name="l00754"></a>00754                                       <span class="keyword">const</span> Point3f&amp; pointScene2, <span class="keyword">const</span> Point3f&amp; normalScene2,                               
<a name="l00755"></a>00755                                       <span class="keyword">const</span> Point3f&amp; pointModel2, <span class="keyword">const</span> Point3f&amp; normalModel2);
<a name="l00756"></a>00756 
<a name="l00757"></a>00757     <span class="keyword">static</span> <span class="keywordtype">float</span> groupingCreteria(<span class="keyword">const</span> Point3f&amp; pointScene1, <span class="keyword">const</span> Point3f&amp; normalScene1,
<a name="l00758"></a>00758                                   <span class="keyword">const</span> Point3f&amp; pointModel1, <span class="keyword">const</span> Point3f&amp; normalModel1,
<a name="l00759"></a>00759                                   <span class="keyword">const</span> Point3f&amp; pointScene2, <span class="keyword">const</span> Point3f&amp; normalScene2,                               
<a name="l00760"></a>00760                                   <span class="keyword">const</span> Point3f&amp; pointModel2, <span class="keyword">const</span> Point3f&amp; normalModel2, 
<a name="l00761"></a>00761                                   <span class="keywordtype">float</span> <a class="code" href="cv_8h.html#a977df9847c7e455667f9fdaa49fbaa11">gamma</a>);
<a name="l00762"></a>00762 <span class="keyword">protected</span>:       
<a name="l00763"></a>00763     <span class="keywordtype">void</span> defaultParams();
<a name="l00764"></a>00764 
<a name="l00765"></a>00765     <span class="keywordtype">void</span> matchSpinToModel(<span class="keyword">const</span> Mat&amp; spin, vector&lt;int&gt;&amp; indeces, 
<a name="l00766"></a>00766         vector&lt;float&gt;&amp; corrCoeffs, <span class="keywordtype">bool</span> useExtremeOutliers = <span class="keyword">true</span>) <span class="keyword">const</span>; 
<a name="l00767"></a>00767 
<a name="l00768"></a>00768     <span class="keywordtype">void</span> repackSpinImages(<span class="keyword">const</span> vector&lt;uchar&gt;&amp; <a class="code" href="cv_8h.html#a714486ca39ce82afa199836b36993f59">mask</a>, Mat&amp; spinImages, <span class="keywordtype">bool</span> reAlloc = <span class="keyword">true</span>) <span class="keyword">const</span>;
<a name="l00769"></a>00769              
<a name="l00770"></a>00770     vector&lt;int&gt; subset;
<a name="l00771"></a>00771     Mesh3D mesh;
<a name="l00772"></a>00772     Mat spinImages;
<a name="l00773"></a>00773     std::ostream* out;
<a name="l00774"></a>00774 };
<a name="l00775"></a>00775 
<a name="l00776"></a>00776 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> TickMeter
<a name="l00777"></a>00777 {
<a name="l00778"></a>00778 <span class="keyword">public</span>:
<a name="l00779"></a>00779     TickMeter();
<a name="l00780"></a>00780     <span class="keywordtype">void</span> <a class="code" href="cxcore_8h.html#a45314566a84a31f43e6435d1eb24d4ec">start</a>();    
<a name="l00781"></a>00781     <span class="keywordtype">void</span> stop();
<a name="l00782"></a>00782 
<a name="l00783"></a>00783     <a class="code" href="cxtypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> getTimeTicks() <span class="keyword">const</span>;
<a name="l00784"></a>00784     <span class="keywordtype">double</span> getTimeMicro() <span class="keyword">const</span>;
<a name="l00785"></a>00785     <span class="keywordtype">double</span> getTimeMilli() <span class="keyword">const</span>;
<a name="l00786"></a>00786     <span class="keywordtype">double</span> getTimeSec()   <span class="keyword">const</span>;
<a name="l00787"></a>00787     <a class="code" href="cxtypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> getCounter() <span class="keyword">const</span>;
<a name="l00788"></a>00788 
<a name="l00789"></a>00789     <span class="keywordtype">void</span> reset();
<a name="l00790"></a>00790 <span class="keyword">private</span>:
<a name="l00791"></a>00791     <a class="code" href="cxtypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> counter;
<a name="l00792"></a>00792     <a class="code" href="cxtypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> sumTime;
<a name="l00793"></a>00793     <a class="code" href="cxtypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> startTime;
<a name="l00794"></a>00794 };
<a name="l00795"></a>00795 
<a name="l00796"></a>00796 <a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> std::ostream&amp; operator&lt;&lt;(std::ostream&amp; out, <span class="keyword">const</span> TickMeter&amp; tm);
<a name="l00797"></a>00797 
<a name="l00798"></a>00798 <span class="comment">/****************************************************************************************\</span>
<a name="l00799"></a>00799 <span class="comment">*            HOG (Histogram-of-Oriented-Gradients) Descriptor and Object Detector        *</span>
<a name="l00800"></a>00800 <span class="comment">\****************************************************************************************/</span>
<a name="l00801"></a>00801 
<a name="l00802"></a>00802 <span class="keyword">struct </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> HOGDescriptor
<a name="l00803"></a>00803 {
<a name="l00804"></a>00804 <span class="keyword">public</span>:
<a name="l00805"></a>00805     <span class="keyword">enum</span> { L2Hys=0 };
<a name="l00806"></a>00806 
<a name="l00807"></a>00807     HOGDescriptor() : winSize(64,128), blockSize(16,16), blockStride(8,8),
<a name="l00808"></a>00808         cellSize(8,8), nbins(9), derivAperture(1), winSigma(-1),
<a name="l00809"></a>00809         histogramNormType(L2Hys), L2HysThreshold(0.2), gammaCorrection(true)
<a name="l00810"></a>00810     {}
<a name="l00811"></a>00811 
<a name="l00812"></a>00812     HOGDescriptor(Size _winSize, Size _blockSize, Size _blockStride,
<a name="l00813"></a>00813         Size _cellSize, <span class="keywordtype">int</span> _nbins, <span class="keywordtype">int</span> _derivAperture=1, <span class="keywordtype">double</span> _winSigma=-1,
<a name="l00814"></a>00814         <span class="keywordtype">int</span> _histogramNormType=L2Hys, <span class="keywordtype">double</span> _L2HysThreshold=0.2, <span class="keywordtype">bool</span> _gammaCorrection=<span class="keyword">false</span>)
<a name="l00815"></a>00815         : winSize(_winSize), blockSize(_blockSize), blockStride(_blockStride), cellSize(_cellSize),
<a name="l00816"></a>00816         nbins(_nbins), derivAperture(_derivAperture), winSigma(_winSigma),
<a name="l00817"></a>00817         histogramNormType(_histogramNormType), L2HysThreshold(_L2HysThreshold),
<a name="l00818"></a>00818         gammaCorrection(_gammaCorrection)
<a name="l00819"></a>00819     {}
<a name="l00820"></a>00820 
<a name="l00821"></a>00821     HOGDescriptor(<span class="keyword">const</span> String&amp; <a class="code" href="cxcore_8h.html#acc427f35f3bd9f865d39012657cc42f8">filename</a>)
<a name="l00822"></a>00822     {
<a name="l00823"></a>00823         load(filename);
<a name="l00824"></a>00824     }
<a name="l00825"></a>00825 
<a name="l00826"></a>00826     <span class="keyword">virtual</span> ~HOGDescriptor() {}
<a name="l00827"></a>00827 
<a name="l00828"></a>00828     <span class="keywordtype">size_t</span> getDescriptorSize() <span class="keyword">const</span>;
<a name="l00829"></a>00829     <span class="keywordtype">bool</span> checkDetectorSize() <span class="keyword">const</span>;
<a name="l00830"></a>00830     <span class="keywordtype">double</span> getWinSigma() <span class="keyword">const</span>;
<a name="l00831"></a>00831 
<a name="l00832"></a>00832     <span class="keyword">virtual</span> <span class="keywordtype">void</span> setSVMDetector(<span class="keyword">const</span> vector&lt;float&gt;&amp; _svmdetector);
<a name="l00833"></a>00833 
<a name="l00834"></a>00834     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> load(<span class="keyword">const</span> String&amp; <a class="code" href="cxcore_8h.html#acc427f35f3bd9f865d39012657cc42f8">filename</a>, <span class="keyword">const</span> String&amp; objname=String());
<a name="l00835"></a>00835     <span class="keyword">virtual</span> <span class="keywordtype">void</span> save(<span class="keyword">const</span> String&amp; filename, <span class="keyword">const</span> String&amp; objname=String()) <span class="keyword">const</span>;
<a name="l00836"></a>00836 
<a name="l00837"></a>00837     <span class="keyword">virtual</span> <span class="keywordtype">void</span> compute(<span class="keyword">const</span> Mat&amp; img,
<a name="l00838"></a>00838                          vector&lt;float&gt;&amp; <a class="code" href="cv_8h.html#a1e3702ddbca6258f57508c22eff26bf2">descriptors</a>,
<a name="l00839"></a>00839                          Size winStride=Size(), Size padding=Size(),
<a name="l00840"></a>00840                          <span class="keyword">const</span> vector&lt;Point&gt;&amp; locations=vector&lt;Point&gt;()) <span class="keyword">const</span>;
<a name="l00841"></a>00841     <span class="keyword">virtual</span> <span class="keywordtype">void</span> detect(<span class="keyword">const</span> Mat&amp; img, vector&lt;Point&gt;&amp; foundLocations,
<a name="l00842"></a>00842                         <span class="keywordtype">double</span> hitThreshold=0, Size winStride=Size(),
<a name="l00843"></a>00843                         Size padding=Size(),
<a name="l00844"></a>00844                         <span class="keyword">const</span> vector&lt;Point&gt;&amp; searchLocations=vector&lt;Point&gt;()) <span class="keyword">const</span>;
<a name="l00845"></a>00845     <span class="keyword">virtual</span> <span class="keywordtype">void</span> detectMultiScale(<span class="keyword">const</span> Mat&amp; img, vector&lt;Rect&gt;&amp; foundLocations,
<a name="l00846"></a>00846                                   <span class="keywordtype">double</span> hitThreshold=0, Size winStride=Size(),
<a name="l00847"></a>00847                                   Size padding=Size(), <span class="keywordtype">double</span> <a class="code" href="cv_8h.html#a1f622eb9b9e06b30862ca90cdf2c078b">scale</a>=1.05,
<a name="l00848"></a>00848                                   <span class="keywordtype">int</span> groupThreshold=2) <span class="keyword">const</span>;
<a name="l00849"></a>00849     <span class="keyword">virtual</span> <span class="keywordtype">void</span> computeGradient(<span class="keyword">const</span> Mat&amp; img, Mat&amp; grad, Mat&amp; angleOfs,
<a name="l00850"></a>00850                                  Size paddingTL=Size(), Size paddingBR=Size()) <span class="keyword">const</span>;
<a name="l00851"></a>00851 
<a name="l00852"></a>00852     <span class="keyword">static</span> vector&lt;float&gt; getDefaultPeopleDetector();
<a name="l00853"></a>00853 
<a name="l00854"></a>00854     Size winSize;
<a name="l00855"></a>00855     Size blockSize;
<a name="l00856"></a>00856     Size blockStride;
<a name="l00857"></a>00857     Size cellSize;
<a name="l00858"></a>00858     <span class="keywordtype">int</span> nbins;
<a name="l00859"></a>00859     <span class="keywordtype">int</span> derivAperture;
<a name="l00860"></a>00860     <span class="keywordtype">double</span> winSigma;
<a name="l00861"></a>00861     <span class="keywordtype">int</span> histogramNormType;
<a name="l00862"></a>00862     <span class="keywordtype">double</span> L2HysThreshold;
<a name="l00863"></a>00863     <span class="keywordtype">bool</span> gammaCorrection;
<a name="l00864"></a>00864     vector&lt;float&gt; svmDetector;
<a name="l00865"></a>00865 };
<a name="l00866"></a>00866 
<a name="l00867"></a>00867 
<a name="l00868"></a>00868 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> SelfSimDescriptor
<a name="l00869"></a>00869 {
<a name="l00870"></a>00870 <span class="keyword">public</span>:
<a name="l00871"></a>00871     SelfSimDescriptor();
<a name="l00872"></a>00872     SelfSimDescriptor(<span class="keywordtype">int</span> _ssize, <span class="keywordtype">int</span> _lsize,
<a name="l00873"></a>00873         <span class="keywordtype">int</span> _startDistanceBucket=DEFAULT_START_DISTANCE_BUCKET,
<a name="l00874"></a>00874         <span class="keywordtype">int</span> _numberOfDistanceBuckets=DEFAULT_NUM_DISTANCE_BUCKETS,
<a name="l00875"></a>00875         <span class="keywordtype">int</span> _nangles=DEFAULT_NUM_ANGLES);
<a name="l00876"></a>00876         SelfSimDescriptor(<span class="keyword">const</span> SelfSimDescriptor&amp; ss);
<a name="l00877"></a>00877         <span class="keyword">virtual</span> ~SelfSimDescriptor();
<a name="l00878"></a>00878     SelfSimDescriptor&amp; operator = (<span class="keyword">const</span> SelfSimDescriptor&amp; ss);
<a name="l00879"></a>00879 
<a name="l00880"></a>00880     <span class="keywordtype">size_t</span> getDescriptorSize() <span class="keyword">const</span>;
<a name="l00881"></a>00881     Size getGridSize( Size imgsize, Size winStride ) <span class="keyword">const</span>;
<a name="l00882"></a>00882 
<a name="l00883"></a>00883     <span class="keyword">virtual</span> <span class="keywordtype">void</span> compute(<span class="keyword">const</span> Mat&amp; img, vector&lt;float&gt;&amp; descriptors, Size winStride=Size(),
<a name="l00884"></a>00884                          <span class="keyword">const</span> vector&lt;Point&gt;&amp; locations=vector&lt;Point&gt;()) <span class="keyword">const</span>;
<a name="l00885"></a>00885     <span class="keyword">virtual</span> <span class="keywordtype">void</span> computeLogPolarMapping(Mat&amp; mappingMask) <span class="keyword">const</span>;
<a name="l00886"></a>00886     <span class="keyword">virtual</span> <span class="keywordtype">void</span> SSD(<span class="keyword">const</span> Mat&amp; img, Point <a class="code" href="cv_8h.html#a69c6090aa56793ec8ef2457bc6d45b45">pt</a>, Mat&amp; ssd) <span class="keyword">const</span>;
<a name="l00887"></a>00887 
<a name="l00888"></a>00888         <span class="keywordtype">int</span> smallSize;
<a name="l00889"></a>00889         <span class="keywordtype">int</span> largeSize;
<a name="l00890"></a>00890     <span class="keywordtype">int</span> startDistanceBucket;
<a name="l00891"></a>00891     <span class="keywordtype">int</span> numberOfDistanceBuckets;
<a name="l00892"></a>00892     <span class="keywordtype">int</span> numberOfAngles;
<a name="l00893"></a>00893 
<a name="l00894"></a>00894     <span class="keyword">enum</span> { DEFAULT_SMALL_SIZE = 5, DEFAULT_LARGE_SIZE = 41,
<a name="l00895"></a>00895         DEFAULT_NUM_ANGLES = 20, DEFAULT_START_DISTANCE_BUCKET = 3,
<a name="l00896"></a>00896         DEFAULT_NUM_DISTANCE_BUCKETS = 7 };
<a name="l00897"></a>00897 };
<a name="l00898"></a>00898 
<a name="l00899"></a>00899     
<a name="l00900"></a>00900 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> PatchGenerator
<a name="l00901"></a>00901 {
<a name="l00902"></a>00902 <span class="keyword">public</span>:
<a name="l00903"></a>00903     PatchGenerator();
<a name="l00904"></a>00904     PatchGenerator(<span class="keywordtype">double</span> _backgroundMin, <span class="keywordtype">double</span> _backgroundMax,
<a name="l00905"></a>00905                    <span class="keywordtype">double</span> _noiseRange, <span class="keywordtype">bool</span> _randomBlur=<span class="keyword">true</span>,
<a name="l00906"></a>00906                    <span class="keywordtype">double</span> _lambdaMin=0.6, <span class="keywordtype">double</span> _lambdaMax=1.5,
<a name="l00907"></a>00907                    <span class="keywordtype">double</span> _thetaMin=-<a class="code" href="cxtypes_8h.html#a677b89fae9308b340ddaebf0dba8455f">CV_PI</a>, <span class="keywordtype">double</span> _thetaMax=<a class="code" href="cxtypes_8h.html#a677b89fae9308b340ddaebf0dba8455f">CV_PI</a>,
<a name="l00908"></a>00908                    <span class="keywordtype">double</span> _phiMin=-<a class="code" href="cxtypes_8h.html#a677b89fae9308b340ddaebf0dba8455f">CV_PI</a>, <span class="keywordtype">double</span> _phiMax=<a class="code" href="cxtypes_8h.html#a677b89fae9308b340ddaebf0dba8455f">CV_PI</a> );
<a name="l00909"></a>00909     <span class="keywordtype">void</span> operator()(<span class="keyword">const</span> Mat&amp; <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>, Point2f <a class="code" href="cv_8h.html#a69c6090aa56793ec8ef2457bc6d45b45">pt</a>, Mat&amp; patch, Size patchSize, RNG&amp; <a class="code" href="cxcore_8h.html#a8d3f239dca9d5c72c8a66d7a1c142efd">rng</a>) <span class="keyword">const</span>;
<a name="l00910"></a>00910     <span class="keywordtype">void</span> operator()(<span class="keyword">const</span> Mat&amp; <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>, <span class="keyword">const</span> Mat&amp; transform, Mat&amp; patch,
<a name="l00911"></a>00911                     Size patchSize, RNG&amp; <a class="code" href="cxcore_8h.html#a8d3f239dca9d5c72c8a66d7a1c142efd">rng</a>) <span class="keyword">const</span>;
<a name="l00912"></a>00912     <span class="keywordtype">void</span> warpWholeImage(<span class="keyword">const</span> Mat&amp; <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>, Mat&amp; matT, Mat&amp; buf,
<a name="l00913"></a>00913                         Mat&amp; warped, <span class="keywordtype">int</span> border, RNG&amp; <a class="code" href="cxcore_8h.html#a8d3f239dca9d5c72c8a66d7a1c142efd">rng</a>) <span class="keyword">const</span>;
<a name="l00914"></a>00914     <span class="keywordtype">void</span> generateRandomTransform(Point2f srcCenter, Point2f dstCenter,
<a name="l00915"></a>00915                                  Mat&amp; transform, RNG&amp; <a class="code" href="cxcore_8h.html#a8d3f239dca9d5c72c8a66d7a1c142efd">rng</a>, <span class="keywordtype">bool</span> inverse=<span class="keyword">false</span>) <span class="keyword">const</span>;
<a name="l00916"></a>00916     <span class="keywordtype">double</span> backgroundMin, backgroundMax;
<a name="l00917"></a>00917     <span class="keywordtype">double</span> noiseRange;
<a name="l00918"></a>00918     <span class="keywordtype">bool</span> randomBlur;
<a name="l00919"></a>00919     <span class="keywordtype">double</span> lambdaMin, lambdaMax;
<a name="l00920"></a>00920     <span class="keywordtype">double</span> thetaMin, thetaMax;
<a name="l00921"></a>00921     <span class="keywordtype">double</span> phiMin, phiMax;
<a name="l00922"></a>00922 };
<a name="l00923"></a>00923 
<a name="l00924"></a>00924     
<a name="l00925"></a>00925 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> LDetector
<a name="l00926"></a>00926 {
<a name="l00927"></a>00927 <span class="keyword">public</span>:    
<a name="l00928"></a>00928     LDetector();
<a name="l00929"></a>00929     LDetector(<span class="keywordtype">int</span> _radius, <span class="keywordtype">int</span> _threshold, <span class="keywordtype">int</span> _nOctaves,
<a name="l00930"></a>00930               <span class="keywordtype">int</span> _nViews, <span class="keywordtype">double</span> _baseFeatureSize, <span class="keywordtype">double</span> _clusteringDistance);
<a name="l00931"></a>00931     <span class="keywordtype">void</span> operator()(<span class="keyword">const</span> Mat&amp; <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>, vector&lt;KeyPoint&gt;&amp; <a class="code" href="cv_8h.html#af95b6678bbbdd664ed15fe6d4190d355">keypoints</a>, <span class="keywordtype">int</span> maxCount=0, <span class="keywordtype">bool</span> scaleCoords=<span class="keyword">true</span>) <span class="keyword">const</span>;
<a name="l00932"></a>00932     <span class="keywordtype">void</span> operator()(<span class="keyword">const</span> vector&lt;Mat&gt;&amp; pyr, vector&lt;KeyPoint&gt;&amp; <a class="code" href="cv_8h.html#af95b6678bbbdd664ed15fe6d4190d355">keypoints</a>, <span class="keywordtype">int</span> maxCount=0, <span class="keywordtype">bool</span> scaleCoords=<span class="keyword">true</span>) <span class="keyword">const</span>;
<a name="l00933"></a>00933     <span class="keywordtype">void</span> getMostStable2D(<span class="keyword">const</span> Mat&amp; <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>, vector&lt;KeyPoint&gt;&amp; <a class="code" href="cv_8h.html#af95b6678bbbdd664ed15fe6d4190d355">keypoints</a>,
<a name="l00934"></a>00934                          <span class="keywordtype">int</span> maxCount, <span class="keyword">const</span> PatchGenerator&amp; patchGenerator) <span class="keyword">const</span>;
<a name="l00935"></a>00935     <span class="keywordtype">void</span> setVerbose(<span class="keywordtype">bool</span> verbose);
<a name="l00936"></a>00936     
<a name="l00937"></a>00937     <span class="keywordtype">void</span> read(<span class="keyword">const</span> FileNode&amp; <a class="code" href="cxcore_8h.html#a4e145da43d8cadc65b69ce0c2a2cc76a">node</a>);
<a name="l00938"></a>00938     <span class="keywordtype">void</span> write(FileStorage&amp; fs, <span class="keyword">const</span> String&amp; <a class="code" href="cxcore_8h.html#add928d8eb85ea33a25a67db3406d4887">name</a>=String()) <span class="keyword">const</span>;
<a name="l00939"></a>00939     
<a name="l00940"></a>00940     <span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a32526d67e420fc7060ade2efeaeda976">radius</a>;
<a name="l00941"></a>00941     <span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a32b004637d3b8895570fd73c28492698">threshold</a>;
<a name="l00942"></a>00942     <span class="keywordtype">int</span> nOctaves;
<a name="l00943"></a>00943     <span class="keywordtype">int</span> nViews;
<a name="l00944"></a>00944     <span class="keywordtype">bool</span> verbose;
<a name="l00945"></a>00945     
<a name="l00946"></a>00946     <span class="keywordtype">double</span> baseFeatureSize;
<a name="l00947"></a>00947     <span class="keywordtype">double</span> clusteringDistance;
<a name="l00948"></a>00948 };
<a name="l00949"></a>00949 
<a name="l00950"></a>00950 <span class="keyword">typedef</span> LDetector YAPE;
<a name="l00951"></a>00951 
<a name="l00952"></a>00952 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> FernClassifier
<a name="l00953"></a>00953 {
<a name="l00954"></a>00954 <span class="keyword">public</span>:
<a name="l00955"></a>00955     FernClassifier();
<a name="l00956"></a>00956     FernClassifier(<span class="keyword">const</span> FileNode&amp; <a class="code" href="cxcore_8h.html#a4e145da43d8cadc65b69ce0c2a2cc76a">node</a>);
<a name="l00957"></a>00957     FernClassifier(<span class="keyword">const</span> vector&lt;Point2f&gt;&amp; <a class="code" href="cv_8h.html#a8c4b676395bf614cc92b782d12f18847">points</a>,
<a name="l00958"></a>00958                    <span class="keyword">const</span> vector&lt;Ptr&lt;Mat&gt; &gt;&amp; refimgs,
<a name="l00959"></a>00959                    <span class="keyword">const</span> vector&lt;int&gt;&amp; <a class="code" href="cxcore_8h.html#a1342f74a0f7dd7c20ab7e79b2e6e5af5">labels</a>=vector&lt;int&gt;(),
<a name="l00960"></a>00960                    <span class="keywordtype">int</span> _nclasses=0, <span class="keywordtype">int</span> _patchSize=PATCH_SIZE,
<a name="l00961"></a>00961                    <span class="keywordtype">int</span> _signatureSize=DEFAULT_SIGNATURE_SIZE,
<a name="l00962"></a>00962                    <span class="keywordtype">int</span> _nstructs=DEFAULT_STRUCTS,
<a name="l00963"></a>00963                    <span class="keywordtype">int</span> _structSize=DEFAULT_STRUCT_SIZE,
<a name="l00964"></a>00964                    <span class="keywordtype">int</span> _nviews=DEFAULT_VIEWS,
<a name="l00965"></a>00965                    <span class="keywordtype">int</span> _compressionMethod=COMPRESSION_NONE,
<a name="l00966"></a>00966                    <span class="keyword">const</span> PatchGenerator&amp; patchGenerator=PatchGenerator());
<a name="l00967"></a>00967     <span class="keyword">virtual</span> ~FernClassifier();
<a name="l00968"></a>00968     <span class="keyword">virtual</span> <span class="keywordtype">void</span> read(<span class="keyword">const</span> FileNode&amp; <a class="code" href="cv_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);
<a name="l00969"></a>00969     <span class="keyword">virtual</span> <span class="keywordtype">void</span> write(FileStorage&amp; fs, <span class="keyword">const</span> String&amp; <a class="code" href="cxcore_8h.html#add928d8eb85ea33a25a67db3406d4887">name</a>=String()) <span class="keyword">const</span>;
<a name="l00970"></a>00970     <span class="keyword">virtual</span> <span class="keywordtype">void</span> trainFromSingleView(<span class="keyword">const</span> Mat&amp; <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>,
<a name="l00971"></a>00971                                      <span class="keyword">const</span> vector&lt;KeyPoint&gt;&amp; <a class="code" href="cv_8h.html#af95b6678bbbdd664ed15fe6d4190d355">keypoints</a>,
<a name="l00972"></a>00972                                      <span class="keywordtype">int</span> _patchSize=PATCH_SIZE,
<a name="l00973"></a>00973                                      <span class="keywordtype">int</span> _signatureSize=DEFAULT_SIGNATURE_SIZE,
<a name="l00974"></a>00974                                      <span class="keywordtype">int</span> _nstructs=DEFAULT_STRUCTS,
<a name="l00975"></a>00975                                      <span class="keywordtype">int</span> _structSize=DEFAULT_STRUCT_SIZE,
<a name="l00976"></a>00976                                      <span class="keywordtype">int</span> _nviews=DEFAULT_VIEWS,
<a name="l00977"></a>00977                                      <span class="keywordtype">int</span> _compressionMethod=COMPRESSION_NONE,
<a name="l00978"></a>00978                                      <span class="keyword">const</span> PatchGenerator&amp; patchGenerator=PatchGenerator());
<a name="l00979"></a>00979     <span class="keyword">virtual</span> <span class="keywordtype">void</span> train(<span class="keyword">const</span> vector&lt;Point2f&gt;&amp; points,
<a name="l00980"></a>00980                        <span class="keyword">const</span> vector&lt;Ptr&lt;Mat&gt; &gt;&amp; refimgs,
<a name="l00981"></a>00981                        <span class="keyword">const</span> vector&lt;int&gt;&amp; <a class="code" href="cxcore_8h.html#a1342f74a0f7dd7c20ab7e79b2e6e5af5">labels</a>=vector&lt;int&gt;(),
<a name="l00982"></a>00982                        <span class="keywordtype">int</span> _nclasses=0, <span class="keywordtype">int</span> _patchSize=PATCH_SIZE,
<a name="l00983"></a>00983                        <span class="keywordtype">int</span> _signatureSize=DEFAULT_SIGNATURE_SIZE,
<a name="l00984"></a>00984                        <span class="keywordtype">int</span> _nstructs=DEFAULT_STRUCTS,
<a name="l00985"></a>00985                        <span class="keywordtype">int</span> _structSize=DEFAULT_STRUCT_SIZE,
<a name="l00986"></a>00986                        <span class="keywordtype">int</span> _nviews=DEFAULT_VIEWS,
<a name="l00987"></a>00987                        <span class="keywordtype">int</span> _compressionMethod=COMPRESSION_NONE,
<a name="l00988"></a>00988                        <span class="keyword">const</span> PatchGenerator&amp; patchGenerator=PatchGenerator());
<a name="l00989"></a>00989     <span class="keyword">virtual</span> <span class="keywordtype">int</span> operator()(<span class="keyword">const</span> Mat&amp; img, Point2f kpt, vector&lt;float&gt;&amp; signature) <span class="keyword">const</span>;
<a name="l00990"></a>00990     <span class="keyword">virtual</span> <span class="keywordtype">int</span> operator()(<span class="keyword">const</span> Mat&amp; patch, vector&lt;float&gt;&amp; signature) <span class="keyword">const</span>;
<a name="l00991"></a>00991     <span class="keyword">virtual</span> <span class="keywordtype">void</span> clear();
<a name="l00992"></a>00992     <span class="keywordtype">void</span> setVerbose(<span class="keywordtype">bool</span> verbose);
<a name="l00993"></a>00993     
<a name="l00994"></a>00994     <span class="keywordtype">int</span> getClassCount() <span class="keyword">const</span>;
<a name="l00995"></a>00995     <span class="keywordtype">int</span> getStructCount() <span class="keyword">const</span>;
<a name="l00996"></a>00996     <span class="keywordtype">int</span> getStructSize() <span class="keyword">const</span>;
<a name="l00997"></a>00997     <span class="keywordtype">int</span> getSignatureSize() <span class="keyword">const</span>;
<a name="l00998"></a>00998     <span class="keywordtype">int</span> getCompressionMethod() <span class="keyword">const</span>;
<a name="l00999"></a>00999     Size getPatchSize() <span class="keyword">const</span>;    
<a name="l01000"></a>01000     
<a name="l01001"></a>01001     <span class="keyword">struct </span>Feature
<a name="l01002"></a>01002     {
<a name="l01003"></a>01003         <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> x1, y1, x2, y2;
<a name="l01004"></a>01004         Feature() : x1(0), y1(0), x2(0), y2(0) {}
<a name="l01005"></a>01005         Feature(<span class="keywordtype">int</span> _x1, <span class="keywordtype">int</span> _y1, <span class="keywordtype">int</span> _x2, <span class="keywordtype">int</span> _y2)
<a name="l01006"></a>01006         : x1((<a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>)_x1), y1((<a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>)_y1), x2((<a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>)_x2), y2((<a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>)_y2)
<a name="l01007"></a>01007         {}
<a name="l01008"></a>01008         <span class="keyword">template</span>&lt;<span class="keyword">typename</span> _Tp&gt; <span class="keywordtype">bool</span> operator ()(<span class="keyword">const</span> Mat_&lt;_Tp&gt;&amp; patch)<span class="keyword"> const</span>
<a name="l01009"></a>01009 <span class="keyword">        </span>{ <span class="keywordflow">return</span> patch(y1,x1) &gt; patch(y2, x2); }
<a name="l01010"></a>01010     };
<a name="l01011"></a>01011     
<a name="l01012"></a>01012     <span class="keyword">enum</span>
<a name="l01013"></a>01013     {
<a name="l01014"></a>01014         PATCH_SIZE = 31,
<a name="l01015"></a>01015         DEFAULT_STRUCTS = 50,
<a name="l01016"></a>01016         DEFAULT_STRUCT_SIZE = 9,
<a name="l01017"></a>01017         DEFAULT_VIEWS = 5000,
<a name="l01018"></a>01018         DEFAULT_SIGNATURE_SIZE = 176,
<a name="l01019"></a>01019         COMPRESSION_NONE = 0,
<a name="l01020"></a>01020         COMPRESSION_RANDOM_PROJ = 1,
<a name="l01021"></a>01021         COMPRESSION_PCA = 2,
<a name="l01022"></a>01022         DEFAULT_COMPRESSION_METHOD = COMPRESSION_NONE
<a name="l01023"></a>01023     };
<a name="l01024"></a>01024     
<a name="l01025"></a>01025 <span class="keyword">protected</span>:
<a name="l01026"></a>01026     <span class="keyword">virtual</span> <span class="keywordtype">void</span> prepare(<span class="keywordtype">int</span> _nclasses, <span class="keywordtype">int</span> _patchSize, <span class="keywordtype">int</span> _signatureSize,
<a name="l01027"></a>01027                          <span class="keywordtype">int</span> _nstructs, <span class="keywordtype">int</span> _structSize,
<a name="l01028"></a>01028                          <span class="keywordtype">int</span> _nviews, <span class="keywordtype">int</span> _compressionMethod);
<a name="l01029"></a>01029     <span class="keyword">virtual</span> <span class="keywordtype">void</span> finalize(RNG&amp; <a class="code" href="cxcore_8h.html#a8d3f239dca9d5c72c8a66d7a1c142efd">rng</a>);
<a name="l01030"></a>01030     <span class="keyword">virtual</span> <span class="keywordtype">int</span> getLeaf(<span class="keywordtype">int</span> fidx, <span class="keyword">const</span> Mat&amp; patch) <span class="keyword">const</span>;
<a name="l01031"></a>01031     
<a name="l01032"></a>01032     <span class="keywordtype">bool</span> verbose;
<a name="l01033"></a>01033     <span class="keywordtype">int</span> nstructs;
<a name="l01034"></a>01034     <span class="keywordtype">int</span> structSize;
<a name="l01035"></a>01035     <span class="keywordtype">int</span> nclasses;
<a name="l01036"></a>01036     <span class="keywordtype">int</span> signatureSize;
<a name="l01037"></a>01037     <span class="keywordtype">int</span> compressionMethod;
<a name="l01038"></a>01038     <span class="keywordtype">int</span> leavesPerStruct;
<a name="l01039"></a>01039     Size patchSize;
<a name="l01040"></a>01040     vector&lt;Feature&gt; features;
<a name="l01041"></a>01041     vector&lt;int&gt; classCounters;
<a name="l01042"></a>01042     vector&lt;float&gt; posteriors;
<a name="l01043"></a>01043 };
<a name="l01044"></a>01044 
<a name="l01045"></a>01045 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> PlanarObjectDetector
<a name="l01046"></a>01046 {
<a name="l01047"></a>01047 <span class="keyword">public</span>:
<a name="l01048"></a>01048     PlanarObjectDetector();
<a name="l01049"></a>01049     PlanarObjectDetector(<span class="keyword">const</span> FileNode&amp; <a class="code" href="cxcore_8h.html#a4e145da43d8cadc65b69ce0c2a2cc76a">node</a>);
<a name="l01050"></a>01050     PlanarObjectDetector(<span class="keyword">const</span> vector&lt;Mat&gt;&amp; pyr, <span class="keywordtype">int</span> _npoints=300,
<a name="l01051"></a>01051                          <span class="keywordtype">int</span> _patchSize=FernClassifier::PATCH_SIZE,
<a name="l01052"></a>01052                          <span class="keywordtype">int</span> _nstructs=FernClassifier::DEFAULT_STRUCTS,
<a name="l01053"></a>01053                          <span class="keywordtype">int</span> _structSize=FernClassifier::DEFAULT_STRUCT_SIZE,
<a name="l01054"></a>01054                          <span class="keywordtype">int</span> _nviews=FernClassifier::DEFAULT_VIEWS,
<a name="l01055"></a>01055                          <span class="keyword">const</span> LDetector&amp; detector=LDetector(),
<a name="l01056"></a>01056                          <span class="keyword">const</span> PatchGenerator&amp; patchGenerator=PatchGenerator()); 
<a name="l01057"></a>01057     <span class="keyword">virtual</span> ~PlanarObjectDetector();
<a name="l01058"></a>01058     <span class="keyword">virtual</span> <span class="keywordtype">void</span> train(<span class="keyword">const</span> vector&lt;Mat&gt;&amp; pyr, <span class="keywordtype">int</span> _npoints=300,
<a name="l01059"></a>01059                        <span class="keywordtype">int</span> _patchSize=FernClassifier::PATCH_SIZE,
<a name="l01060"></a>01060                        <span class="keywordtype">int</span> _nstructs=FernClassifier::DEFAULT_STRUCTS,
<a name="l01061"></a>01061                        <span class="keywordtype">int</span> _structSize=FernClassifier::DEFAULT_STRUCT_SIZE,
<a name="l01062"></a>01062                        <span class="keywordtype">int</span> _nviews=FernClassifier::DEFAULT_VIEWS,
<a name="l01063"></a>01063                        <span class="keyword">const</span> LDetector&amp; detector=LDetector(),
<a name="l01064"></a>01064                        <span class="keyword">const</span> PatchGenerator&amp; patchGenerator=PatchGenerator());
<a name="l01065"></a>01065     <span class="keyword">virtual</span> <span class="keywordtype">void</span> train(<span class="keyword">const</span> vector&lt;Mat&gt;&amp; pyr, <span class="keyword">const</span> vector&lt;KeyPoint&gt;&amp; keypoints,
<a name="l01066"></a>01066                        <span class="keywordtype">int</span> _patchSize=FernClassifier::PATCH_SIZE,
<a name="l01067"></a>01067                        <span class="keywordtype">int</span> _nstructs=FernClassifier::DEFAULT_STRUCTS,
<a name="l01068"></a>01068                        <span class="keywordtype">int</span> _structSize=FernClassifier::DEFAULT_STRUCT_SIZE,
<a name="l01069"></a>01069                        <span class="keywordtype">int</span> _nviews=FernClassifier::DEFAULT_VIEWS,
<a name="l01070"></a>01070                        <span class="keyword">const</span> LDetector&amp; detector=LDetector(),
<a name="l01071"></a>01071                        <span class="keyword">const</span> PatchGenerator&amp; patchGenerator=PatchGenerator());
<a name="l01072"></a>01072     Rect getModelROI() <span class="keyword">const</span>;
<a name="l01073"></a>01073     vector&lt;KeyPoint&gt; getModelPoints() <span class="keyword">const</span>;
<a name="l01074"></a>01074     <span class="keyword">const</span> LDetector&amp; getDetector() <span class="keyword">const</span>;
<a name="l01075"></a>01075     <span class="keyword">const</span> FernClassifier&amp; getClassifier() <span class="keyword">const</span>;
<a name="l01076"></a>01076     <span class="keywordtype">void</span> setVerbose(<span class="keywordtype">bool</span> verbose);
<a name="l01077"></a>01077     
<a name="l01078"></a>01078     <span class="keywordtype">void</span> read(<span class="keyword">const</span> FileNode&amp; <a class="code" href="cxcore_8h.html#a4e145da43d8cadc65b69ce0c2a2cc76a">node</a>);
<a name="l01079"></a>01079     <span class="keywordtype">void</span> write(FileStorage&amp; fs, <span class="keyword">const</span> String&amp; <a class="code" href="cxcore_8h.html#add928d8eb85ea33a25a67db3406d4887">name</a>=String()) <span class="keyword">const</span>;
<a name="l01080"></a>01080     <span class="keywordtype">bool</span> operator()(<span class="keyword">const</span> Mat&amp; image, Mat&amp; H, vector&lt;Point2f&gt;&amp; <a class="code" href="cv_8h.html#a47bca3168056d04ddb926909c44866a3">corners</a>) <span class="keyword">const</span>;
<a name="l01081"></a>01081     <span class="keywordtype">bool</span> operator()(<span class="keyword">const</span> vector&lt;Mat&gt;&amp; pyr, <span class="keyword">const</span> vector&lt;KeyPoint&gt;&amp; keypoints,
<a name="l01082"></a>01082                     Mat&amp; H, vector&lt;Point2f&gt;&amp; <a class="code" href="cv_8h.html#a47bca3168056d04ddb926909c44866a3">corners</a>, vector&lt;int&gt;* pairs=0) <span class="keyword">const</span>;
<a name="l01083"></a>01083     
<a name="l01084"></a>01084 <span class="keyword">protected</span>:
<a name="l01085"></a>01085     <span class="keywordtype">bool</span> verbose;
<a name="l01086"></a>01086     Rect modelROI;
<a name="l01087"></a>01087     vector&lt;KeyPoint&gt; modelPoints;
<a name="l01088"></a>01088     LDetector ldetector;
<a name="l01089"></a>01089     FernClassifier fernClassifier;
<a name="l01090"></a>01090 };
<a name="l01091"></a>01091 
<a name="l01092"></a>01092 
<a name="l01093"></a>01093 
<a name="l01094"></a>01094 
<a name="l01095"></a>01095 <span class="comment">// detect corners using FAST algorithm</span>
<a name="l01096"></a>01096 <a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> <span class="keywordtype">void</span> FAST( <span class="keyword">const</span> Mat&amp; image, vector&lt;KeyPoint&gt;&amp; keypoints, <span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a32b004637d3b8895570fd73c28492698">threshold</a>, <span class="keywordtype">bool</span> nonmax_supression=<span class="keyword">true</span> );
<a name="l01097"></a>01097 
<a name="l01098"></a>01098 
<a name="l01099"></a>01099 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> LevMarqSparse
<a name="l01100"></a>01100 {
<a name="l01101"></a>01101 <span class="keyword">public</span>:
<a name="l01102"></a>01102     LevMarqSparse();
<a name="l01103"></a>01103     LevMarqSparse(<span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a5cf988c63b6068a0e5767053be288375">npoints</a>, <span class="comment">// number of points</span>
<a name="l01104"></a>01104             <span class="keywordtype">int</span> ncameras, <span class="comment">// number of cameras</span>
<a name="l01105"></a>01105             <span class="keywordtype">int</span> nPointParams, <span class="comment">// number of params per one point  (3 in case of 3D points)</span>
<a name="l01106"></a>01106             <span class="keywordtype">int</span> nCameraParams, <span class="comment">// number of parameters per one camera</span>
<a name="l01107"></a>01107             <span class="keywordtype">int</span> nErrParams, <span class="comment">// number of parameters in measurement vector</span>
<a name="l01108"></a>01108                             <span class="comment">// for 1 point at one camera (2 in case of 2D projections)</span>
<a name="l01109"></a>01109             Mat&amp; visibility, <span class="comment">// visibility matrix. rows correspond to points, columns correspond to cameras</span>
<a name="l01110"></a>01110                              <span class="comment">// 1 - point is visible for the camera, 0 - invisible</span>
<a name="l01111"></a>01111             Mat&amp; P0, <span class="comment">// starting vector of parameters, first cameras then points</span>
<a name="l01112"></a>01112             Mat&amp; <a class="code" href="cxcore_8h.html#aa2874b69490a070bec57dfd3f06163f6">X</a>, <span class="comment">// measurements, in order of visibility. non visible cases are skipped </span>
<a name="l01113"></a>01113             TermCriteria <a class="code" href="cv_8h.html#a131e394a855285995fe28931f99158cc">criteria</a>, <span class="comment">// termination criteria</span>
<a name="l01114"></a>01114             
<a name="l01115"></a>01115             <span class="comment">// callback for estimation of Jacobian matrices</span>
<a name="l01116"></a>01116             <span class="keywordtype">void</span> (<a class="code" href="cxtypes_8h.html#a7890067b22f553f61def418f6fcbb5f5">CV_CDECL</a> * fjac)(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, Mat&amp; point_params,
<a name="l01117"></a>01117                                    Mat&amp; cam_params, Mat&amp; A, Mat&amp; <a class="code" href="cv_8h.html#ad029a852b561fb55dd583daf3830ed89">B</a>, <span class="keywordtype">void</span>* <a class="code" href="cv_8h.html#acd1647952fba31484ea63d6f1140e509">data</a>),
<a name="l01118"></a>01118             <span class="comment">// callback for estimation of backprojection errors</span>
<a name="l01119"></a>01119             <span class="keywordtype">void</span> (<a class="code" href="cxtypes_8h.html#a7890067b22f553f61def418f6fcbb5f5">CV_CDECL</a> * <a class="code" href="cxcore_8h.html#a120677ac732b3c9bfecab149fc978afa">func</a>)(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, Mat&amp; point_params,
<a name="l01120"></a>01120                                    Mat&amp; cam_params, Mat&amp; estim, <span class="keywordtype">void</span>* data),
<a name="l01121"></a>01121             <span class="keywordtype">void</span>* data <span class="comment">// user-specific data passed to the callbacks</span>
<a name="l01122"></a>01122             );
<a name="l01123"></a>01123     <span class="keyword">virtual</span> ~LevMarqSparse();
<a name="l01124"></a>01124     
<a name="l01125"></a>01125     <span class="keyword">virtual</span> <span class="keywordtype">void</span> run( <span class="keywordtype">int</span> npoints, <span class="comment">// number of points</span>
<a name="l01126"></a>01126             <span class="keywordtype">int</span> ncameras, <span class="comment">// number of cameras</span>
<a name="l01127"></a>01127             <span class="keywordtype">int</span> nPointParams, <span class="comment">// number of params per one point  (3 in case of 3D points)</span>
<a name="l01128"></a>01128             <span class="keywordtype">int</span> nCameraParams, <span class="comment">// number of parameters per one camera</span>
<a name="l01129"></a>01129             <span class="keywordtype">int</span> nErrParams, <span class="comment">// number of parameters in measurement vector</span>
<a name="l01130"></a>01130                             <span class="comment">// for 1 point at one camera (2 in case of 2D projections)</span>
<a name="l01131"></a>01131             Mat&amp; visibility, <span class="comment">// visibility matrix. rows correspond to points, columns correspond to cameras</span>
<a name="l01132"></a>01132                              <span class="comment">// 1 - point is visible for the camera, 0 - invisible</span>
<a name="l01133"></a>01133             Mat&amp; P0, <span class="comment">// starting vector of parameters, first cameras then points</span>
<a name="l01134"></a>01134             Mat&amp; X, <span class="comment">// measurements, in order of visibility. non visible cases are skipped </span>
<a name="l01135"></a>01135             TermCriteria criteria, <span class="comment">// termination criteria</span>
<a name="l01136"></a>01136             
<a name="l01137"></a>01137             <span class="comment">// callback for estimation of Jacobian matrices</span>
<a name="l01138"></a>01138             <span class="keywordtype">void</span> (<a class="code" href="cxtypes_8h.html#a7890067b22f553f61def418f6fcbb5f5">CV_CDECL</a> * fjac)(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, Mat&amp; point_params,
<a name="l01139"></a>01139                                    Mat&amp; cam_params, Mat&amp; A, Mat&amp; B, <span class="keywordtype">void</span>* data),
<a name="l01140"></a>01140             <span class="comment">// callback for estimation of backprojection errors</span>
<a name="l01141"></a>01141             <span class="keywordtype">void</span> (<a class="code" href="cxtypes_8h.html#a7890067b22f553f61def418f6fcbb5f5">CV_CDECL</a> * func)(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, Mat&amp; point_params,
<a name="l01142"></a>01142                                    Mat&amp; cam_params, Mat&amp; estim, <span class="keywordtype">void</span>* data),
<a name="l01143"></a>01143             <span class="keywordtype">void</span>* data <span class="comment">// user-specific data passed to the callbacks</span>
<a name="l01144"></a>01144             );
<a name="l01145"></a>01145 
<a name="l01146"></a>01146     <span class="keyword">virtual</span> <span class="keywordtype">void</span> clear();
<a name="l01147"></a>01147     
<a name="l01148"></a>01148     <span class="comment">// useful function to do simple bundle adjastment tasks</span>
<a name="l01149"></a>01149     <span class="keyword">static</span> <span class="keywordtype">void</span> bundleAdjust(vector&lt;Point3d&gt;&amp; points, <span class="comment">//positions of points in global coordinate system (input and output)</span>
<a name="l01150"></a>01150                              <span class="keyword">const</span> vector&lt;vector&lt;Point2d&gt; &gt;&amp; imagePoints, <span class="comment">//projections of 3d points for every camera </span>
<a name="l01151"></a>01151                              <span class="keyword">const</span> vector&lt;vector&lt;int&gt; &gt;&amp; visibility, <span class="comment">//visibility of 3d points for every camera </span>
<a name="l01152"></a>01152                              vector&lt;Mat&gt;&amp; cameraMatrix, <span class="comment">//intrinsic matrices of all cameras (input and output)</span>
<a name="l01153"></a>01153                              vector&lt;Mat&gt;&amp; <a class="code" href="cv_8h.html#a2ea7d948846e496014d0468ad2c8807f">R</a>, <span class="comment">//rotation matrices of all cameras (input and output)</span>
<a name="l01154"></a>01154                              vector&lt;Mat&gt;&amp; <a class="code" href="cv_8h.html#a3efb9551a871ddd0463079a808916717">T</a>, <span class="comment">//translation vector of all cameras (input and output)</span>
<a name="l01155"></a>01155                              vector&lt;Mat&gt;&amp; distCoeffs, <span class="comment">//distortion coefficients of all cameras (input and output)</span>
<a name="l01156"></a>01156                              <span class="keyword">const</span> TermCriteria&amp; criteria=
<a name="l01157"></a>01157                              TermCriteria(TermCriteria::COUNT+TermCriteria::EPS, 30, DBL_EPSILON));
<a name="l01158"></a>01158     
<a name="l01159"></a>01159 <span class="keyword">protected</span>:
<a name="l01160"></a>01160     <span class="keyword">virtual</span> <span class="keywordtype">void</span> optimize(); <span class="comment">//main function that runs minimization</span>
<a name="l01161"></a>01161     
<a name="l01162"></a>01162     <span class="comment">//iteratively asks for measurement for visible camera-point pairs</span>
<a name="l01163"></a>01163     <span class="keywordtype">void</span> ask_for_proj();                                        
<a name="l01164"></a>01164     <span class="comment">//iteratively asks for Jacobians for every camera_point pair</span>
<a name="l01165"></a>01165     <span class="keywordtype">void</span> ask_for_projac();    
<a name="l01166"></a>01166         
<a name="l01167"></a>01167     <a class="code" href="struct_cv_mat.html">CvMat</a>* err; <span class="comment">//error X-hX</span>
<a name="l01168"></a>01168     <span class="keywordtype">double</span> prevErrNorm, errNorm;
<a name="l01169"></a>01169     <span class="keywordtype">double</span> <a class="code" href="cv_8h.html#a2b2a31d8b9a3be743757541bf16e5801">lambda</a>;
<a name="l01170"></a>01170     <a class="code" href="struct_cv_term_criteria.html">CvTermCriteria</a> <a class="code" href="cv_8h.html#a131e394a855285995fe28931f99158cc">criteria</a>;
<a name="l01171"></a>01171     <span class="keywordtype">int</span> iters;
<a name="l01172"></a>01172     
<a name="l01173"></a>01173     <a class="code" href="struct_cv_mat.html">CvMat</a>** <a class="code" href="cxcore_8h.html#aa9c521f41af9a5191e5e4b6ffbae211a">U</a>; <span class="comment">//size of array is equal to number of cameras</span>
<a name="l01174"></a>01174     <a class="code" href="struct_cv_mat.html">CvMat</a>** <a class="code" href="cxcore_8h.html#ad8dd4fff0e3910932187b6de0543cae1">V</a>; <span class="comment">//size of array is equal to number of points</span>
<a name="l01175"></a>01175     <a class="code" href="struct_cv_mat.html">CvMat</a>** inv_V_star; <span class="comment">//inverse of V*</span>
<a name="l01176"></a>01176 
<a name="l01177"></a>01177     <a class="code" href="struct_cv_mat.html">CvMat</a>* A;
<a name="l01178"></a>01178     <a class="code" href="struct_cv_mat.html">CvMat</a>* <a class="code" href="cv_8h.html#ad029a852b561fb55dd583daf3830ed89">B</a>;
<a name="l01179"></a>01179     <a class="code" href="struct_cv_mat.html">CvMat</a>* <a class="code" href="cxcore_8h.html#a46bf1e265dd7cbcdb8289fab94dfff1c">W</a>; 
<a name="l01180"></a>01180 
<a name="l01181"></a>01181     <a class="code" href="struct_cv_mat.html">CvMat</a>* <a class="code" href="cxcore_8h.html#aa2874b69490a070bec57dfd3f06163f6">X</a>; <span class="comment">//measurement </span>
<a name="l01182"></a>01182     <a class="code" href="struct_cv_mat.html">CvMat</a>* hX; <span class="comment">//current measurement extimation given new parameter vector </span>
<a name="l01183"></a>01183     
<a name="l01184"></a>01184     <a class="code" href="struct_cv_mat.html">CvMat</a>* prevP; <span class="comment">//current already accepted parameter. </span>
<a name="l01185"></a>01185     <a class="code" href="struct_cv_mat.html">CvMat</a>* P; <span class="comment">// parameters used to evaluate function with new params</span>
<a name="l01186"></a>01186               <span class="comment">// this parameters may be rejected </span>
<a name="l01187"></a>01187     
<a name="l01188"></a>01188     <a class="code" href="struct_cv_mat.html">CvMat</a>* deltaP; <span class="comment">//computed increase of parameters (result of normal system solution )</span>
<a name="l01189"></a>01189 
<a name="l01190"></a>01190     <a class="code" href="struct_cv_mat.html">CvMat</a>** ea; <span class="comment">// sum_i  AijT * e_ij , used as right part of normal equation</span>
<a name="l01191"></a>01191                 <span class="comment">// length of array is j = number of cameras  </span>
<a name="l01192"></a>01192     <a class="code" href="struct_cv_mat.html">CvMat</a>** eb; <span class="comment">// sum_j  BijT * e_ij , used as right part of normal equation</span>
<a name="l01193"></a>01193                 <span class="comment">// length of array is i = number of points</span>
<a name="l01194"></a>01194 
<a name="l01195"></a>01195     <a class="code" href="struct_cv_mat.html">CvMat</a>** Yj; <span class="comment">//length of array is i = num_points</span>
<a name="l01196"></a>01196 
<a name="l01197"></a>01197     <a class="code" href="struct_cv_mat.html">CvMat</a>* S; <span class="comment">//big matrix of block Sjk  , each block has size num_cam_params x num_cam_params </span>
<a name="l01198"></a>01198 
<a name="l01199"></a>01199     <a class="code" href="struct_cv_mat.html">CvMat</a>* JtJ_diag; <span class="comment">//diagonal of JtJ,  used to backup diagonal elements before augmentation</span>
<a name="l01200"></a>01200 
<a name="l01201"></a>01201     <a class="code" href="struct_cv_mat.html">CvMat</a>* Vis_index; <span class="comment">// matrix which element is index of measurement for point i and camera j</span>
<a name="l01202"></a>01202                
<a name="l01203"></a>01203     <span class="keywordtype">int</span> num_cams;
<a name="l01204"></a>01204     <span class="keywordtype">int</span> num_points;
<a name="l01205"></a>01205     <span class="keywordtype">int</span> num_err_param;
<a name="l01206"></a>01206     <span class="keywordtype">int</span> num_cam_param;
<a name="l01207"></a>01207     <span class="keywordtype">int</span> num_point_param;
<a name="l01208"></a>01208 
<a name="l01209"></a>01209     <span class="comment">//target function and jacobian pointers, which needs to be initialized </span>
<a name="l01210"></a>01210     <a class="code" href="highgui_8h.html#ad1f9461adaad33556b3a01c7f2c6ceab">void</a> (*fjac)(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, Mat&amp; point_params, Mat&amp; cam_params, Mat&amp; A, Mat&amp; <a class="code" href="cv_8h.html#ad029a852b561fb55dd583daf3830ed89">B</a>, <span class="keywordtype">void</span>* <a class="code" href="cv_8h.html#acd1647952fba31484ea63d6f1140e509">data</a>);
<a name="l01211"></a>01211     <a class="code" href="highgui_8h.html#ad1f9461adaad33556b3a01c7f2c6ceab">void</a> (*func)(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, Mat&amp; point_params, Mat&amp; cam_params, Mat&amp; estim, <span class="keywordtype">void</span>* <a class="code" href="cv_8h.html#acd1647952fba31484ea63d6f1140e509">data</a> );
<a name="l01212"></a>01212 
<a name="l01213"></a>01213     <span class="keywordtype">void</span>* <a class="code" href="cv_8h.html#acd1647952fba31484ea63d6f1140e509">data</a>;
<a name="l01214"></a>01214 };
<a name="l01215"></a>01215 
<a name="l01216"></a>01216 <span class="keyword">struct </span>DefaultRngAuto
<a name="l01217"></a>01217 {
<a name="l01218"></a>01218     <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="cxtypes_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> def_state = (<a class="code" href="cxtypes_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a>)-1;
<a name="l01219"></a>01219     <span class="keyword">const</span> <a class="code" href="cxtypes_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> old_state;
<a name="l01220"></a>01220 
<a name="l01221"></a>01221     DefaultRngAuto() : old_state(theRNG().<a class="code" href="cv_8h.html#ae1a2f77ed661441e31e2edb273c66845">state</a>) { theRNG().state = def_state; }
<a name="l01222"></a>01222     ~DefaultRngAuto() { theRNG().state = old_state; }   
<a name="l01223"></a>01223 
<a name="l01224"></a>01224     DefaultRngAuto&amp; operator=(<span class="keyword">const</span> DefaultRngAuto&amp;);
<a name="l01225"></a>01225 };
<a name="l01226"></a>01226 
<a name="l01227"></a>01227         <span class="comment">/****************************************************************************************\</span>
<a name="l01228"></a>01228 <span class="comment">        *            Calonder Descriptor                                                                                                                 *</span>
<a name="l01229"></a>01229 <span class="comment">        \****************************************************************************************/</span>
<a name="l01233"></a>01233         <span class="keyword">typedef</span> cv::RNG CalonderRng;
<a name="l01234"></a>01234         <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> int_type;
<a name="l01235"></a>01235 
<a name="l01236"></a>01236         <span class="comment">//----------------------------</span>
<a name="l01237"></a>01237         <span class="comment">//randomized_tree.h</span>
<a name="l01238"></a>01238 
<a name="l01239"></a>01239         <span class="comment">//class RTTester;</span>
<a name="l01240"></a>01240 
<a name="l01241"></a>01241         <span class="comment">//namespace features {</span>
<a name="l01242"></a>01242         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> DEFAULT_REDUCED_NUM_DIM = 176;  
<a name="l01243"></a>01243         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">float</span> LOWER_QUANT_PERC = .03f;
<a name="l01244"></a>01244         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">float</span> UPPER_QUANT_PERC = .92f;
<a name="l01245"></a>01245         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> PATCH_SIZE = 32;
<a name="l01246"></a>01246         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> DEFAULT_DEPTH = 9;
<a name="l01247"></a>01247         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> DEFAULT_VIEWS = 5000;
<a name="l01248"></a>01248         <span class="keyword">struct </span>RTreeNode;
<a name="l01249"></a>01249 
<a name="l01250"></a>01250         <span class="keyword">struct </span>BaseKeypoint
<a name="l01251"></a>01251         {
<a name="l01252"></a>01252                 <span class="keywordtype">int</span> <a class="code" href="highgui_8h.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>;
<a name="l01253"></a>01253                 <span class="keywordtype">int</span> <a class="code" href="highgui_8h.html#af1202c02b14870c18fb3a1da73e9e7c7">y</a>;
<a name="l01254"></a>01254                 <a class="code" href="struct___ipl_image.html">IplImage</a>* <a class="code" href="highgui_8h.html#a8df1daf3fb4b8bca959840ff1c005a5b">image</a>;
<a name="l01255"></a>01255 
<a name="l01256"></a>01256                 BaseKeypoint()
<a name="l01257"></a>01257                         : <a class="code" href="highgui_8h.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>(0), y(0), image(NULL)
<a name="l01258"></a>01258                 {}
<a name="l01259"></a>01259 
<a name="l01260"></a>01260                 BaseKeypoint(<span class="keywordtype">int</span> <a class="code" href="highgui_8h.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>, <span class="keywordtype">int</span> y, <a class="code" href="struct___ipl_image.html">IplImage</a>* image)
<a name="l01261"></a>01261                         : x(x), y(y), image(image)
<a name="l01262"></a>01262                 {}
<a name="l01263"></a>01263         };
<a name="l01264"></a>01264 
<a name="l01265"></a>01265         <span class="keyword">class </span>CSMatrixGenerator {
<a name="l01266"></a>01266         <span class="keyword">public</span>:
<a name="l01267"></a>01267                 <span class="keyword">typedef</span> <span class="keyword">enum</span> { PDT_GAUSS=1, PDT_BERNOULLI, PDT_DBFRIENDLY } PHI_DISTR_TYPE;
<a name="l01268"></a>01268                 ~CSMatrixGenerator();
<a name="l01269"></a>01269                 <span class="keyword">static</span> <span class="keywordtype">float</span>* getCSMatrix(<span class="keywordtype">int</span> m, <span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, PHI_DISTR_TYPE <a class="code" href="cxcore_8h.html#a6349a5196c8b4904789d908389b91671">dt</a>);     <span class="comment">// do NOT free returned pointer   </span>
<a name="l01270"></a>01270 
<a name="l01271"></a>01271 
<a name="l01272"></a>01272         <span class="keyword">private</span>:
<a name="l01273"></a>01273                 <span class="keyword">static</span> <span class="keywordtype">float</span> *cs_phi_;    <span class="comment">// matrix for compressive sensing</span>
<a name="l01274"></a>01274                 <span class="keyword">static</span> <span class="keywordtype">int</span> cs_phi_m_, cs_phi_n_;
<a name="l01275"></a>01275         };
<a name="l01276"></a>01276 
<a name="l01277"></a>01277         <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> RandomizedTree
<a name="l01278"></a>01278         {  
<a name="l01279"></a>01279         <span class="keyword">public</span>:
<a name="l01280"></a>01280                 <span class="keyword">friend</span> <span class="keyword">class </span>RTreeClassifier;  
<a name="l01281"></a>01281                 <span class="comment">//friend class ::RTTester;</span>
<a name="l01282"></a>01282 
<a name="l01283"></a>01283 
<a name="l01284"></a>01284                 RandomizedTree();
<a name="l01285"></a>01285                 ~RandomizedTree();
<a name="l01286"></a>01286 
<a name="l01287"></a>01287                 <span class="keywordtype">void</span> train(std::vector&lt;BaseKeypoint&gt; <span class="keyword">const</span>&amp; base_set, cv::RNG &amp;<a class="code" href="cxcore_8h.html#a8d3f239dca9d5c72c8a66d7a1c142efd">rng</a>,
<a name="l01288"></a>01288                         <span class="keywordtype">int</span> depth, <span class="keywordtype">int</span> views, <span class="keywordtype">size_t</span> reduced_num_dim, <span class="keywordtype">int</span> num_quant_bits);
<a name="l01289"></a>01289                 <span class="keywordtype">void</span> train(std::vector&lt;BaseKeypoint&gt; <span class="keyword">const</span>&amp; base_set, cv::RNG &amp;<a class="code" href="cxcore_8h.html#a8d3f239dca9d5c72c8a66d7a1c142efd">rng</a>,
<a name="l01290"></a>01290                         PatchGenerator &amp;make_patch, <span class="keywordtype">int</span> depth, <span class="keywordtype">int</span> views, <span class="keywordtype">size_t</span> reduced_num_dim,
<a name="l01291"></a>01291                         <span class="keywordtype">int</span> num_quant_bits);
<a name="l01292"></a>01292 
<a name="l01293"></a>01293                 <span class="comment">// following two funcs are EXPERIMENTAL (do not use unless you know exactly what you do)</span>
<a name="l01294"></a>01294                 <span class="keyword">static</span> <span class="keywordtype">void</span> quantizeVector(<span class="keywordtype">float</span> *vec, <span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> N, <span class="keywordtype">float</span> bnds[2], <span class="keywordtype">int</span> clamp_mode=0);
<a name="l01295"></a>01295                 <span class="keyword">static</span> <span class="keywordtype">void</span> quantizeVector(<span class="keywordtype">float</span> *<a class="code" href="cxcore_8h.html#ab4cdd1c16a22344c9f968fca805b5d70">src</a>, <span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> N, <span class="keywordtype">float</span> bnds[2], <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *<a class="code" href="cv_8h.html#a630368d4e6b55d40d80e2bd38c87a19f">dst</a>);  
<a name="l01296"></a>01296 
<a name="l01297"></a>01297                 <span class="comment">// patch_data must be a 32x32 array (no row padding)</span>
<a name="l01298"></a>01298                 <span class="keywordtype">float</span>* getPosterior(<a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>* patch_data);
<a name="l01299"></a>01299                 <span class="keyword">const</span> <span class="keywordtype">float</span>* getPosterior(<a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>* patch_data) <span class="keyword">const</span>;
<a name="l01300"></a>01300                 <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>* getPosterior2(<a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>* patch_data);
<a name="l01301"></a>01301 
<a name="l01302"></a>01302                 <span class="keywordtype">void</span> read(<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="cxcore_8h.html#aed1a5f21df6c3f600d6c313493dde694">file_name</a>, <span class="keywordtype">int</span> num_quant_bits);
<a name="l01303"></a>01303                 <span class="keywordtype">void</span> read(std::istream &amp;is, <span class="keywordtype">int</span> num_quant_bits);
<a name="l01304"></a>01304                 <span class="keywordtype">void</span> write(<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="cxcore_8h.html#aed1a5f21df6c3f600d6c313493dde694">file_name</a>) <span class="keyword">const</span>;
<a name="l01305"></a>01305                 <span class="keywordtype">void</span> write(std::ostream &amp;os) <span class="keyword">const</span>;
<a name="l01306"></a>01306 
<a name="l01307"></a>01307                 <span class="keywordtype">int</span> classes() { <span class="keywordflow">return</span> classes_; }
<a name="l01308"></a>01308                 <span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#acb5ba97551079e0b072c62c21d784ac5">depth</a>() { <span class="keywordflow">return</span> depth_; }
<a name="l01309"></a>01309 
<a name="l01310"></a>01310                 <span class="comment">//void setKeepFloatPosteriors(bool b) { keep_float_posteriors_ = b; }</span>
<a name="l01311"></a>01311                 <span class="keywordtype">void</span> discardFloatPosteriors() { freePosteriors(1); }
<a name="l01312"></a>01312 
<a name="l01313"></a>01313                 <span class="keyword">inline</span> <span class="keywordtype">void</span> applyQuantization(<span class="keywordtype">int</span> num_quant_bits) { makePosteriors2(num_quant_bits); }
<a name="l01314"></a>01314 
<a name="l01315"></a>01315                 <span class="comment">// debug</span>
<a name="l01316"></a>01316                 <span class="keywordtype">void</span> savePosteriors(std::string url, <span class="keywordtype">bool</span> append=<span class="keyword">false</span>);
<a name="l01317"></a>01317                 <span class="keywordtype">void</span> savePosteriors2(std::string url, <span class="keywordtype">bool</span> append=<span class="keyword">false</span>);
<a name="l01318"></a>01318 
<a name="l01319"></a>01319         <span class="keyword">private</span>:
<a name="l01320"></a>01320                 <span class="keywordtype">int</span> classes_;
<a name="l01321"></a>01321                 <span class="keywordtype">int</span> depth_;
<a name="l01322"></a>01322                 <span class="keywordtype">int</span> num_leaves_;  
<a name="l01323"></a>01323                 std::vector&lt;RTreeNode&gt; nodes_;  
<a name="l01324"></a>01324                 <span class="keywordtype">float</span> **posteriors_;        <span class="comment">// 16-bytes aligned posteriors</span>
<a name="l01325"></a>01325                 <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> **posteriors2_;     <span class="comment">// 16-bytes aligned posteriors</span>
<a name="l01326"></a>01326                 std::vector&lt;int&gt; leaf_counts_;
<a name="l01327"></a>01327 
<a name="l01328"></a>01328                 <span class="keywordtype">void</span> createNodes(<span class="keywordtype">int</span> num_nodes, cv::RNG &amp;<a class="code" href="cxcore_8h.html#a8d3f239dca9d5c72c8a66d7a1c142efd">rng</a>);
<a name="l01329"></a>01329                 <span class="keywordtype">void</span> allocPosteriorsAligned(<span class="keywordtype">int</span> num_leaves, <span class="keywordtype">int</span> num_classes);
<a name="l01330"></a>01330                 <span class="keywordtype">void</span> freePosteriors(<span class="keywordtype">int</span> which);    <span class="comment">// which: 1=posteriors_, 2=posteriors2_, 3=both</span>
<a name="l01331"></a>01331                 <span class="keywordtype">void</span> init(<span class="keywordtype">int</span> classes, <span class="keywordtype">int</span> depth, cv::RNG &amp;<a class="code" href="cxcore_8h.html#a8d3f239dca9d5c72c8a66d7a1c142efd">rng</a>);
<a name="l01332"></a>01332                 <span class="keywordtype">void</span> addExample(<span class="keywordtype">int</span> class_id, <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>* patch_data);
<a name="l01333"></a>01333                 <span class="keywordtype">void</span> finalize(<span class="keywordtype">size_t</span> reduced_num_dim, <span class="keywordtype">int</span> num_quant_bits);  
<a name="l01334"></a>01334                 <span class="keywordtype">int</span> getIndex(<a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>* patch_data) <span class="keyword">const</span>;
<a name="l01335"></a>01335                 <span class="keyword">inline</span> <span class="keywordtype">float</span>* getPosteriorByIndex(<span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>);
<a name="l01336"></a>01336                 <span class="keyword">inline</span> <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>* getPosteriorByIndex2(<span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>);
<a name="l01337"></a>01337                 <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">float</span>* getPosteriorByIndex(<span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>) <span class="keyword">const</span>;
<a name="l01338"></a>01338                 <span class="comment">//void makeRandomMeasMatrix(float *cs_phi, PHI_DISTR_TYPE dt, size_t reduced_num_dim);  </span>
<a name="l01339"></a>01339                 <span class="keywordtype">void</span> convertPosteriorsToChar();
<a name="l01340"></a>01340                 <span class="keywordtype">void</span> makePosteriors2(<span class="keywordtype">int</span> num_quant_bits);
<a name="l01341"></a>01341                 <span class="keywordtype">void</span> compressLeaves(<span class="keywordtype">size_t</span> reduced_num_dim);  
<a name="l01342"></a>01342                 <span class="keywordtype">void</span> estimateQuantPercForPosteriors(<span class="keywordtype">float</span> perc[2]);
<a name="l01343"></a>01343         };
<a name="l01344"></a>01344 
<a name="l01345"></a>01345         <span class="keyword">struct </span>RTreeNode
<a name="l01346"></a>01346         {
<a name="l01347"></a>01347                 <span class="keywordtype">short</span> offset1, offset2;
<a name="l01348"></a>01348 
<a name="l01349"></a>01349                 RTreeNode() {}
<a name="l01350"></a>01350 
<a name="l01351"></a>01351                 RTreeNode(<a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> x1, <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> y1, <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> x2, <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> y2)
<a name="l01352"></a>01352                         : offset1(y1*PATCH_SIZE + x1),
<a name="l01353"></a>01353                         offset2(y2*PATCH_SIZE + x2)
<a name="l01354"></a>01354                 {}
<a name="l01355"></a>01355 
<a name="l01357"></a>01357                 <span class="keyword">inline</span> <span class="keywordtype">bool</span> operator() (<a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>* patch_data)<span class="keyword"> const</span>
<a name="l01358"></a>01358 <span class="keyword">                </span>{
<a name="l01359"></a>01359                         <span class="keywordflow">return</span> patch_data[offset1] &gt; patch_data[offset2];
<a name="l01360"></a>01360                 }
<a name="l01361"></a>01361         };
<a name="l01362"></a>01362 
<a name="l01363"></a>01363 
<a name="l01364"></a>01364 
<a name="l01365"></a>01365         <span class="comment">//} // namespace features</span>
<a name="l01366"></a>01366         <span class="comment">//----------------------------</span>
<a name="l01367"></a>01367         <span class="comment">//rtree_classifier.h</span>
<a name="l01368"></a>01368         <span class="comment">//class RTTester;</span>
<a name="l01369"></a>01369 
<a name="l01370"></a>01370         <span class="comment">//namespace features {</span>
<a name="l01371"></a>01371 
<a name="l01372"></a>01372         <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> RTreeClassifier
<a name="l01373"></a>01373         {   
<a name="l01374"></a>01374         <span class="keyword">public</span>:
<a name="l01375"></a>01375                 <span class="comment">//friend class ::RTTester;</span>
<a name="l01376"></a>01376                 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> DEFAULT_TREES = 48;
<a name="l01377"></a>01377                 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> DEFAULT_NUM_QUANT_BITS = 4;  
<a name="l01378"></a>01378 
<a name="l01379"></a>01379                 RTreeClassifier();
<a name="l01380"></a>01380 
<a name="l01381"></a>01381                 <span class="comment">//modified</span>
<a name="l01382"></a>01382                 <span class="keywordtype">void</span> train(std::vector&lt;BaseKeypoint&gt; <span class="keyword">const</span>&amp; base_set, 
<a name="l01383"></a>01383                         cv::RNG &amp;<a class="code" href="cxcore_8h.html#a8d3f239dca9d5c72c8a66d7a1c142efd">rng</a>,
<a name="l01384"></a>01384                         <span class="keywordtype">int</span> num_trees = RTreeClassifier::DEFAULT_TREES,
<a name="l01385"></a>01385                         <span class="keywordtype">int</span> depth = DEFAULT_DEPTH,
<a name="l01386"></a>01386                         <span class="keywordtype">int</span> views = DEFAULT_VIEWS,
<a name="l01387"></a>01387                         <span class="keywordtype">size_t</span> reduced_num_dim = DEFAULT_REDUCED_NUM_DIM,
<a name="l01388"></a>01388                         <span class="keywordtype">int</span> num_quant_bits = DEFAULT_NUM_QUANT_BITS, <span class="keywordtype">bool</span> print_status = <span class="keyword">true</span>);
<a name="l01389"></a>01389                 <span class="keywordtype">void</span> train(std::vector&lt;BaseKeypoint&gt; <span class="keyword">const</span>&amp; base_set,
<a name="l01390"></a>01390                         cv::RNG &amp;<a class="code" href="cxcore_8h.html#a8d3f239dca9d5c72c8a66d7a1c142efd">rng</a>, 
<a name="l01391"></a>01391                         PatchGenerator &amp;make_patch,
<a name="l01392"></a>01392                         <span class="keywordtype">int</span> num_trees = RTreeClassifier::DEFAULT_TREES,
<a name="l01393"></a>01393                         <span class="keywordtype">int</span> depth = DEFAULT_DEPTH,
<a name="l01394"></a>01394                         <span class="keywordtype">int</span> views = DEFAULT_VIEWS,
<a name="l01395"></a>01395                         <span class="keywordtype">size_t</span> reduced_num_dim = DEFAULT_REDUCED_NUM_DIM,
<a name="l01396"></a>01396                         <span class="keywordtype">int</span> num_quant_bits = DEFAULT_NUM_QUANT_BITS, <span class="keywordtype">bool</span> print_status = <span class="keyword">true</span>);
<a name="l01397"></a>01397 
<a name="l01398"></a>01398                 <span class="comment">// sig must point to a memory block of at least classes()*sizeof(float|uchar) bytes</span>
<a name="l01399"></a>01399                 <span class="keywordtype">void</span> getSignature(<a class="code" href="struct___ipl_image.html">IplImage</a> *patch, <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *sig);
<a name="l01400"></a>01400                 <span class="keywordtype">void</span> getSignature(<a class="code" href="struct___ipl_image.html">IplImage</a> *patch, <span class="keywordtype">float</span> *sig);
<a name="l01401"></a>01401                 <span class="keywordtype">void</span> getSparseSignature(<a class="code" href="struct___ipl_image.html">IplImage</a> *patch, <span class="keywordtype">float</span> *sig, <span class="keywordtype">float</span> thresh);
<a name="l01402"></a>01402                 <span class="comment">// TODO: deprecated in favor of getSignature overload, remove</span>
<a name="l01403"></a>01403                 <span class="keywordtype">void</span> getFloatSignature(<a class="code" href="struct___ipl_image.html">IplImage</a> *patch, <span class="keywordtype">float</span> *sig) { getSignature(patch, sig); }
<a name="l01404"></a>01404 
<a name="l01405"></a>01405                 <span class="keyword">static</span> <span class="keywordtype">int</span> countNonZeroElements(<span class="keywordtype">float</span> *vec, <span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, <span class="keywordtype">double</span> tol=1e-10);
<a name="l01406"></a>01406                 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> safeSignatureAlloc(<a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> **sig, <span class="keywordtype">int</span> num_sig=1, <span class="keywordtype">int</span> sig_len=176);
<a name="l01407"></a>01407                 <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>* safeSignatureAlloc(<span class="keywordtype">int</span> num_sig=1, <span class="keywordtype">int</span> sig_len=176);  
<a name="l01408"></a>01408 
<a name="l01409"></a>01409                 <span class="keyword">inline</span> <span class="keywordtype">int</span> classes() { <span class="keywordflow">return</span> classes_; }
<a name="l01410"></a>01410                 <span class="keyword">inline</span> <span class="keywordtype">int</span> original_num_classes() { <span class="keywordflow">return</span> original_num_classes_; }
<a name="l01411"></a>01411 
<a name="l01412"></a>01412                 <span class="keywordtype">void</span> setQuantization(<span class="keywordtype">int</span> num_quant_bits);
<a name="l01413"></a>01413                 <span class="keywordtype">void</span> discardFloatPosteriors();
<a name="l01414"></a>01414 
<a name="l01415"></a>01415                 <span class="keywordtype">void</span> read(<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="cxcore_8h.html#aed1a5f21df6c3f600d6c313493dde694">file_name</a>);
<a name="l01416"></a>01416                 <span class="keywordtype">void</span> read(std::istream &amp;is);
<a name="l01417"></a>01417                 <span class="keywordtype">void</span> write(<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="cxcore_8h.html#aed1a5f21df6c3f600d6c313493dde694">file_name</a>) <span class="keyword">const</span>;
<a name="l01418"></a>01418                 <span class="keywordtype">void</span> write(std::ostream &amp;os) <span class="keyword">const</span>;
<a name="l01419"></a>01419 
<a name="l01420"></a>01420                 <span class="comment">// experimental and debug</span>
<a name="l01421"></a>01421                 <span class="keywordtype">void</span> saveAllFloatPosteriors(std::string file_url);
<a name="l01422"></a>01422                 <span class="keywordtype">void</span> saveAllBytePosteriors(std::string file_url);
<a name="l01423"></a>01423                 <span class="keywordtype">void</span> setFloatPosteriorsFromTextfile_176(std::string url);
<a name="l01424"></a>01424                 <span class="keywordtype">float</span> countZeroElements();
<a name="l01425"></a>01425 
<a name="l01426"></a>01426                 std::vector&lt;RandomizedTree&gt; trees_;
<a name="l01427"></a>01427 
<a name="l01428"></a>01428         <span class="keyword">private</span>:    
<a name="l01429"></a>01429                 <span class="keywordtype">int</span> classes_;
<a name="l01430"></a>01430                 <span class="keywordtype">int</span> num_quant_bits_;
<a name="l01431"></a>01431                 <a class="code" href="cxtypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> **posteriors_;
<a name="l01432"></a>01432                 <a class="code" href="cxtypes_8h.html#ab95f123a6c9bcfee6a343170ef8c5f69">ushort</a> *ptemp_;
<a name="l01433"></a>01433                 <span class="keywordtype">int</span> original_num_classes_;  
<a name="l01434"></a>01434                 <span class="keywordtype">bool</span> keep_floats_;
<a name="l01435"></a>01435         };
<a name="l01436"></a>01436     
<a name="l01437"></a>01437 <a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> <span class="keywordtype">bool</span> find4QuadCornerSubpix(<span class="keyword">const</span> Mat&amp; img, std::vector&lt;Point2f&gt;&amp; <a class="code" href="cv_8h.html#a47bca3168056d04ddb926909c44866a3">corners</a>, Size region_size);
<a name="l01438"></a>01438 
<a name="l01439"></a>01439     
<a name="l01440"></a>01440 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> BackgroundSubtractor
<a name="l01441"></a>01441 {
<a name="l01442"></a>01442 <span class="keyword">public</span>:
<a name="l01443"></a>01443     <span class="keyword">virtual</span> ~BackgroundSubtractor();
<a name="l01444"></a>01444     <span class="keyword">virtual</span> <span class="keywordtype">void</span> operator()(<span class="keyword">const</span> Mat&amp; image, Mat&amp; fgmask, <span class="keywordtype">double</span> learningRate=0);
<a name="l01445"></a>01445 };
<a name="l01446"></a>01446     
<a name="l01447"></a>01447     
<a name="l01448"></a>01448 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> BackgroundSubtractorMOG : <span class="keyword">public</span> BackgroundSubtractor
<a name="l01449"></a>01449 {
<a name="l01450"></a>01450 <span class="keyword">public</span>:
<a name="l01451"></a>01451     BackgroundSubtractorMOG();
<a name="l01452"></a>01452     BackgroundSubtractorMOG(<span class="keywordtype">int</span> history, <span class="keywordtype">int</span> nmixtures, <span class="keywordtype">double</span> backgroundRatio, <span class="keywordtype">double</span> noiseSigma=0);
<a name="l01453"></a>01453     <span class="keyword">virtual</span> ~BackgroundSubtractorMOG();
<a name="l01454"></a>01454     <span class="keyword">virtual</span> <span class="keywordtype">void</span> operator()(<span class="keyword">const</span> Mat&amp; image, Mat&amp; fgmask, <span class="keywordtype">double</span> learningRate=0);
<a name="l01455"></a>01455     
<a name="l01456"></a>01456     <span class="keyword">virtual</span> <span class="keywordtype">void</span> initialize(Size frameSize, <span class="keywordtype">int</span> frameType);
<a name="l01457"></a>01457     
<a name="l01458"></a>01458     Size frameSize;
<a name="l01459"></a>01459     <span class="keywordtype">int</span> frameType;
<a name="l01460"></a>01460     Mat bgmodel;
<a name="l01461"></a>01461     <span class="keywordtype">int</span> nframes;
<a name="l01462"></a>01462     <span class="keywordtype">int</span> history;
<a name="l01463"></a>01463     <span class="keywordtype">int</span> nmixtures;
<a name="l01464"></a>01464     <span class="keywordtype">double</span> varThreshold;
<a name="l01465"></a>01465     <span class="keywordtype">double</span> backgroundRatio;
<a name="l01466"></a>01466     <span class="keywordtype">double</span> noiseSigma;
<a name="l01467"></a>01467 };
<a name="l01468"></a>01468  
<a name="l01469"></a>01469 
<a name="l01470"></a>01470 <span class="comment">// CvAffinePose: defines a parameterized affine transformation of an image patch.</span>
<a name="l01471"></a>01471 <span class="comment">// An image patch is rotated on angle phi (in degrees), then scaled lambda1 times</span>
<a name="l01472"></a>01472 <span class="comment">// along horizontal and lambda2 times along vertical direction, and then rotated again</span>
<a name="l01473"></a>01473 <span class="comment">// on angle (theta - phi).</span>
<a name="l01474"></a>01474 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> CvAffinePose
<a name="l01475"></a>01475 {
<a name="l01476"></a>01476 <span class="keyword">public</span>:
<a name="l01477"></a>01477     <span class="keywordtype">float</span> phi;
<a name="l01478"></a>01478     <span class="keywordtype">float</span> <a class="code" href="cv_8h.html#a90ba48f41646a904a861746079d43f17">theta</a>;
<a name="l01479"></a>01479     <span class="keywordtype">float</span> lambda1;
<a name="l01480"></a>01480     <span class="keywordtype">float</span> lambda2;
<a name="l01481"></a>01481 };
<a name="l01482"></a>01482 
<a name="l01483"></a>01483 
<a name="l01484"></a>01484 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> OneWayDescriptor
<a name="l01485"></a>01485 {
<a name="l01486"></a>01486 <span class="keyword">public</span>:
<a name="l01487"></a>01487     OneWayDescriptor();
<a name="l01488"></a>01488     ~OneWayDescriptor();
<a name="l01489"></a>01489     
<a name="l01490"></a>01490     <span class="comment">// allocates memory for given descriptor parameters</span>
<a name="l01491"></a>01491     <span class="keywordtype">void</span> Allocate(<span class="keywordtype">int</span> pose_count, <a class="code" href="struct_cv_size.html">CvSize</a> size, <span class="keywordtype">int</span> nChannels);
<a name="l01492"></a>01492     
<a name="l01493"></a>01493     <span class="comment">// GenerateSamples: generates affine transformed patches with averaging them over small transformation variations.</span>
<a name="l01494"></a>01494     <span class="comment">// If external poses and transforms were specified, uses them instead of generating random ones</span>
<a name="l01495"></a>01495     <span class="comment">// - pose_count: the number of poses to be generated</span>
<a name="l01496"></a>01496     <span class="comment">// - frontal: the input patch (can be a roi in a larger image)</span>
<a name="l01497"></a>01497     <span class="comment">// - norm: if nonzero, normalizes the output patch so that the sum of pixel intensities is 1</span>
<a name="l01498"></a>01498     <span class="keywordtype">void</span> GenerateSamples(<span class="keywordtype">int</span> pose_count, <a class="code" href="struct___ipl_image.html">IplImage</a>* frontal, <span class="keywordtype">int</span> norm = 0);
<a name="l01499"></a>01499     
<a name="l01500"></a>01500     <span class="comment">// GenerateSamplesFast: generates affine transformed patches with averaging them over small transformation variations.</span>
<a name="l01501"></a>01501     <span class="comment">// Uses precalculated transformed pca components.</span>
<a name="l01502"></a>01502     <span class="comment">// - frontal: the input patch (can be a roi in a larger image)</span>
<a name="l01503"></a>01503     <span class="comment">// - pca_hr_avg: pca average vector</span>
<a name="l01504"></a>01504     <span class="comment">// - pca_hr_eigenvectors: pca eigenvectors</span>
<a name="l01505"></a>01505     <span class="comment">// - pca_descriptors: an array of precomputed descriptors of pca components containing their affine transformations</span>
<a name="l01506"></a>01506     <span class="comment">//   pca_descriptors[0] corresponds to the average, pca_descriptors[1]-pca_descriptors[pca_dim] correspond to eigenvectors</span>
<a name="l01507"></a>01507     <span class="keywordtype">void</span> GenerateSamplesFast(<a class="code" href="struct___ipl_image.html">IplImage</a>* frontal, <a class="code" href="struct_cv_mat.html">CvMat</a>* pca_hr_avg,
<a name="l01508"></a>01508                              <a class="code" href="struct_cv_mat.html">CvMat</a>* pca_hr_eigenvectors, OneWayDescriptor* pca_descriptors);
<a name="l01509"></a>01509     
<a name="l01510"></a>01510     <span class="comment">// sets the poses and corresponding transforms</span>
<a name="l01511"></a>01511     <span class="keywordtype">void</span> SetTransforms(CvAffinePose* poses, <a class="code" href="struct_cv_mat.html">CvMat</a>** transforms);
<a name="l01512"></a>01512     
<a name="l01513"></a>01513     <span class="comment">// Initialize: builds a descriptor.</span>
<a name="l01514"></a>01514     <span class="comment">// - pose_count: the number of poses to build. If poses were set externally, uses them rather than generating random ones</span>
<a name="l01515"></a>01515     <span class="comment">// - frontal: input patch. Can be a roi in a larger image</span>
<a name="l01516"></a>01516     <span class="comment">// - feature_name: the feature name to be associated with the descriptor</span>
<a name="l01517"></a>01517     <span class="comment">// - norm: if 1, the affine transformed patches are normalized so that their sum is 1</span>
<a name="l01518"></a>01518     <span class="keywordtype">void</span> Initialize(<span class="keywordtype">int</span> pose_count, <a class="code" href="struct___ipl_image.html">IplImage</a>* frontal, <span class="keyword">const</span> <span class="keywordtype">char</span>* feature_name = 0, <span class="keywordtype">int</span> norm = 0);
<a name="l01519"></a>01519     
<a name="l01520"></a>01520     <span class="comment">// InitializeFast: builds a descriptor using precomputed descriptors of pca components</span>
<a name="l01521"></a>01521     <span class="comment">// - pose_count: the number of poses to build</span>
<a name="l01522"></a>01522     <span class="comment">// - frontal: input patch. Can be a roi in a larger image</span>
<a name="l01523"></a>01523     <span class="comment">// - feature_name: the feature name to be associated with the descriptor</span>
<a name="l01524"></a>01524     <span class="comment">// - pca_hr_avg: average vector for PCA</span>
<a name="l01525"></a>01525     <span class="comment">// - pca_hr_eigenvectors: PCA eigenvectors (one vector per row)</span>
<a name="l01526"></a>01526     <span class="comment">// - pca_descriptors: precomputed descriptors of PCA components, the first descriptor for the average vector</span>
<a name="l01527"></a>01527     <span class="comment">// followed by the descriptors for eigenvectors</span>
<a name="l01528"></a>01528     <span class="keywordtype">void</span> InitializeFast(<span class="keywordtype">int</span> pose_count, <a class="code" href="struct___ipl_image.html">IplImage</a>* frontal, <span class="keyword">const</span> <span class="keywordtype">char</span>* feature_name,
<a name="l01529"></a>01529                         <a class="code" href="struct_cv_mat.html">CvMat</a>* pca_hr_avg, <a class="code" href="struct_cv_mat.html">CvMat</a>* pca_hr_eigenvectors, OneWayDescriptor* pca_descriptors);
<a name="l01530"></a>01530     
<a name="l01531"></a>01531     <span class="comment">// ProjectPCASample: unwarps an image patch into a vector and projects it into PCA space</span>
<a name="l01532"></a>01532     <span class="comment">// - patch: input image patch</span>
<a name="l01533"></a>01533     <span class="comment">// - avg: PCA average vector</span>
<a name="l01534"></a>01534     <span class="comment">// - eigenvectors: PCA eigenvectors, one per row</span>
<a name="l01535"></a>01535     <span class="comment">// - pca_coeffs: output PCA coefficients</span>
<a name="l01536"></a>01536     <span class="keywordtype">void</span> ProjectPCASample(<a class="code" href="struct___ipl_image.html">IplImage</a>* patch, <a class="code" href="struct_cv_mat.html">CvMat</a>* <a class="code" href="cxcore_8h.html#a5c9e490cf3a335985bb3f4e77a457fe2">avg</a>, <a class="code" href="struct_cv_mat.html">CvMat</a>* eigenvectors, <a class="code" href="struct_cv_mat.html">CvMat</a>* pca_coeffs) <span class="keyword">const</span>;
<a name="l01537"></a>01537     
<a name="l01538"></a>01538     <span class="comment">// InitializePCACoeffs: projects all warped patches into PCA space</span>
<a name="l01539"></a>01539     <span class="comment">// - avg: PCA average vector</span>
<a name="l01540"></a>01540     <span class="comment">// - eigenvectors: PCA eigenvectors, one per row</span>
<a name="l01541"></a>01541     <span class="keywordtype">void</span> InitializePCACoeffs(<a class="code" href="struct_cv_mat.html">CvMat</a>* <a class="code" href="cxcore_8h.html#a5c9e490cf3a335985bb3f4e77a457fe2">avg</a>, <a class="code" href="struct_cv_mat.html">CvMat</a>* eigenvectors);
<a name="l01542"></a>01542     
<a name="l01543"></a>01543     <span class="comment">// EstimatePose: finds the closest match between an input patch and a set of patches with different poses</span>
<a name="l01544"></a>01544     <span class="comment">// - patch: input image patch</span>
<a name="l01545"></a>01545     <span class="comment">// - pose_idx: the output index of the closest pose</span>
<a name="l01546"></a>01546     <span class="comment">// - distance: the distance to the closest pose (L2 distance)</span>
<a name="l01547"></a>01547     <span class="keywordtype">void</span> EstimatePose(<a class="code" href="struct___ipl_image.html">IplImage</a>* patch, <span class="keywordtype">int</span>&amp; pose_idx, <span class="keywordtype">float</span>&amp; distance) <span class="keyword">const</span>;
<a name="l01548"></a>01548     
<a name="l01549"></a>01549     <span class="comment">// EstimatePosePCA: finds the closest match between an input patch and a set of patches with different poses.</span>
<a name="l01550"></a>01550     <span class="comment">// The distance between patches is computed in PCA space</span>
<a name="l01551"></a>01551     <span class="comment">// - patch: input image patch</span>
<a name="l01552"></a>01552     <span class="comment">// - pose_idx: the output index of the closest pose</span>
<a name="l01553"></a>01553     <span class="comment">// - distance: distance to the closest pose (L2 distance in PCA space)</span>
<a name="l01554"></a>01554     <span class="comment">// - avg: PCA average vector. If 0, matching without PCA is used</span>
<a name="l01555"></a>01555     <span class="comment">// - eigenvectors: PCA eigenvectors, one per row</span>
<a name="l01556"></a>01556     <span class="keywordtype">void</span> EstimatePosePCA(<a class="code" href="cxtypes_8h.html#ac5046bc0456e9295d80b37774384798c">CvArr</a>* patch, <span class="keywordtype">int</span>&amp; pose_idx, <span class="keywordtype">float</span>&amp; distance, <a class="code" href="struct_cv_mat.html">CvMat</a>* <a class="code" href="cxcore_8h.html#a5c9e490cf3a335985bb3f4e77a457fe2">avg</a>, <a class="code" href="struct_cv_mat.html">CvMat</a>* eigenvalues) <span class="keyword">const</span>;
<a name="l01557"></a>01557     
<a name="l01558"></a>01558     <span class="comment">// GetPatchSize: returns the size of each image patch after warping (2 times smaller than the input patch)</span>
<a name="l01559"></a>01559     <a class="code" href="struct_cv_size.html">CvSize</a> GetPatchSize()<span class="keyword"> const</span>
<a name="l01560"></a>01560 <span class="keyword">    </span>{
<a name="l01561"></a>01561         <span class="keywordflow">return</span> m_patch_size;
<a name="l01562"></a>01562     }
<a name="l01563"></a>01563     
<a name="l01564"></a>01564     <span class="comment">// GetInputPatchSize: returns the required size of the patch that the descriptor is built from</span>
<a name="l01565"></a>01565     <span class="comment">// (2 time larger than the patch after warping)</span>
<a name="l01566"></a>01566     <a class="code" href="struct_cv_size.html">CvSize</a> GetInputPatchSize()<span class="keyword"> const</span>
<a name="l01567"></a>01567 <span class="keyword">    </span>{
<a name="l01568"></a>01568         <span class="keywordflow">return</span> <a class="code" href="cxtypes_8h.html#ad25ce7ac18665d5c9b062283ff0204ed">cvSize</a>(m_patch_size.width*2, m_patch_size.height*2);
<a name="l01569"></a>01569     }
<a name="l01570"></a>01570     
<a name="l01571"></a>01571     <span class="comment">// GetPatch: returns a patch corresponding to specified pose index</span>
<a name="l01572"></a>01572     <span class="comment">// - index: pose index</span>
<a name="l01573"></a>01573     <span class="comment">// - return value: the patch corresponding to specified pose index</span>
<a name="l01574"></a>01574     <a class="code" href="struct___ipl_image.html">IplImage</a>* GetPatch(<span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>);
<a name="l01575"></a>01575     
<a name="l01576"></a>01576     <span class="comment">// GetPose: returns a pose corresponding to specified pose index</span>
<a name="l01577"></a>01577     <span class="comment">// - index: pose index</span>
<a name="l01578"></a>01578     <span class="comment">// - return value: the pose corresponding to specified pose index</span>
<a name="l01579"></a>01579     CvAffinePose GetPose(<span class="keywordtype">int</span> <a class="code" href="cxcore_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>) <span class="keyword">const</span>;
<a name="l01580"></a>01580     
<a name="l01581"></a>01581     <span class="comment">// Save: saves all patches with different poses to a specified path</span>
<a name="l01582"></a>01582     <span class="keywordtype">void</span> Save(<span class="keyword">const</span> <span class="keywordtype">char</span>* path);
<a name="l01583"></a>01583     
<a name="l01584"></a>01584     <span class="comment">// ReadByName: reads a descriptor from a file storage</span>
<a name="l01585"></a>01585     <span class="comment">// - fs: file storage</span>
<a name="l01586"></a>01586     <span class="comment">// - parent: parent node</span>
<a name="l01587"></a>01587     <span class="comment">// - name: node name</span>
<a name="l01588"></a>01588     <span class="comment">// - return value: 1 if succeeded, 0 otherwise</span>
<a name="l01589"></a>01589     <span class="keywordtype">int</span> ReadByName(<a class="code" href="cxtypes_8h.html#a84556d1bb6f1b8b02c04c60246747a7e">CvFileStorage</a>* fs, <a class="code" href="struct_cv_file_node.html">CvFileNode</a>* <a class="code" href="cxcore_8h.html#a5f450b216725a37cbc0acd54340144d9">parent</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="cxcore_8h.html#add928d8eb85ea33a25a67db3406d4887">name</a>);
<a name="l01590"></a>01590     
<a name="l01591"></a>01591     <span class="comment">// Write: writes a descriptor into a file storage</span>
<a name="l01592"></a>01592     <span class="comment">// - fs: file storage</span>
<a name="l01593"></a>01593     <span class="comment">// - name: node name</span>
<a name="l01594"></a>01594     <span class="keywordtype">void</span> Write(<a class="code" href="cxtypes_8h.html#a84556d1bb6f1b8b02c04c60246747a7e">CvFileStorage</a>* fs, <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="cxcore_8h.html#add928d8eb85ea33a25a67db3406d4887">name</a>);
<a name="l01595"></a>01595     
<a name="l01596"></a>01596     <span class="comment">// GetFeatureName: returns a name corresponding to a feature</span>
<a name="l01597"></a>01597     <span class="keyword">const</span> <span class="keywordtype">char</span>* GetFeatureName() <span class="keyword">const</span>;
<a name="l01598"></a>01598     
<a name="l01599"></a>01599     <span class="comment">// GetCenter: returns the center of the feature</span>
<a name="l01600"></a>01600     <a class="code" href="struct_cv_point.html">CvPoint</a> GetCenter() <span class="keyword">const</span>;
<a name="l01601"></a>01601     
<a name="l01602"></a>01602     <span class="keywordtype">void</span> SetPCADimHigh(<span class="keywordtype">int</span> pca_dim_high) {m_pca_dim_high = pca_dim_high;};
<a name="l01603"></a>01603     <span class="keywordtype">void</span> SetPCADimLow(<span class="keywordtype">int</span> pca_dim_low) {m_pca_dim_low = pca_dim_low;};
<a name="l01604"></a>01604     
<a name="l01605"></a>01605     <span class="keywordtype">int</span> GetPCADimLow() <span class="keyword">const</span>;
<a name="l01606"></a>01606     <span class="keywordtype">int</span> GetPCADimHigh() <span class="keyword">const</span>;
<a name="l01607"></a>01607     
<a name="l01608"></a>01608     <a class="code" href="struct_cv_mat.html">CvMat</a>** GetPCACoeffs()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_pca_coeffs;}
<a name="l01609"></a>01609     
<a name="l01610"></a>01610 <span class="keyword">protected</span>:
<a name="l01611"></a>01611     <span class="keywordtype">int</span> m_pose_count; <span class="comment">// the number of poses</span>
<a name="l01612"></a>01612     <a class="code" href="struct_cv_size.html">CvSize</a> m_patch_size; <span class="comment">// size of each image</span>
<a name="l01613"></a>01613     <a class="code" href="struct___ipl_image.html">IplImage</a>** m_samples; <span class="comment">// an array of length m_pose_count containing the patch in different poses</span>
<a name="l01614"></a>01614     <a class="code" href="struct___ipl_image.html">IplImage</a>* m_input_patch;
<a name="l01615"></a>01615     <a class="code" href="struct___ipl_image.html">IplImage</a>* m_train_patch;
<a name="l01616"></a>01616     <a class="code" href="struct_cv_mat.html">CvMat</a>** m_pca_coeffs; <span class="comment">// an array of length m_pose_count containing pca decomposition of the patch in different poses</span>
<a name="l01617"></a>01617     CvAffinePose* m_affine_poses; <span class="comment">// an array of poses</span>
<a name="l01618"></a>01618     <a class="code" href="struct_cv_mat.html">CvMat</a>** m_transforms; <span class="comment">// an array of affine transforms corresponding to poses</span>
<a name="l01619"></a>01619     
<a name="l01620"></a>01620     std::string m_feature_name; <span class="comment">// the name of the feature associated with the descriptor</span>
<a name="l01621"></a>01621     <a class="code" href="struct_cv_point.html">CvPoint</a> m_center; <span class="comment">// the coordinates of the feature (the center of the input image ROI)</span>
<a name="l01622"></a>01622     
<a name="l01623"></a>01623     <span class="keywordtype">int</span> m_pca_dim_high; <span class="comment">// the number of descriptor pca components to use for generating affine poses</span>
<a name="l01624"></a>01624     <span class="keywordtype">int</span> m_pca_dim_low; <span class="comment">// the number of pca components to use for comparison</span>
<a name="l01625"></a>01625 };
<a name="l01626"></a>01626 
<a name="l01627"></a>01627 
<a name="l01628"></a>01628 <span class="comment">// OneWayDescriptorBase: encapsulates functionality for training/loading a set of one way descriptors</span>
<a name="l01629"></a>01629 <span class="comment">// and finding the nearest closest descriptor to an input feature</span>
<a name="l01630"></a>01630 <span class="keyword">class </span><a class="code" href="cxtypes_8h.html#a1bf9f0e121b54272da02379cfccd0a2b">CV_EXPORTS</a> OneWayDescriptorBase
<a name="l01631"></a>01631 {
<a name="l01632"></a>01632 <span class="keyword">public</span>:
<a name="l01633"></a>01633     
<a name="l01634"></a>01634     <span class="comment">// creates an instance of OneWayDescriptor from a set of training files</span>
<a name="l01635"></a>01635     <span class="comment">// - patch_size: size of the input (large) patch</span>
<a name="l01636"></a>01636     <span class="comment">// - pose_count: the number of poses to generate for each descriptor</span>
<a name="l01637"></a>01637     <span class="comment">// - train_path: path to training files</span>
<a name="l01638"></a>01638     <span class="comment">// - pca_config: the name of the file that contains PCA for small patches (2 times smaller</span>
<a name="l01639"></a>01639     <span class="comment">// than patch_size each dimension</span>
<a name="l01640"></a>01640     <span class="comment">// - pca_hr_config: the name of the file that contains PCA for large patches (of patch_size size)</span>
<a name="l01641"></a>01641     <span class="comment">// - pca_desc_config: the name of the file that contains descriptors of PCA components</span>
<a name="l01642"></a>01642     OneWayDescriptorBase(<a class="code" href="struct_cv_size.html">CvSize</a> patch_size, <span class="keywordtype">int</span> pose_count, <span class="keyword">const</span> <span class="keywordtype">char</span>* train_path = 0, <span class="keyword">const</span> <span class="keywordtype">char</span>* pca_config = 0,
<a name="l01643"></a>01643                          <span class="keyword">const</span> <span class="keywordtype">char</span>* pca_hr_config = 0, <span class="keyword">const</span> <span class="keywordtype">char</span>* pca_desc_config = 0, <span class="keywordtype">int</span> pyr_levels = 1,
<a name="l01644"></a>01644                          <span class="keywordtype">int</span> pca_dim_high = 100, <span class="keywordtype">int</span> pca_dim_low = 100);
<a name="l01645"></a>01645     
<a name="l01646"></a>01646     ~OneWayDescriptorBase();
<a name="l01647"></a>01647     
<a name="l01648"></a>01648     <span class="comment">// Allocate: allocates memory for a given number of descriptors</span>
<a name="l01649"></a>01649     <span class="keywordtype">void</span> Allocate(<span class="keywordtype">int</span> train_feature_count);
<a name="l01650"></a>01650     
<a name="l01651"></a>01651     <span class="comment">// AllocatePCADescriptors: allocates memory for pca descriptors</span>
<a name="l01652"></a>01652     <span class="keywordtype">void</span> AllocatePCADescriptors();
<a name="l01653"></a>01653     
<a name="l01654"></a>01654     <span class="comment">// returns patch size</span>
<a name="l01655"></a>01655     <a class="code" href="struct_cv_size.html">CvSize</a> GetPatchSize()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_patch_size;};
<a name="l01656"></a>01656     <span class="comment">// returns the number of poses for each descriptor</span>
<a name="l01657"></a>01657     <span class="keywordtype">int</span> GetPoseCount()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_pose_count;};
<a name="l01658"></a>01658     
<a name="l01659"></a>01659     <span class="comment">// returns the number of pyramid levels</span>
<a name="l01660"></a>01660     <span class="keywordtype">int</span> GetPyrLevels()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_pyr_levels;};
<a name="l01661"></a>01661     
<a name="l01662"></a>01662     <span class="comment">// returns the number of descriptors</span>
<a name="l01663"></a>01663     <span class="keywordtype">int</span> GetDescriptorCount()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_train_feature_count;};
<a name="l01664"></a>01664     
<a name="l01665"></a>01665     <span class="comment">// CreateDescriptorsFromImage: creates descriptors for each of the input features</span>
<a name="l01666"></a>01666     <span class="comment">// - src: input image</span>
<a name="l01667"></a>01667     <span class="comment">// - features: input features</span>
<a name="l01668"></a>01668     <span class="comment">// - pyr_levels: the number of pyramid levels</span>
<a name="l01669"></a>01669     <span class="keywordtype">void</span> CreateDescriptorsFromImage(<a class="code" href="struct___ipl_image.html">IplImage</a>* <a class="code" href="cxcore_8h.html#ab4cdd1c16a22344c9f968fca805b5d70">src</a>, <span class="keyword">const</span> std::vector&lt;cv::KeyPoint&gt;&amp; features);
<a name="l01670"></a>01670     
<a name="l01671"></a>01671     <span class="comment">// CreatePCADescriptors: generates descriptors for PCA components, needed for fast generation of feature descriptors</span>
<a name="l01672"></a>01672     <span class="keywordtype">void</span> CreatePCADescriptors();
<a name="l01673"></a>01673     
<a name="l01674"></a>01674     <span class="comment">// returns a feature descriptor by feature index</span>
<a name="l01675"></a>01675     <span class="keyword">const</span> OneWayDescriptor* GetDescriptor(<span class="keywordtype">int</span> desc_idx)<span class="keyword"> const </span>{<span class="keywordflow">return</span> &amp;m_descriptors[desc_idx];};
<a name="l01676"></a>01676     
<a name="l01677"></a>01677     <span class="comment">// FindDescriptor: finds the closest descriptor</span>
<a name="l01678"></a>01678     <span class="comment">// - patch: input image patch</span>
<a name="l01679"></a>01679     <span class="comment">// - desc_idx: output index of the closest descriptor to the input patch</span>
<a name="l01680"></a>01680     <span class="comment">// - pose_idx: output index of the closest pose of the closest descriptor to the input patch</span>
<a name="l01681"></a>01681     <span class="comment">// - distance: distance from the input patch to the closest feature pose</span>
<a name="l01682"></a>01682     <span class="comment">// - _scales: scales of the input patch for each descriptor</span>
<a name="l01683"></a>01683     <span class="comment">// - scale_ranges: input scales variation (float[2])</span>
<a name="l01684"></a>01684     <span class="keywordtype">void</span> FindDescriptor(<a class="code" href="struct___ipl_image.html">IplImage</a>* patch, <span class="keywordtype">int</span>&amp; desc_idx, <span class="keywordtype">int</span>&amp; pose_idx, <span class="keywordtype">float</span>&amp; distance, <span class="keywordtype">float</span>* _scale = 0, <span class="keywordtype">float</span>* scale_ranges = 0) <span class="keyword">const</span>;
<a name="l01685"></a>01685     
<a name="l01686"></a>01686     <span class="comment">// - patch: input image patch</span>
<a name="l01687"></a>01687     <span class="comment">// - n: number of the closest indexes</span>
<a name="l01688"></a>01688     <span class="comment">// - desc_idxs: output indexes of the closest descriptor to the input patch (n)</span>
<a name="l01689"></a>01689     <span class="comment">// - pose_idx: output indexes of the closest pose of the closest descriptor to the input patch (n)</span>
<a name="l01690"></a>01690     <span class="comment">// - distances: distance from the input patch to the closest feature pose (n)</span>
<a name="l01691"></a>01691     <span class="comment">// - _scales: scales of the input patch</span>
<a name="l01692"></a>01692     <span class="comment">// - scale_ranges: input scales variation (float[2])</span>
<a name="l01693"></a>01693     <span class="keywordtype">void</span> FindDescriptor(<a class="code" href="struct___ipl_image.html">IplImage</a>* patch, <span class="keywordtype">int</span> <a class="code" href="cv_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, std::vector&lt;int&gt;&amp; desc_idxs, std::vector&lt;int&gt;&amp; pose_idxs,
<a name="l01694"></a>01694                         std::vector&lt;float&gt;&amp; distances, std::vector&lt;float&gt;&amp; _scales, <span class="keywordtype">float</span>* scale_ranges = 0) <span class="keyword">const</span>;
<a name="l01695"></a>01695     
<a name="l01696"></a>01696     <span class="comment">// FindDescriptor: finds the closest descriptor</span>
<a name="l01697"></a>01697     <span class="comment">// - src: input image</span>
<a name="l01698"></a>01698     <span class="comment">// - pt: center of the feature</span>
<a name="l01699"></a>01699     <span class="comment">// - desc_idx: output index of the closest descriptor to the input patch</span>
<a name="l01700"></a>01700     <span class="comment">// - pose_idx: output index of the closest pose of the closest descriptor to the input patch</span>
<a name="l01701"></a>01701     <span class="comment">// - distance: distance from the input patch to the closest feature pose</span>
<a name="l01702"></a>01702     <span class="keywordtype">void</span> FindDescriptor(<a class="code" href="struct___ipl_image.html">IplImage</a>* <a class="code" href="cxcore_8h.html#ab4cdd1c16a22344c9f968fca805b5d70">src</a>, cv::Point2f <a class="code" href="cv_8h.html#a69c6090aa56793ec8ef2457bc6d45b45">pt</a>, <span class="keywordtype">int</span>&amp; desc_idx, <span class="keywordtype">int</span>&amp; pose_idx, <span class="keywordtype">float</span>&amp; distance) <span class="keyword">const</span>;
<a name="l01703"></a>01703     
<a name="l01704"></a>01704     <span class="comment">// InitializePoses: generates random poses</span>
<a name="l01705"></a>01705     <span class="keywordtype">void</span> InitializePoses();
<a name="l01706"></a>01706     
<a name="l01707"></a>01707     <span class="comment">// InitializeTransformsFromPoses: generates 2x3 affine matrices from poses (initializes m_transforms)</span>
<a name="l01708"></a>01708     <span class="keywordtype">void</span> InitializeTransformsFromPoses();
<a name="l01709"></a>01709     
<a name="l01710"></a>01710     <span class="comment">// InitializePoseTransforms: subsequently calls InitializePoses and InitializeTransformsFromPoses</span>
<a name="l01711"></a>01711     <span class="keywordtype">void</span> InitializePoseTransforms();
<a name="l01712"></a>01712     
<a name="l01713"></a>01713     <span class="comment">// InitializeDescriptor: initializes a descriptor</span>
<a name="l01714"></a>01714     <span class="comment">// - desc_idx: descriptor index</span>
<a name="l01715"></a>01715     <span class="comment">// - train_image: image patch (ROI is supported)</span>
<a name="l01716"></a>01716     <span class="comment">// - feature_label: feature textual label</span>
<a name="l01717"></a>01717     <span class="keywordtype">void</span> InitializeDescriptor(<span class="keywordtype">int</span> desc_idx, <a class="code" href="struct___ipl_image.html">IplImage</a>* train_image, <span class="keyword">const</span> <span class="keywordtype">char</span>* feature_label);
<a name="l01718"></a>01718     
<a name="l01719"></a>01719     <span class="keywordtype">void</span> InitializeDescriptor(<span class="keywordtype">int</span> desc_idx, <a class="code" href="struct___ipl_image.html">IplImage</a>* train_image, <span class="keyword">const</span> cv::KeyPoint&amp; keypoint, <span class="keyword">const</span> <span class="keywordtype">char</span>* feature_label);
<a name="l01720"></a>01720     
<a name="l01721"></a>01721     <span class="comment">// InitializeDescriptors: load features from an image and create descriptors for each of them</span>
<a name="l01722"></a>01722     <span class="keywordtype">void</span> InitializeDescriptors(<a class="code" href="struct___ipl_image.html">IplImage</a>* train_image, <span class="keyword">const</span> vector&lt;cv::KeyPoint&gt;&amp; features,
<a name="l01723"></a>01723                                <span class="keyword">const</span> <span class="keywordtype">char</span>* feature_label = <span class="stringliteral">&quot;&quot;</span>, <span class="keywordtype">int</span> desc_start_idx = 0);
<a name="l01724"></a>01724     
<a name="l01725"></a>01725     <span class="comment">// LoadPCADescriptors: loads PCA descriptors from a file</span>
<a name="l01726"></a>01726     <span class="comment">// - filename: input filename</span>
<a name="l01727"></a>01727     <span class="keywordtype">int</span> LoadPCADescriptors(<span class="keyword">const</span> <span class="keywordtype">char</span>* filename);
<a name="l01728"></a>01728     
<a name="l01729"></a>01729     <span class="comment">// SavePCADescriptors: saves PCA descriptors to a file</span>
<a name="l01730"></a>01730     <span class="comment">// - filename: output filename</span>
<a name="l01731"></a>01731     <span class="keywordtype">void</span> SavePCADescriptors(<span class="keyword">const</span> <span class="keywordtype">char</span>* filename);
<a name="l01732"></a>01732     
<a name="l01733"></a>01733     <span class="comment">// SetPCAHigh: sets the high resolution pca matrices (copied to internal structures)</span>
<a name="l01734"></a>01734     <span class="keywordtype">void</span> SetPCAHigh(<a class="code" href="struct_cv_mat.html">CvMat</a>* <a class="code" href="cxcore_8h.html#a5c9e490cf3a335985bb3f4e77a457fe2">avg</a>, <a class="code" href="struct_cv_mat.html">CvMat</a>* eigenvectors);
<a name="l01735"></a>01735     
<a name="l01736"></a>01736     <span class="comment">// SetPCALow: sets the low resolution pca matrices (copied to internal structures)</span>
<a name="l01737"></a>01737     <span class="keywordtype">void</span> SetPCALow(<a class="code" href="struct_cv_mat.html">CvMat</a>* <a class="code" href="cxcore_8h.html#a5c9e490cf3a335985bb3f4e77a457fe2">avg</a>, <a class="code" href="struct_cv_mat.html">CvMat</a>* eigenvectors);
<a name="l01738"></a>01738     
<a name="l01739"></a>01739     <span class="keywordtype">int</span> GetLowPCA(<a class="code" href="struct_cv_mat.html">CvMat</a>** <a class="code" href="cxcore_8h.html#a5c9e490cf3a335985bb3f4e77a457fe2">avg</a>, <a class="code" href="struct_cv_mat.html">CvMat</a>** eigenvectors)
<a name="l01740"></a>01740     {
<a name="l01741"></a>01741         *avg = m_pca_avg;
<a name="l01742"></a>01742         *eigenvectors = m_pca_eigenvectors;
<a name="l01743"></a>01743         <span class="keywordflow">return</span> m_pca_dim_low;
<a name="l01744"></a>01744     };
<a name="l01745"></a>01745     
<a name="l01746"></a>01746     <span class="keywordtype">void</span> ConvertDescriptorsArrayToTree(); <span class="comment">// Converting pca_descriptors array to KD tree</span>
<a name="l01747"></a>01747     
<a name="l01748"></a>01748     
<a name="l01749"></a>01749 <span class="keyword">protected</span>:
<a name="l01750"></a>01750     <a class="code" href="struct_cv_size.html">CvSize</a> m_patch_size; <span class="comment">// patch size</span>
<a name="l01751"></a>01751     <span class="keywordtype">int</span> m_pose_count; <span class="comment">// the number of poses for each descriptor</span>
<a name="l01752"></a>01752     <span class="keywordtype">int</span> m_train_feature_count; <span class="comment">// the number of the training features</span>
<a name="l01753"></a>01753     OneWayDescriptor* m_descriptors; <span class="comment">// array of train feature descriptors</span>
<a name="l01754"></a>01754     <a class="code" href="struct_cv_mat.html">CvMat</a>* m_pca_avg; <span class="comment">// PCA average Vector for small patches</span>
<a name="l01755"></a>01755     <a class="code" href="struct_cv_mat.html">CvMat</a>* m_pca_eigenvectors; <span class="comment">// PCA eigenvectors for small patches</span>
<a name="l01756"></a>01756     <a class="code" href="struct_cv_mat.html">CvMat</a>* m_pca_hr_avg; <span class="comment">// PCA average Vector for large patches</span>
<a name="l01757"></a>01757     <a class="code" href="struct_cv_mat.html">CvMat</a>* m_pca_hr_eigenvectors; <span class="comment">// PCA eigenvectors for large patches</span>
<a name="l01758"></a>01758     OneWayDescriptor* m_pca_descriptors; <span class="comment">// an array of PCA descriptors</span>
<a name="l01759"></a>01759     
<a name="l01760"></a>01760     cv::flann::Index* m_pca_descriptors_tree;
<a name="l01761"></a>01761     <a class="code" href="struct_cv_mat.html">CvMat</a>* m_pca_descriptors_matrix;
<a name="l01762"></a>01762     
<a name="l01763"></a>01763     CvAffinePose* m_poses; <span class="comment">// array of poses</span>
<a name="l01764"></a>01764     <a class="code" href="struct_cv_mat.html">CvMat</a>** m_transforms; <span class="comment">// array of affine transformations corresponding to poses</span>
<a name="l01765"></a>01765     
<a name="l01766"></a>01766     <span class="keywordtype">int</span> m_pca_dim_high;
<a name="l01767"></a>01767     <span class="keywordtype">int</span> m_pca_dim_low;
<a name="l01768"></a>01768     
<a name="l01769"></a>01769     <span class="keywordtype">int</span> m_pyr_levels;
<a name="l01770"></a>01770     
<a name="l01771"></a>01771 };
<a name="l01772"></a>01772 
<a name="l01773"></a>01773 <span class="keyword">class </span>OneWayDescriptorObject : <span class="keyword">public</span> OneWayDescriptorBase
<a name="l01774"></a>01774 {
<a name="l01775"></a>01775 <span class="keyword">public</span>:
<a name="l01776"></a>01776     <span class="comment">// creates an instance of OneWayDescriptorObject from a set of training files</span>
<a name="l01777"></a>01777     <span class="comment">// - patch_size: size of the input (large) patch</span>
<a name="l01778"></a>01778     <span class="comment">// - pose_count: the number of poses to generate for each descriptor</span>
<a name="l01779"></a>01779     <span class="comment">// - train_path: path to training files</span>
<a name="l01780"></a>01780     <span class="comment">// - pca_config: the name of the file that contains PCA for small patches (2 times smaller</span>
<a name="l01781"></a>01781     <span class="comment">// than patch_size each dimension</span>
<a name="l01782"></a>01782     <span class="comment">// - pca_hr_config: the name of the file that contains PCA for large patches (of patch_size size)</span>
<a name="l01783"></a>01783     <span class="comment">// - pca_desc_config: the name of the file that contains descriptors of PCA components</span>
<a name="l01784"></a>01784     OneWayDescriptorObject(<a class="code" href="struct_cv_size.html">CvSize</a> patch_size, <span class="keywordtype">int</span> pose_count, <span class="keyword">const</span> <span class="keywordtype">char</span>* train_path, <span class="keyword">const</span> <span class="keywordtype">char</span>* pca_config,
<a name="l01785"></a>01785                            <span class="keyword">const</span> <span class="keywordtype">char</span>* pca_hr_config = 0, <span class="keyword">const</span> <span class="keywordtype">char</span>* pca_desc_config = 0, <span class="keywordtype">int</span> pyr_levels = 1);
<a name="l01786"></a>01786     
<a name="l01787"></a>01787     ~OneWayDescriptorObject();
<a name="l01788"></a>01788     
<a name="l01789"></a>01789     <span class="comment">// Allocate: allocates memory for a given number of features</span>
<a name="l01790"></a>01790     <span class="comment">// - train_feature_count: the total number of features</span>
<a name="l01791"></a>01791     <span class="comment">// - object_feature_count: the number of features extracted from the object</span>
<a name="l01792"></a>01792     <span class="keywordtype">void</span> Allocate(<span class="keywordtype">int</span> train_feature_count, <span class="keywordtype">int</span> object_feature_count);
<a name="l01793"></a>01793     
<a name="l01794"></a>01794     
<a name="l01795"></a>01795     <span class="keywordtype">void</span> SetLabeledFeatures(<span class="keyword">const</span> vector&lt;cv::KeyPoint&gt;&amp; features) {m_train_features = features;};
<a name="l01796"></a>01796     vector&lt;cv::KeyPoint&gt;&amp; GetLabeledFeatures() {<span class="keywordflow">return</span> m_train_features;};
<a name="l01797"></a>01797     <span class="keyword">const</span> vector&lt;cv::KeyPoint&gt;&amp; GetLabeledFeatures()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_train_features;};
<a name="l01798"></a>01798     vector&lt;cv::KeyPoint&gt; _GetLabeledFeatures() <span class="keyword">const</span>;
<a name="l01799"></a>01799     
<a name="l01800"></a>01800     <span class="comment">// IsDescriptorObject: returns 1 if descriptor with specified index is positive, otherwise 0</span>
<a name="l01801"></a>01801     <span class="keywordtype">int</span> IsDescriptorObject(<span class="keywordtype">int</span> desc_idx) <span class="keyword">const</span>;
<a name="l01802"></a>01802     
<a name="l01803"></a>01803     <span class="comment">// MatchPointToPart: returns the part number of a feature if it matches one of the object parts, otherwise -1</span>
<a name="l01804"></a>01804     <span class="keywordtype">int</span> MatchPointToPart(<a class="code" href="struct_cv_point.html">CvPoint</a> <a class="code" href="cv_8h.html#a69c6090aa56793ec8ef2457bc6d45b45">pt</a>) <span class="keyword">const</span>;
<a name="l01805"></a>01805     
<a name="l01806"></a>01806     <span class="comment">// GetDescriptorPart: returns the part number of the feature corresponding to a specified descriptor</span>
<a name="l01807"></a>01807     <span class="comment">// - desc_idx: descriptor index</span>
<a name="l01808"></a>01808     <span class="keywordtype">int</span> GetDescriptorPart(<span class="keywordtype">int</span> desc_idx) <span class="keyword">const</span>;
<a name="l01809"></a>01809     
<a name="l01810"></a>01810     
<a name="l01811"></a>01811     <span class="keywordtype">void</span> InitializeObjectDescriptors(<a class="code" href="struct___ipl_image.html">IplImage</a>* train_image, <span class="keyword">const</span> vector&lt;cv::KeyPoint&gt;&amp; features,
<a name="l01812"></a>01812                                      <span class="keyword">const</span> <span class="keywordtype">char</span>* feature_label, <span class="keywordtype">int</span> desc_start_idx = 0, <span class="keywordtype">float</span> <a class="code" href="cv_8h.html#a1f622eb9b9e06b30862ca90cdf2c078b">scale</a> = 1.0f,
<a name="l01813"></a>01813                                      <span class="keywordtype">int</span> is_background = 0);
<a name="l01814"></a>01814     
<a name="l01815"></a>01815     <span class="comment">// GetObjectFeatureCount: returns the number of object features</span>
<a name="l01816"></a>01816     <span class="keywordtype">int</span> GetObjectFeatureCount()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_object_feature_count;};
<a name="l01817"></a>01817     
<a name="l01818"></a>01818 <span class="keyword">protected</span>:
<a name="l01819"></a>01819     <span class="keywordtype">int</span>* m_part_id; <span class="comment">// contains part id for each of object descriptors</span>
<a name="l01820"></a>01820     vector&lt;cv::KeyPoint&gt; m_train_features; <span class="comment">// train features</span>
<a name="l01821"></a>01821     <span class="keywordtype">int</span> m_object_feature_count; <span class="comment">// the number of the positive features</span>
<a name="l01822"></a>01822     
<a name="l01823"></a>01823 };
<a name="l01824"></a>01824     
<a name="l01825"></a>01825 
<a name="l01826"></a>01826 }
<a name="l01827"></a>01827 
<a name="l01828"></a>01828 <span class="preprocessor">#endif </span><span class="comment">/* __cplusplus */</span>
<a name="l01829"></a>01829 
<a name="l01830"></a>01830 <span class="preprocessor">#endif </span><span class="comment">/* __CVAUX_HPP__ */</span>
<a name="l01831"></a>01831 
<a name="l01832"></a>01832 <span class="comment">/* End of file. */</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Mon Nov 22 2010 12:51:43 for FaceDetection by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
