/*
 * AesUI.java
 * @author Andrea
 */

package com.andreasaw.aes;

import java.io.*;
import java.util.*;

public class AesUI extends javax.swing.JFrame {
    
    /**
     * Creates new form AesUI
     */
    public AesUI() {
        	initComponents();
    }
    
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc=" Generated Code ">
    private void initComponents() {
	        jPanel1 = new javax.swing.JPanel();
	        jLabel1 = new javax.swing.JLabel();
	        jTextField1 = new javax.swing.JTextField();
	        jLabel2 = new javax.swing.JLabel();
	        jScrollPane1 = new javax.swing.JScrollPane();
	        jTextArea1 = new javax.swing.JTextArea();
	        jButton1 = new javax.swing.JButton();
	        jButton2 = new javax.swing.JButton();
	        jButton3 = new javax.swing.JButton();
	        jButton4 = new javax.swing.JButton();
	        jButton5 = new javax.swing.JButton();
	        jButton6 = new javax.swing.JButton();
	        jPanel2 = new javax.swing.JPanel();
	        jScrollPane2 = new javax.swing.JScrollPane();
	        jTextArea2 = new javax.swing.JTextArea();
	        jPanel3 = new javax.swing.JPanel();
	        jScrollPane3 = new javax.swing.JScrollPane();
	        jTextArea3 = new javax.swing.JTextArea();
	
	        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
	        setTitle("AES in Java Card Protoype");
	        setResizable(false);
	        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Input", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 12)));
	        jLabel1.setText("Pass Phrase:");
	
	        jLabel2.setText("Text:");
	
	        jTextArea1.setColumns(20);
	        jTextArea1.setFont(new java.awt.Font("Tahoma", 0, 11));
	        jTextArea1.setLineWrap(true);
	        jTextArea1.setRows(5);
	        jScrollPane1.setViewportView(jTextArea1);
	
	        jButton1.setText("Encrypt");
	        jButton1.addMouseListener(new java.awt.event.MouseAdapter() {
	            public void mouseClicked(java.awt.event.MouseEvent evt) {
	                jButton1MouseClicked(evt);
	            }
	        });
	
	        jButton2.setText("Decrypt");
	        jButton2.addMouseListener(new java.awt.event.MouseAdapter() {
	            public void mouseClicked(java.awt.event.MouseEvent evt) {
	                jButton2MouseClicked(evt);
	            }
	        });
	
	        jButton3.setText("Reset");
	        jButton3.addMouseListener(new java.awt.event.MouseAdapter() {
	            public void mouseClicked(java.awt.event.MouseEvent evt) {
	                jButton3MouseClicked(evt);
	            }
	        });
	
	        jButton4.setText("Load");
	        jButton4.addMouseListener(new java.awt.event.MouseAdapter() {
	            public void mouseClicked(java.awt.event.MouseEvent evt) {
	                jButton4MouseClicked(evt);
	            }
	        });
	
	        jButton5.setText("Save");
	        jButton5.addMouseListener(new java.awt.event.MouseAdapter() {
	            public void mouseClicked(java.awt.event.MouseEvent evt) {
	                jButton5MouseClicked(evt);
	            }
	        });
	
	        jButton6.setText("Swap");
	        jButton6.addMouseListener(new java.awt.event.MouseAdapter() {
	            public void mouseClicked(java.awt.event.MouseEvent evt) {
	                jButton6MouseClicked(evt);
	            }
	        });
	
	        org.jdesktop.layout.GroupLayout jPanel1Layout = new org.jdesktop.layout.GroupLayout(jPanel1);
	        jPanel1.setLayout(jPanel1Layout);
	        jPanel1Layout.setHorizontalGroup(
	            jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
	            .add(jPanel1Layout.createSequentialGroup()
	                .addContainerGap()
	                .add(jLabel1)
	                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
	                .add(jTextField1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 398, Short.MAX_VALUE)
	                .addContainerGap())
	            .add(jPanel1Layout.createSequentialGroup()
	                .addContainerGap()
	                .add(jLabel2, 0, 0, Short.MAX_VALUE)
	                .add(412, 412, 412))
	            .add(jPanel1Layout.createSequentialGroup()
	                .add(41, 41, 41)
	                .add(jButton1)
	                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
	                .add(jButton2)
	                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
	                .add(jButton5)
	                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
	                .add(jButton4)
	                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
	                .add(jButton6)
	                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
	                .add(jButton3)
	                .addContainerGap(41, Short.MAX_VALUE))
	            .add(jPanel1Layout.createSequentialGroup()
	                .addContainerGap()
	                .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 464, Short.MAX_VALUE)
	                .addContainerGap())
	        );
	
	        jPanel1Layout.linkSize(new java.awt.Component[] {jLabel1, jLabel2}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
	
	        jPanel1Layout.setVerticalGroup(
	            jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
	            .add(jPanel1Layout.createSequentialGroup()
	                .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
	                    .add(jLabel1)
	                    .add(jTextField1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
	                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
	                .add(jLabel2)
	                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
	                .add(jScrollPane1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 102, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
	                .add(8, 8, 8)
	                .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
	                    .add(jButton1)
	                    .add(jButton2)
	                    .add(jButton5)
	                    .add(jButton4)
	                    .add(jButton6)
	                    .add(jButton3)))
	        );
	
	        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Output", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 12)));
	        jTextArea2.setColumns(20);
	        jTextArea2.setEditable(false);
	        jTextArea2.setFont(new java.awt.Font("Tahoma", 0, 11));
	        jTextArea2.setLineWrap(true);
	        jTextArea2.setRows(5);
	        jScrollPane2.setViewportView(jTextArea2);
	
	        org.jdesktop.layout.GroupLayout jPanel2Layout = new org.jdesktop.layout.GroupLayout(jPanel2);
	        jPanel2.setLayout(jPanel2Layout);
	        jPanel2Layout.setHorizontalGroup(
	            jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
	            .add(jPanel2Layout.createSequentialGroup()
	                .addContainerGap()
	                .add(jScrollPane2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 464, Short.MAX_VALUE)
	                .addContainerGap())
	        );
	        jPanel2Layout.setVerticalGroup(
	            jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
	            .add(jPanel2Layout.createSequentialGroup()
	                .add(jScrollPane2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
	                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
	        );
	
	        jPanel3.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Status", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 12)));
	        jTextArea3.setColumns(20);
	        jTextArea3.setEditable(false);
	        jTextArea3.setFont(new java.awt.Font("Tahoma", 0, 11));
	        jTextArea3.setLineWrap(true);
	        jTextArea3.setRows(5);
	        jScrollPane3.setViewportView(jTextArea3);
	
	        org.jdesktop.layout.GroupLayout jPanel3Layout = new org.jdesktop.layout.GroupLayout(jPanel3);
	        jPanel3.setLayout(jPanel3Layout);
	        jPanel3Layout.setHorizontalGroup(
	            jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
	            .add(jPanel3Layout.createSequentialGroup()
	                .addContainerGap()
	                .add(jScrollPane3, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 464, Short.MAX_VALUE)
	                .addContainerGap())
	        );
	        jPanel3Layout.setVerticalGroup(
	            jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
	            .add(jPanel3Layout.createSequentialGroup()
	                .add(jScrollPane3, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 102, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
	                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
	        );
	
	        org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
	        getContentPane().setLayout(layout);
	        layout.setHorizontalGroup(
	            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
	            .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
	                .addContainerGap()
	                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
	                    .add(org.jdesktop.layout.GroupLayout.LEADING, jPanel3, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
	                    .add(org.jdesktop.layout.GroupLayout.LEADING, jPanel2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
	                    .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
	                .addContainerGap())
	        );
	        layout.setVerticalGroup(
	            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
	            .add(layout.createSequentialGroup()
	                .addContainerGap()
	                .add(jPanel1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 208, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
	                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
	                .add(jPanel2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
	                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
	                .add(jPanel3, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
	                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
	        );
	        pack();
    }// </editor-fold>
    


    //Save button clicked
    private void jButton5MouseClicked(java.awt.event.MouseEvent evt) {
	        String text;
	        String newText;
	        String fileName;
	        byte[] textBytes;
	        
	        text = jTextArea2.getText();
	        if(text.equals("")==true){
	            jTextArea3.append("There's nothing to save! (O:)\n");
	        }
	        else{
	            try{
	                AesFileApp afaSave = new AesFileApp("save");
	                newText = new String(afaSave.formatEOL(text));
	                textBytes = newText.getBytes();
	
	                boolean status = afaSave.openFileChooser(); //if filename was chosen or not
	                if(status == true){
	                    fileName = new String(afaSave.writeFile(textBytes));
	                    jTextArea3.append("Saved to " + fileName + "\n");
	                }
	            }
	            catch(Exception e){
	                jTextArea3.append("Exception! :" +e.toString() + "\n");
	            }
	        }   
    }
    
    
    //Swap button clicked
    private void jButton6MouseClicked(java.awt.event.MouseEvent evt) {

	        String x = new String(jTextArea1.getText());
	        jTextArea1.setText(jTextArea2.getText());
	        jTextArea2.setText(x);
	        jTextArea3.append("Swapped input and output.\n");
    }

    //Load button clicked
    private void jButton4MouseClicked(java.awt.event.MouseEvent evt) {

	        AesFileApp afaLoad = new AesFileApp("load");
	        
	        try{
	            boolean status = afaLoad.openFileChooser(); //if file was chosen or not
	            if(status == true){
	                String loadText = new String(afaLoad.readFile());
	                jTextArea1.setText(loadText);
	                jTextArea3.append(afaLoad.getFileName() + " loaded.\n");
	            }
	                
	        }
	        catch(Exception e){
	            jTextArea3.append("Exception! :" +e.toString() + "\n");
	        }
	  
    }

    //Decrypt button clicked    
    private void jButton2MouseClicked(java.awt.event.MouseEvent evt) {

	        jTextArea2.setText(""); //clear out any previous data 
	        
	        long time1, time2, time3;
	        time1 = System.currentTimeMillis();
	
	        int remainder = 0;
	        byte[] keybytes = new byte[] {};
	        byte[] input = new byte[] {};      
	
	        String text = new String("");
	        String passphrase = new String("");
	  
	        passphrase = jTextField1.getText();
	        if(passphrase.equals("")==true){
	            jTextArea3.append("Please insert a pass phrase!\n");
	        }
	        else{
	            keybytes = passphrase.getBytes();
	            text = jTextArea1.getText();
	            if(text.equals("")==true){
	                jTextArea3.append("Please insert your cipher text!\n");
	            }
	            else{	//main block
	              jTextArea3.append("Decrypting...");
	              try{
	              input = Base64.decode(text);    
	              
	              remainder = input.length%16;
	              
	               if(remainder!=0){
	                    jTextArea3.append("Wrong file length! The input wasn't encrypted with the AES algorithm.\n");
	               }
	               else{
		                  AesData decData = new AesData(input, keybytes);
		                  AesProcess dproc = new AesProcess(decData);
		                  String decResult = dproc.Decryptor();
		                  time2 = System.currentTimeMillis();   
		                  time3 = time2 - time1;
		                  jTextArea3.append(" done (" + time3 + " milliseconds).\n");   
		                  jTextArea2.setText(decResult);                       
	                  }
	              }
	              catch(Exception e){
	                  jTextArea3.append("Exception! :" + e.toString() + "\n");
	              }      
	            }
	        }        
    }

    //Encrypt button clicked
    private void jButton1MouseClicked(java.awt.event.MouseEvent evt) {

	        jTextArea2.setText(""); //clear out any previous data
	        
	        long time1, time2, time3;
	        time1 = System.currentTimeMillis();
	 
	        byte[] keybytes = new byte[] {};
	        byte[] input = new byte[] {};
	
	        String text = new String("");
	        String passphrase = new String("");
	        
	        passphrase = jTextField1.getText();
	        if(passphrase.equals("")==true){
	            jTextArea3.append("Please insert a pass phrase!\n");
	        }
	        else{
	            keybytes = passphrase.getBytes();
	            text = jTextArea1.getText();
	            
	            if(text.equals("")==true){
	                jTextArea3.append("Please insert your plain text!\n");
	            }
	            else{
	                jTextArea3.append("Encrypting...");
	                input = text.getBytes();
	                
	                try{
	                    AesData encData = new AesData(input, keybytes);
	                    AesProcess eproc = new AesProcess(encData);
	                    String encResult = eproc.Encryptor();
	                    time2 = System.currentTimeMillis();   
	                    time3 = time2 - time1;
	                    jTextArea3.append(" done (" + time3 + " milliseconds).\n");   
	                    jTextArea2.setText(encResult); 
	                }
	                catch(Exception e){
	                    jTextArea3.append("Exception! :" + e.toString() + "\n");
	                }
	                
	            }
	        }
        
    }

    //Reset
    private void jButton3MouseClicked(java.awt.event.MouseEvent evt) {
	        jTextField1.setText("");
	        jTextArea1.setText("");
	        jTextArea2.setText("");
	        jTextArea3.setText("");
    }
    
    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
	        java.awt.EventQueue.invokeLater(new Runnable() {
	            public void run() {
	                new AesUI().setVisible(true);
	            }
	        });
    }
    
    // Variables declaration - do not modify
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JButton jButton4;
    private javax.swing.JButton jButton5;
    private javax.swing.JButton jButton6;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JTextArea jTextArea1;
    private javax.swing.JTextArea jTextArea2;
    private javax.swing.JTextArea jTextArea3;
    private javax.swing.JTextField jTextField1;
    // End of variables declaration
    
}
